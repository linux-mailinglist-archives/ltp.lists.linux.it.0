Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [213.254.12.146])
	by mail.lfdr.de (Postfix) with ESMTPS id 1B2933ADA1
	for <lists+linux-ltp@lfdr.de>; Mon, 10 Jun 2019 05:28:25 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id D92C43EAE0A
	for <lists+linux-ltp@lfdr.de>; Mon, 10 Jun 2019 05:28:24 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-5.smtp.seeweb.it (in-5.smtp.seeweb.it [217.194.8.5])
 by picard.linux.it (Postfix) with ESMTP id AFEE13EADCE
 for <ltp@lists.linux.it>; Mon, 10 Jun 2019 05:28:21 +0200 (CEST)
Received: from tyo161.gate.nec.co.jp (tyo161.gate.nec.co.jp [114.179.232.161])
 (using TLSv1.2 with cipher ECDHE-RSA-AES256-GCM-SHA384 (256/256
 bits)) (No client certificate requested)
 by in-5.smtp.seeweb.it (Postfix) with ESMTPS id 7DA266002CE
 for <ltp@lists.linux.it>; Mon, 10 Jun 2019 05:28:18 +0200 (CEST)
Received: from mailgate01.nec.co.jp ([114.179.233.122])
 by tyo161.gate.nec.co.jp (8.15.1/8.15.1) with ESMTPS id x5A3S8Sr001501
 (version=TLSv1.2 cipher=DHE-RSA-AES256-GCM-SHA384 bits=256 verify=NO);
 Mon, 10 Jun 2019 12:28:08 +0900
Received: from mailsv02.nec.co.jp (mailgate-v.nec.co.jp [10.204.236.94])
 by mailgate01.nec.co.jp (8.15.1/8.15.1) with ESMTP id x5A3S86F001215;
 Mon, 10 Jun 2019 12:28:08 +0900
Received: from mail01b.kamome.nec.co.jp (mail01b.kamome.nec.co.jp [10.25.43.2])
 by mailsv02.nec.co.jp (8.15.1/8.15.1) with ESMTP id x5A3RMNK002094;
 Mon, 10 Jun 2019 12:28:08 +0900
Received: from bpxc99gp.gisp.nec.co.jp ([10.38.151.151] [10.38.151.151]) by
 mail02.kamome.nec.co.jp with ESMTP id BT-MMP-5812935;
 Mon, 10 Jun 2019 12:27:47 +0900
Received: from BPXM23GP.gisp.nec.co.jp ([10.38.151.215]) by
 BPXC23GP.gisp.nec.co.jp ([10.38.151.151]) with mapi id 14.03.0319.002; Mon,
 10 Jun 2019 12:27:47 +0900
From: Naoya Horiguchi <n-horiguchi@ah.jp.nec.com>
To: Li Wang <liwang@redhat.com>
Thread-Topic: [PATCH RFC] move_pages12: handle errno EBUSY for madvise(...,
 MADV_SOFT_OFFLINE)
Thread-Index: AQHVHRa1pNV2NyBsjESFn2xw4RfGx6aTp+0A
Date: Mon, 10 Jun 2019 03:27:46 +0000
Message-ID: <20190610032754.GA7114@hori.linux.bs1.fc.nec.co.jp>
References: <20190607095213.13372-1-liwang@redhat.com>
In-Reply-To: <20190607095213.13372-1-liwang@redhat.com>
Accept-Language: en-US, ja-JP
Content-Language: ja-JP
X-MS-Has-Attach: 
X-MS-TNEF-Correlator: 
x-originating-ip: [10.34.125.96]
Content-ID: <BE3A36272915F14D8BF205059E46304E@gisp.nec.co.jp>
MIME-Version: 1.0
X-TM-AS-MML: disable
X-Virus-Scanned: clamav-milter 0.99.2 at in-5.smtp.seeweb.it
X-Virus-Status: Clean
X-Spam-Status: No, score=0.0 required=7.0 tests=SPF_HELO_NONE,SPF_PASS
 autolearn=disabled version=3.4.0
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on in-5.smtp.seeweb.it
Cc: "ltp@lists.linux.it" <ltp@lists.linux.it>
Subject: Re: [LTP] [PATCH RFC] move_pages12: handle errno EBUSY for
 madvise(..., MADV_SOFT_OFFLINE)
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

SGkgTGkgV2FuZywKClRoYW5rIHlvdSBmb3IgbWFpbnRhaW5pbmcgdGhlIHRlc3RjYXNlLgoKUmVj
ZW50bHkgKHNpbmNlIDQuMTkpIHdlIGhhdmUgYSBzZW1hbnRpY3MgY2hhbmdlIG9uIHRoZSByZXR1
cm4gdmFsdWUgb2YKbWFkdmlzZShNQURWX1NPRlRfT0ZGTElORSksIGFuZCB3ZSBzZWUgLUVCVVNZ
IHdoZW4gaHVnZXBhZ2UgbWlncmF0aW9uCnN1Y2NlZWRlZCBhbmQgZXJyb3IgY29udGFpbm1lbnQg
ZmFpbGVkOgoKICBjb21taXQgNmJjOWI1NjQzM2I3NmU0MGQxMTA5OTMzOGQyN2ZiYzVjZDI5MzVj
YQogIEF1dGhvcjogTmFveWEgSG9yaWd1Y2hpIDxuLWhvcmlndWNoaUBhaC5qcC5uZWMuY29tPgog
IERhdGU6ICAgVGh1IEF1ZyAyMyAxNzowMDozOCAyMDE4IC0wNzAwCiAgCiAgICAgIG1tOiBmaXgg
cmFjZSBvbiBzb2Z0LW9mZmxpbmluZyBmcmVlIGh1Z2UgcGFnZXMKCiwgc28gd2UgZG9uJ3QgaGF2
ZSB0byBjb25zaWRlciB0aGlzIEVCVVNZIGFzIGVycm9yLCBidXQgYSBnb29kIHJlcG9ydApmb3Ig
YXBwbGljYXRpb24uIFlvdXIgY2hhbmdlIG1lZXRzIHRoZSBjaGFuZ2UuCgpGZWVsIGZyZWUgdG8g
YWRkIG15IGFjazoKCkFja2VkLWJ5OiBOYW95YSBIb3JpZ3VjaGkgPG4taG9yaWd1Y2hpQGFoLmpw
Lm5lYy5jb20+CgpUaGFua3MsCi0gTmFveWEKCk9uIEZyaSwgSnVuIDA3LCAyMDE5IGF0IDA1OjUy
OjEzUE0gKzA4MDAsIExpIFdhbmcgd3JvdGU6Cj4gVGhlIHRlc3QjMiBpcyBnb2luZyB0byBzaW11
bGF0ZSB0aGUgcmFjZSBjb25kaXRpb24sIHdoZXJlIG1vdmVfcGFnZXMoKQo+IGFuZCBzb2Z0IG9m
ZmxpbmUgYXJlIGNhbGxlZCBvbiBhIHNpbmdsZSBodWdldGxiIHBhZ2UgY29uY3VycmVudGx5LiBC
dXQsCj4gaXQgcmV0dXJuIEVCVVNZIGFuZCByZXBvcnQgRkFJTCBpbiBzb2Z0LW9mZmxpbmUgYSBt
b3ZpbmcgaHVnZXBhZ2UgYXMgYQo+IHJlc3VsdCBzb21ldGltZXMuCj4gCj4gVGhlIHJvb3QgY2F1
c2Ugc2VlbXMgYSBjYWxsIHRvIHBhZ2VfaHVnZV9hY3RpdmUgcmV0dXJuIGZhbHNlLCB0aGVuIHRo
ZQo+IHNvZnQgb2ZmbGluZSBhY3Rpb24gd2lsbCBmYWlsZWQgdG8gaXNvbGF0ZSBodWdlcGFnZSB3
aXRoIEVCVVNZIHJldHVybiBhcwo+IGJlbG93IGNhbGwgdHJhY2U6Cj4gCj4gSW4gUGFyZW50Ogo+
ICAgbWFkdmlzZSguLi4sIE1BRFZfU09GVF9PRkZMSU5FKQo+ICAgLi4uCj4gICAgIHNvZnRfb2Zm
bGluZV9wYWdlCj4gICAgICAgc29mdF9vZmZsaW5lX2luX3VzZV9wYWdlCj4gICAgICAgICBzb2Z0
X29mZmxpbmVfaHVnZV9wYWdlCj4gICAgICAgICAgIGlzb2xhdGVfaHVnZV9wYWdlCj4gICAgICAg
ICAgICAgcGFnZV9odWdlX2FjdGl2ZSAgLS0+IHJldHVybiBmYWxzZSBhdCBoZXJlCj4gCj4gSW4g
Q2hpbGQ6Cj4gICBtb3ZlX3BhZ2VzKCkKPiAgIC4uLgo+ICAgICBkb19tb3ZlX3BhZ2VzCj4gICAg
ICAgZG9fbW92ZV9wYWdlc190b19ub2RlCj4gICAgICAgICBhZGRfcGFnZV9mb3JfbWlncmF0aW9u
Cj4gICAgICAgICAgIGlzb2xhdGVfaHVnZV9wYWdlICAgLS0+IGl0IGhhcyBhbHJlYWR5IGlzb2xh
dGVkIHRoZSBodWdlcGFnZQo+IAo+IEluIHRoaXMgcGF0Y2gsIEkgc2ltcGx5IHJlZ2FyZCB0aGUg
cmV0dXJuZWQgRUJVU1kgYXMgYSBub3JtYWwgc2l0dWF0aW9uIGFuZAo+IG1hc2sgaXQgaW4gZXJy
b3IgaGFuZGxlci4gQmVjYXVzZSBtb3ZlX3BhZ2VzIGlzIGNhbGxpbmcgYWRkX3BhZ2VfZm9yX21p
Z3JhdGlvbgo+IHRvIGlzb2xhdGUgaHVnZXBhZ2UgYmVmb3JlIGRvIG1pZ3JhdGlvbiwgc28gdGhh
dCdzIHZlcnkgcG9zc2libGUgdG8gaGl0IHRoZQo+IGNvbGxpc2lvbiBhbmQgcmV0dXJuIEVCVVNZ
IG9uIHRoZSBzYW1lIHBhZ2UuCj4gCj4gRXJyb3IgbG9nOgo+IC0tLS0tLS0tLS0KPiBtb3ZlX3Bh
Z2VzMTIuYzoyMzU6IElORk86IEZyZWUgUkFNIDgzODYyNTYga0IKPiBtb3ZlX3BhZ2VzMTIuYzoy
NTM6IElORk86IEluY3JlYXNpbmcgMjA0OGtCIGh1Z2VwYWdlcyBwb29sIG9uIG5vZGUgMCB0byA0
Cj4gbW92ZV9wYWdlczEyLmM6MjYzOiBJTkZPOiBJbmNyZWFzaW5nIDIwNDhrQiBodWdlcGFnZXMg
cG9vbCBvbiBub2RlIDEgdG8gNgo+IG1vdmVfcGFnZXMxMi5jOjE3OTogSU5GTzogQWxsb2NhdGlu
ZyBhbmQgZnJlZWluZyA0IGh1Z2VwYWdlcyBvbiBub2RlIDAKPiBtb3ZlX3BhZ2VzMTIuYzoxNzk6
IElORk86IEFsbG9jYXRpbmcgYW5kIGZyZWVpbmcgNCBodWdlcGFnZXMgb24gbm9kZSAxCj4gbW92
ZV9wYWdlczEyLmM6MTY5OiBQQVNTOiBCdWcgbm90IHJlcHJvZHVjZWQKPiBtb3ZlX3BhZ2VzMTIu
Yzo4MTogRkFJTDogbWFkdmlzZSBmYWlsZWQ6IFNVQ0NFU1MKPiBtb3ZlX3BhZ2VzMTIuYzo4MTog
RkFJTDogbWFkdmlzZSBmYWlsZWQ6IFNVQ0NFU1MKPiBtb3ZlX3BhZ2VzMTIuYzoxNDM6IEJST0s6
IG1tYXAoKG5pbCksNDE5NDMwNCwzLDI2MjE3OCwtMSwwKSBmYWlsZWQ6IEVOT01FTQo+IG1vdmVf
cGFnZXMxMi5jOjExNDogRkFJTDogbW92ZV9wYWdlcyBmYWlsZWQ6IEVJTlZBTAo+IAo+IERtZXNn
Ogo+IC0tLS0tLQo+IFsxNjU0MzUuNDkyMTcwXSBzb2Z0IG9mZmxpbmU6IDB4NjFjMDAgaHVnZXBh
Z2UgZmFpbGVkIHRvIGlzb2xhdGUKPiBbMTY1NDM1LjU5MDI1Ml0gc29mdCBvZmZsaW5lOiAweDYx
YzAwIGh1Z2VwYWdlIGZhaWxlZCB0byBpc29sYXRlCj4gWzE2NTQzNS43MjU0OTNdIHNvZnQgb2Zm
bGluZTogMHg2MTQwMCBodWdlcGFnZSBmYWlsZWQgdG8gaXNvbGF0ZQo+IAo+IE90aGVyIHR3byBm
aXhlcyBpbiB0aGlzIHBhdGNoOgo+ICAqIHVzZSBURVJSTk8oYnV0IG5vdCBUVEVSUk5PKSB0byBj
YXRjaCBtYWR2aXNlKC4uLiwgTUFEVl9TT0ZUX09GRkxJTkUpIGVycm5vCj4gICogZ28gb3V0IHRl
c3Qgd2hlbiBodWdlcGFnZSBhbGxvY2F0aW5nIGZhaWxlZCB3aXRoIEVOT01FTQo+IAo+IFNpZ25l
ZC1vZmYtYnk6IExpIFdhbmcgPGxpd2FuZ0ByZWRoYXQuY29tPgo+IENjOiBOYW95YSBIb3JpZ3Vj
aGkgPG4taG9yaWd1Y2hpQGFoLmpwLm5lYy5jb20+Cj4gQ2M6IFhpYW8gWWFuZyA8eWFuZ3guanlA
Y24uZnVqaXRzdS5jb20+Cj4gQ2M6IFlhbmcgWHUgPHh1eWFuZzIwMTguanlAY24uZnVqaXRzdS5j
b20+Cj4gLS0tCj4gIC4uLi9rZXJuZWwvc3lzY2FsbHMvbW92ZV9wYWdlcy9tb3ZlX3BhZ2VzMTIu
YyB8IDMzICsrKysrKysrKysrKysrLS0tLS0KPiAgMSBmaWxlIGNoYW5nZWQsIDI0IGluc2VydGlv
bnMoKyksIDkgZGVsZXRpb25zKC0pCj4gCj4gZGlmZiAtLWdpdCBhL3Rlc3RjYXNlcy9rZXJuZWwv
c3lzY2FsbHMvbW92ZV9wYWdlcy9tb3ZlX3BhZ2VzMTIuYyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lz
Y2FsbHMvbW92ZV9wYWdlcy9tb3ZlX3BhZ2VzMTIuYwo+IGluZGV4IDk2NGI3MTJmYi4uYzQ0NjM5
NmRjIDEwMDY0NAo+IC0tLSBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbW92ZV9wYWdlcy9t
b3ZlX3BhZ2VzMTIuYwo+ICsrKyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbW92ZV9wYWdl
cy9tb3ZlX3BhZ2VzMTIuYwo+IEBAIC03Nyw4ICs3Nyw4IEBAIHN0YXRpYyB2b2lkICphZGRyOwo+
ICBzdGF0aWMgaW50IGRvX3NvZnRfb2ZmbGluZShpbnQgdHBncykKPiAgewo+ICAJaWYgKG1hZHZp
c2UoYWRkciwgdHBncyAqIGhwc3osIE1BRFZfU09GVF9PRkZMSU5FKSA9PSAtMSkgewo+IC0JCWlm
IChlcnJubyAhPSBFSU5WQUwpCj4gLQkJCXRzdF9yZXMoVEZBSUwgfCBUVEVSUk5PLCAibWFkdmlz
ZSBmYWlsZWQiKTsKPiArCQlpZiAoZXJybm8gIT0gRUlOVkFMICYmIGVycm5vICE9IEVCVVNZKQo+
ICsJCQl0c3RfcmVzKFRGQUlMIHwgVEVSUk5PLCAibWFkdmlzZSBmYWlsZWQiKTsKPiAgCQlyZXR1
cm4gZXJybm87Cj4gIAl9Cj4gIAlyZXR1cm4gMDsKPiBAQCAtMTIxLDcgKzEyMSw4IEBAIHN0YXRp
YyB2b2lkIGRvX2NoaWxkKGludCB0cGdzKQo+ICAKPiAgc3RhdGljIHZvaWQgZG9fdGVzdCh1bnNp
Z25lZCBpbnQgbikKPiAgewo+IC0JaW50IGk7Cj4gKwlpbnQgaSwgcmV0Owo+ICsJdm9pZCAqcHRy
Owo+ICAJcGlkX3QgY3BpZCA9IC0xOwo+ICAJaW50IHN0YXR1czsKPiAgCXVuc2lnbmVkIGludCB0
d2VudHlfcGVyY2VudCA9ICh0c3RfdGltZW91dF9yZW1haW5pbmcoKSAvIDUpOwo+IEBAIC0xMzYs
MjQgKzEzNywzNyBAQCBzdGF0aWMgdm9pZCBkb190ZXN0KHVuc2lnbmVkIGludCBuKQo+ICAJCWRv
X2NoaWxkKHRjYXNlc1tuXS50cGFnZXMpOwo+ICAKPiAgCWZvciAoaSA9IDA7IGkgPCBMT09QUzsg
aSsrKSB7Cj4gLQkJdm9pZCAqcHRyOwo+ICsJCXB0ciA9IG1tYXAoTlVMTCwgdGNhc2VzW25dLnRw
YWdlcyAqIGhwc3osCj4gKwkJCQlQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLAo+ICsJCQkJTUFQX1BS
SVZBVEUgfCBNQVBfQU5PTllNT1VTIHwgTUFQX0hVR0VUTEIsIC0xLCAwKTsKPiArCQlpZiAocHRy
ID09IE1BUF9GQUlMRUQpIHsKPiArCQkJaWYgKGVycm5vID09IEVOT01FTSkgewo+ICsJCQkJdHN0
X3JlcyhUQ09ORiwKPiArCQkJCQkiQ2Fubm90IGFsbG9jYXRlIGh1Z2VwYWdlLCBtZW1vcnkgdG9v
IGZyYWdtZW50ZWQ/Iik7Cj4gKwkJCQlnb3RvIG91dDsKPiArCQkJfQo+ICsKPiArCQkJdHN0X2Jy
ayhUQlJPSyB8IFRFUlJOTywgIkNhbm5vdCBhbGxvY2F0ZSBodWdlcGFnZSIpOwo+ICsJCX0KPiAg
Cj4gLQkJcHRyID0gU0FGRV9NTUFQKE5VTEwsIHRjYXNlc1tuXS50cGFnZXMgKiBocHN6LAo+IC0J
CQlQUk9UX1JFQUQgfCBQUk9UX1dSSVRFLAo+IC0JCQlNQVBfUFJJVkFURSB8IE1BUF9BTk9OWU1P
VVMgfCBNQVBfSFVHRVRMQiwgLTEsIDApOwo+ICAJCWlmIChwdHIgIT0gYWRkcikKPiAgCQkJdHN0
X2JyayhUQlJPSywgIkZhaWxlZCB0byBtbWFwIGF0IGRlc2lyZWQgYWRkciIpOwo+ICAKPiAgCQlt
ZW1zZXQoYWRkciwgMCwgdGNhc2VzW25dLnRwYWdlcyAqIGhwc3opOwo+ICAKPiAgCQlpZiAodGNh
c2VzW25dLm9mZmxpbmUpIHsKPiAtCQkJaWYgKGRvX3NvZnRfb2ZmbGluZSh0Y2FzZXNbbl0udHBh
Z2VzKSA9PSBFSU5WQUwpIHsKPiArCQkJcmV0ID0gZG9fc29mdF9vZmZsaW5lKHRjYXNlc1tuXS50
cGFnZXMpOwo+ICsKPiArCQkJaWYgKHJldCA9PSBFSU5WQUwpIHsKPiAgCQkJCVNBRkVfS0lMTChj
cGlkLCBTSUdLSUxMKTsKPiAgCQkJCVNBRkVfV0FJVFBJRChjcGlkLCAmc3RhdHVzLCAwKTsKPiAg
CQkJCVNBRkVfTVVOTUFQKGFkZHIsIHRjYXNlc1tuXS50cGFnZXMgKiBocHN6KTsKPiAgCQkJCXRz
dF9yZXMoVENPTkYsCj4gIAkJCQkJIm1hZHZpc2UoKSBkaWRuJ3Qgc3VwcG9ydCBNQURWX1NPRlRf
T0ZGTElORSIpOwo+ICAJCQkJcmV0dXJuOwo+ICsJCQl9IGVsc2UgaWYgKHJldCA9PSBFQlVTWSkg
ewo+ICsJCQkJU0FGRV9NVU5NQVAoYWRkciwgdGNhc2VzW25dLnRwYWdlcyAqIGhwc3opOwo+ICsJ
CQkJZ290byBvdXQ7Cj4gIAkJCX0KPiAgCQl9Cj4gIAo+IEBAIC0xNjMsOSArMTc3LDEwIEBAIHN0
YXRpYyB2b2lkIGRvX3Rlc3QodW5zaWduZWQgaW50IG4pCj4gIAkJCWJyZWFrOwo+ICAJfQo+ICAK
PiArb3V0Ogo+ICAJU0FGRV9LSUxMKGNwaWQsIFNJR0tJTEwpOwo+ICAJU0FGRV9XQUlUUElEKGNw
aWQsICZzdGF0dXMsIDApOwo+IC0JaWYgKCFXSUZFWElURUQoc3RhdHVzKSkKPiArCWlmICghV0lG
RVhJVEVEKHN0YXR1cykgJiYgcHRyICE9IE1BUF9GQUlMRUQpCj4gIAkJdHN0X3JlcyhUUEFTUywg
IkJ1ZyBub3QgcmVwcm9kdWNlZCIpOwo+ICB9Cj4gIAo+IC0tIAo+IDIuMjAuMQo+IAo+IAoKLS0g
Ck1haWxpbmcgbGlzdCBpbmZvOiBodHRwczovL2xpc3RzLmxpbnV4Lml0L2xpc3RpbmZvL2x0cAo=
