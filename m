Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [213.254.12.146])
	by mail.lfdr.de (Postfix) with ESMTPS id 8676747FCF
	for <lists+linux-ltp@lfdr.de>; Mon, 17 Jun 2019 12:36:04 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id 542102987A8
	for <lists+linux-ltp@lfdr.de>; Mon, 17 Jun 2019 12:36:04 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-2.smtp.seeweb.it (in-2.smtp.seeweb.it
 [IPv6:2001:4b78:1:20::2])
 by picard.linux.it (Postfix) with ESMTP id 932FC3EA3FB
 for <ltp@lists.linux.it>; Mon, 17 Jun 2019 12:36:03 +0200 (CEST)
Received: from mail-pl1-x643.google.com (mail-pl1-x643.google.com
 [IPv6:2607:f8b0:4864:20::643])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by in-2.smtp.seeweb.it (Postfix) with ESMTPS id 96C4A600436
 for <ltp@lists.linux.it>; Mon, 17 Jun 2019 12:36:02 +0200 (CEST)
Received: by mail-pl1-x643.google.com with SMTP id a93so3933648pla.7
 for <ltp@lists.linux.it>; Mon, 17 Jun 2019 03:36:02 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=mbobrowski-org.20150623.gappssmtp.com; s=20150623;
 h=date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:in-reply-to:user-agent;
 bh=PLrt5HtDNgjh5lkXPr8LSWRC3Szc0dsLUR740+yqjfk=;
 b=Gz4fF7wUp3ihHgGcudZZ9fLZ8V/9TAyWp5gmt3wL2t7+ow9tjhxlHaJfWcKbbYNUga
 OFEWRm1Eqda1IhWOBVOCG7ec1mllyKG9qjxT0zUuFAwzVivMxregwbX46IYCSBt1Tfg9
 SnUeGcmZZY8rQHkPPDaWd3qNE0jAumdQmZxn/6yLb+98xsFpYvTRgYxi0gma2HzQtb3D
 9b/iZHaRnJsOXR/BuF++gwA7HUr8ZtS0SvwNUNmoRyB4lDGj/IEePbLmQCunYPtDwx2F
 3SJi/Ib6UuWVNLt/E3/VgZE03YKU7oKNMa3g8RFx0uFmKSvLuhw4847A4wYXhKe+XwZI
 Aqwg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id:references
 :mime-version:content-disposition:in-reply-to:user-agent;
 bh=PLrt5HtDNgjh5lkXPr8LSWRC3Szc0dsLUR740+yqjfk=;
 b=gQbh8rSs1UWhGP7I0t77j2WnqWuV3SoTY+jtr88IMfVg2MQVjxcwZVMHAxK+v1OWZD
 gN+PoXyrM/LzhvvuUyjekDSMZSsHXr8s9WVCB0xI2DaA5j3pEU0CTQgj052n0u6mjSM3
 4FXvhYq0TDc7fx+pDUKoNWnHBFjN0281kaLy0ctFVjNK2wRdeAmFFWTMbgkTFb1NAOlr
 omjFIB8Mt6W6gdNUiARtstPBcTjItW+7Y7ewxqPGZFWu7Z5i7niFTwzILCKZ7vYJlY5g
 C1vzgGvMXE4VahFvKQAkuKyPgwnTaFL/fNErJqj2NHhQsKdu4APi0GJqUVYJiMQXi+Sx
 FqqA==
X-Gm-Message-State: APjAAAUpjJ9FhhVOHqbSYqKT6+TctEDQuUGW/6t5AEyGYmxijwlL6wwq
 NbMTpCM4LmGdBxDc7sHPZk276iZz0A==
X-Google-Smtp-Source: APXvYqwk+9RC+2tA7wSPo5ZHCy0OpcLIdPi5igDymUCcjqCUAQl+6rHaVAff7evRgPQWfcPwwfiFZw==
X-Received: by 2002:a17:902:6902:: with SMTP id
 j2mr34973322plk.321.1560767760787; 
 Mon, 17 Jun 2019 03:36:00 -0700 (PDT)
Received: from poseidon.Home ([114.78.0.167])
 by smtp.gmail.com with ESMTPSA id a12sm27561538pje.3.2019.06.17.03.35.58
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Mon, 17 Jun 2019 03:36:00 -0700 (PDT)
Date: Mon, 17 Jun 2019 20:35:54 +1000
From: Matthew Bobrowski <mbobrowski@mbobrowski.org>
To: ltp@lists.linux.it
Message-ID: <47bebd8ca3dd68b02137f344488dd1a713874fa0.1560766652.git.mbobrowski@mbobrowski.org>
References: <cover.1560766652.git.mbobrowski@mbobrowski.org>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <cover.1560766652.git.mbobrowski@mbobrowski.org>
User-Agent: Mutt/1.11.3 (2019-02-01)
X-Virus-Scanned: clamav-milter 0.99.2 at in-2.smtp.seeweb.it
X-Virus-Status: Clean
X-Spam-Status: No, score=0.1 required=7.0 tests=DKIM_SIGNED,DKIM_VALID,
 SPF_HELO_NONE,SPF_NONE autolearn=disabled version=3.4.0
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on in-2.smtp.seeweb.it
Cc: jack@suse.cz
Subject: [LTP] [PATCH v4 3/3] syscalls/fanotify15: verify fid for dirent
	events
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

QSBuZXcgdGVzdCBmaWxlIHRoYXQgcHJvdmlkZXMgY292ZXJhZ2UgZm9yIG5ldyBkaXJlbnQgZXZl
bnRzIGhhcyBiZWVuCmFkZGVkLiBBIG5ldyBsaW5lIGVudHJ5IHdpdGhpbiB0aGUgcnVudGVzdC9z
eXNjYWxscyBmaWxlIGhhcyBiZWVuIGFsc28KYWRkZWQgdG8gc3VwcG9ydCB0aGUgdGVzdGluZyBv
ZiB0aGVzZSBuZXcgZGlyZW50IGV2ZW50cy4KClNpZ25lZC1vZmYtYnk6IE1hdHRoZXcgQm9icm93
c2tpIDxtYm9icm93c2tpQG1ib2Jyb3dza2kub3JnPgpSZXZpZXdlZC1ieTogQW1pciBHb2xkc3Rl
aW4gPGFtaXI3M2lsQGdtYWlsLmNvbT4KLS0tCiBydW50ZXN0L3N5c2NhbGxzICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgfCAgIDEgKwogdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9mYW5v
dGlmeS8uZ2l0aWdub3JlIHwgICAxICsKIC4uLi9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvZmFu
b3RpZnkxNS5jICAgICB8IDI0NSArKysrKysrKysrKysrKysrKysKIDMgZmlsZXMgY2hhbmdlZCwg
MjQ3IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0Y2FzZXMva2VybmVsL3N5
c2NhbGxzL2Zhbm90aWZ5L2Zhbm90aWZ5MTUuYwoKZGlmZiAtLWdpdCBhL3J1bnRlc3Qvc3lzY2Fs
bHMgYi9ydW50ZXN0L3N5c2NhbGxzCmluZGV4IDU2Zjg0ODI0YS4uMjVjYjI5ZGFiIDEwMDY0NAot
LS0gYS9ydW50ZXN0L3N5c2NhbGxzCisrKyBiL3J1bnRlc3Qvc3lzY2FsbHMKQEAgLTUzNiw2ICs1
MzYsNyBAQCBmYW5vdGlmeTExIGZhbm90aWZ5MTEKIGZhbm90aWZ5MTIgZmFub3RpZnkxMgogZmFu
b3RpZnkxMyBmYW5vdGlmeTEzCiBmYW5vdGlmeTE0IGZhbm90aWZ5MTQKK2Zhbm90aWZ5MTUgZmFu
b3RpZnkxNQogCiBpb3Blcm0wMSBpb3Blcm0wMQogaW9wZXJtMDIgaW9wZXJtMDIKZGlmZiAtLWdp
dCBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdpdGlnbm9yZSBiL3Rlc3Rj
YXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdpdGlnbm9yZQppbmRleCBiZjM4OWM5NmEu
LjY4ZTRjYzdhYSAxMDA2NDQKLS0tIGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9mYW5vdGlm
eS8uZ2l0aWdub3JlCisrKyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdp
dGlnbm9yZQpAQCAtMTIsNCArMTIsNSBAQAogL2Zhbm90aWZ5MTIKIC9mYW5vdGlmeTEzCiAvZmFu
b3RpZnkxNAorL2Zhbm90aWZ5MTUKIC9mYW5vdGlmeV9jaGlsZApkaWZmIC0tZ2l0IGEvdGVzdGNh
c2VzL2tlcm5lbC9zeXNjYWxscy9mYW5vdGlmeS9mYW5vdGlmeTE1LmMgYi90ZXN0Y2FzZXMva2Vy
bmVsL3N5c2NhbGxzL2Zhbm90aWZ5L2Zhbm90aWZ5MTUuYwpuZXcgZmlsZSBtb2RlIDEwMDY0NApp
bmRleCAwMDAwMDAwMDAuLjAyZjNiMzRhYgotLS0gL2Rldi9udWxsCisrKyBiL3Rlc3RjYXNlcy9r
ZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvZmFub3RpZnkxNS5jCkBAIC0wLDAgKzEsMjQ1IEBACisv
LyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRlcgorLyoKKyAqIENvcHly
aWdodCAoYykgMjAxOSBDVEVSQSBOZXR3b3Jrcy4gQWxsIFJpZ2h0cyBSZXNlcnZlZC4KKyAqCisg
KiBTdGFydGVkIGJ5IEFtaXIgR29sZHN0ZWluIDxhbWlyNzNpbEBnbWFpbC5jb20+CisgKiBNb2Rp
ZmllZCBieSBNYXR0aGV3IEJvYnJvd3NraSA8bWJvYnJvd3NraUBtYm9icm93c2tpLm9yZz4KKyAq
CisgKiBERVNDUklQVElPTgorICoJVGVzdCBmaWxlIHRoYXQgaGFzIGJlZW4gcHVycG9zZWx5IGRl
c2lnbmVkIHRvIHZlcmlmeQorICoJRkFOX1JFUE9SVF9GSUQgZnVuY3Rpb25hbGl0eSB3aGlsZSB1
c2luZyBuZXdseSBkZWZpbmVkIGRpcmVudAorICoJZXZlbnRzLgorICovCisjZGVmaW5lIF9HTlVf
U09VUkNFCisjaW5jbHVkZSAiY29uZmlnLmgiCisKKyNpbmNsdWRlIDxzdHJpbmcuaD4KKyNpbmNs
dWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGZjbnRsLmg+CisjaW5jbHVkZSA8c3lzL3N0YXRmcy5o
PgorI2luY2x1ZGUgPHN5cy90eXBlcy5oPgorCisjaW5jbHVkZSAidHN0X3Rlc3QuaCIKKyNpbmNs
dWRlICJmYW5vdGlmeS5oIgorCisjaWYgZGVmaW5lZChIQVZFX1NZU19GQU5PVElGWV9IKQorI2lu
Y2x1ZGUgPHN5cy9mYW5vdGlmeS5oPgorCisjZGVmaW5lIEJVRl9TSVpFIDI1NgorI2RlZmluZSBF
VkVOVF9NQVggMjU2CisKKyNkZWZpbmUgTU9VTlRfUE9JTlQgIm1udHBvaW50IgorI2RlZmluZSBU
RVNUX0RJUiBNT1VOVF9QT0lOVCIvdGVzdF9kaXIiCisjZGVmaW5lIERJUjEgVEVTVF9ESVIiL2Rp
cjEiCisjZGVmaW5lIERJUjIgVEVTVF9ESVIiL2RpcjIiCisjZGVmaW5lIEZJTEUxIFRFU1RfRElS
Ii9maWxlMSIKKyNkZWZpbmUgRklMRTIgVEVTVF9ESVIiL2ZpbGUyIgorCitzdHJ1Y3QgZXZlbnRf
dCB7CisJdW5zaWduZWQgbG9uZyBsb25nIG1hc2s7CisJX19rZXJuZWxfZnNpZF90IGZzaWQ7CisJ
c3RydWN0IGZpbGVfaGFuZGxlIGhhbmRsZTsKKwljaGFyIGJ1ZltNQVhfSEFORExFX1NaXTsKK307
CisKK3N0YXRpYyBpbnQgZmFub3RpZnlfZmQ7CitzdGF0aWMgY2hhciBldmVudHNfYnVmW0JVRl9T
SVpFXTsKK3N0YXRpYyBzdHJ1Y3QgZXZlbnRfdCBldmVudF9zZXRbRVZFTlRfTUFYXTsKKworc3Rh
dGljIHZvaWQgZG9fc2V0dXAodm9pZCkKK3sKKwlpbnQgZmQ7CisKKwkvKiBDaGVjayBrZXJuZWwg
Zm9yIGZhbm90aWZ5IHN1cHBvcnQgKi8KKwlmZCA9IFNBRkVfRkFOT1RJRllfSU5JVChGQU5fQ0xB
U1NfTk9USUYsIE9fUkRPTkxZKTsKKwlTQUZFX0NMT1NFKGZkKTsKKworCWZhbm90aWZ5X2ZkID0g
ZmFub3RpZnlfaW5pdChGQU5fUkVQT1JUX0ZJRCwgT19SRE9OTFkpOworCWlmIChmYW5vdGlmeV9m
ZCA9PSAtMSkgeworCQlpZiAoZXJybm8gPT0gRUlOVkFMKQorCQkJdHN0X2JyayhUQ09ORiwKKwkJ
CQkiRkFOX1JFUE9SVF9GSUQgbm90IHN1cHBvcnRlZCBpbiBrZXJuZWwiKTsKKwkJdHN0X2JyayhU
QlJPSyB8IFRFUlJOTywKKwkJCSJmYW5vdGlmeV9pbml0KEZBTl9SRVBPUlRfRklELCBPX1JET05M
WSkgZmFpbGVkIik7CisJfQorCisJU0FGRV9NS0RJUihURVNUX0RJUiwgMDc1NSk7Cit9CisKK3N0
YXRpYyB2b2lkIGRvX3Rlc3Qodm9pZCkKK3sKKwlpbnQgaSwgZmQsIGxlbiwgY291bnQgPSAwOwor
CisJc3RydWN0IGZpbGVfaGFuZGxlICpldmVudF9maWxlX2hhbmRsZTsKKwlzdHJ1Y3QgZmFub3Rp
ZnlfZXZlbnRfbWV0YWRhdGEgKm1ldGFkYXRhOworCXN0cnVjdCBmYW5vdGlmeV9ldmVudF9pbmZv
X2ZpZCAqZXZlbnRfZmlkOworCisJaWYgKGZhbm90aWZ5X21hcmsoZmFub3RpZnlfZmQsIEZBTl9N
QVJLX0FERCB8IEZBTl9NQVJLX0ZJTEVTWVNURU0sCisJCQkJRkFOX0NSRUFURSB8IEZBTl9ERUxF
VEUgfCBGQU5fQVRUUklCIHwKKwkJCQlGQU5fTU9WRURfRlJPTSB8IEZBTl9NT1ZFRF9UTyB8CisJ
CQkJRkFOX0RFTEVURV9TRUxGIHwgRkFOX09ORElSLAorCQkJCUFUX0ZEQ1dELCBURVNUX0RJUikg
PT0gLTEpIHsKKwkJaWYgKGVycm5vID09IEVOT0RFVikKKwkJCXRzdF9icmsoVENPTkYsCisJCQkJ
IkZBTl9SRVBPUlRfRklEIG5vdCBzdXBwb3J0ZWQgb24gJXMgIgorCQkJCSJmaWxlc3lzdGVtIiwg
dHN0X2RldmljZS0+ZnNfdHlwZSk7CisJCXRzdF9icmsoVEJST0sgfCBURVJSTk8sCisJCQkiZmFu
b3RpZnlfbWFyayglZCwgRkFOX01BUktfQURELCBGQU5fQ1JFQVRFIHwgIgorCQkJIkZBTl9ERUxF
VEUgfCBGQU5fTU9WRURfRlJPTSB8IEZBTl9NT1ZFRF9UTyB8ICIKKwkJCSJGQU5fREVMRVRFX1NF
TEYgfCBGQU5fT05ESVIsIEFUX0ZEQ1dELCAlcykgZmFpbGVkIiwKKwkJCWZhbm90aWZ5X2ZkLCBU
RVNUX0RJUik7CisJfQorCisJLyogR2VuZXJhdGUgYSBzZXF1ZW5jZSBvZiBldmVudHMgKi8KKwll
dmVudF9zZXRbY291bnRdLm1hc2sgPSBGQU5fQ1JFQVRFIHwgRkFOX01PVkVEX0ZST00gfCBGQU5f
TU9WRURfVE8gfCBcCisJCQkJRkFOX0RFTEVURTsKKwlldmVudF9zZXRbY291bnRdLmhhbmRsZS5o
YW5kbGVfYnl0ZXMgPSBNQVhfSEFORExFX1NaOworCWZhbm90aWZ5X2dldF9maWQoVEVTVF9ESVIs
ICZldmVudF9zZXRbY291bnRdLmZzaWQsCisJCQkgJmV2ZW50X3NldFtjb3VudF0uaGFuZGxlKTsK
Kwljb3VudCsrOworCisJZmQgPSBTQUZFX0NSRUFUKEZJTEUxLCAwNjQ0KTsKKwlTQUZFX0NMT1NF
KGZkKTsKKworCVNBRkVfUkVOQU1FKEZJTEUxLCBGSUxFMik7CisKKwlldmVudF9zZXRbY291bnRd
Lm1hc2sgPSBGQU5fQVRUUklCIHwgRkFOX0RFTEVURV9TRUxGOworCWV2ZW50X3NldFtjb3VudF0u
aGFuZGxlLmhhbmRsZV9ieXRlcyA9IE1BWF9IQU5ETEVfU1o7CisJZmFub3RpZnlfZ2V0X2ZpZChG
SUxFMiwgJmV2ZW50X3NldFtjb3VudF0uZnNpZCwKKwkJCSAmZXZlbnRfc2V0W2NvdW50XS5oYW5k
bGUpOworCWNvdW50Kys7CisKKwlTQUZFX1VOTElOSyhGSUxFMik7CisKKwkvKiBHZW5lcmF0ZSBh
IHNlcXVlbmNlIG9mIGV2ZW50cyBvbiBhIGRpcmVjdG9yeS4gU3Vic2VxdWVudCBldmVudHMKKwkg
KiBhcmUgbWVyZ2VkLCBzbyBpdCdzIHJlcXVpcmVkIHRoYXQgd2Ugc2V0IEZBTl9PTkRJUiBvbmNl
IGluCisJICogb3JkZXIgdG8gYWNrbm93bGVkZ2UgdGhhdCBjaGFuZ2VzIHJlbGF0ZWQgdG8gYSBz
dWJkaXJlY3RvcnkKKwkgKiB0b29rIHBsYWNlLiBFdmVudHMgb24gc3ViZGlyZWN0b3JpZXMgYXJl
IG5vdCBtZXJnZWQgd2l0aCBldmVudHMKKwkgKiBvbiBub24tc3ViZGlyZWN0b3JpZXMuCisJICov
CisJZXZlbnRfc2V0W2NvdW50XS5tYXNrID0gRkFOX09ORElSIHwgRkFOX0NSRUFURSB8IEZBTl9N
T1ZFRF9GUk9NIHwgXAorCQkJCUZBTl9NT1ZFRF9UTyB8IEZBTl9ERUxFVEU7CisJZXZlbnRfc2V0
W2NvdW50XS5oYW5kbGUuaGFuZGxlX2J5dGVzID0gTUFYX0hBTkRMRV9TWjsKKwlmYW5vdGlmeV9n
ZXRfZmlkKFRFU1RfRElSLCAmZXZlbnRfc2V0W2NvdW50XS5mc2lkLAorCQkJICZldmVudF9zZXRb
Y291bnRdLmhhbmRsZSk7CisJY291bnQrKzsKKworCVNBRkVfTUtESVIoRElSMSwgMDc1NSk7CisK
KwlTQUZFX1JFTkFNRShESVIxLCBESVIyKTsKKworCWV2ZW50X3NldFtjb3VudF0ubWFzayA9IEZB
Tl9PTkRJUiB8IEZBTl9ERUxFVEVfU0VMRjsKKwlldmVudF9zZXRbY291bnRdLmhhbmRsZS5oYW5k
bGVfYnl0ZXMgPSBNQVhfSEFORExFX1NaOworCWZhbm90aWZ5X2dldF9maWQoRElSMiwgJmV2ZW50
X3NldFtjb3VudF0uZnNpZCwKKwkJCSAmZXZlbnRfc2V0W2NvdW50XS5oYW5kbGUpOworCWNvdW50
Kys7CisKKwlTQUZFX1JNRElSKERJUjIpOworCisJLyogUmVhZCBldmVudHMgZnJvbSB0aGUgZXZl
bnQgcXVldWUgKi8KKwlsZW4gPSBTQUZFX1JFQUQoMCwgZmFub3RpZnlfZmQsIGV2ZW50c19idWYs
IEJVRl9TSVpFKTsKKworCS8qIFByb2Nlc3MgZWFjaCBldmVudCBpbiBidWZmZXIgKi8KKwlmb3Ig
KGkgPSAwLCBtZXRhZGF0YSA9IChzdHJ1Y3QgZmFub3RpZnlfZXZlbnRfbWV0YWRhdGEgKikgZXZl
bnRzX2J1ZjsKKwkJRkFOX0VWRU5UX09LKG1ldGFkYXRhLCBsZW4pOworCQltZXRhZGF0YSA9IEZB
Tl9FVkVOVF9ORVhUKG1ldGFkYXRhLGxlbiksIGkrKykgeworCQlldmVudF9maWQgPSAoc3RydWN0
IGZhbm90aWZ5X2V2ZW50X2luZm9fZmlkICopIChtZXRhZGF0YSArIDEpOworCQlldmVudF9maWxl
X2hhbmRsZSA9IChzdHJ1Y3QgZmlsZV9oYW5kbGUgKikgZXZlbnRfZmlkLT5oYW5kbGU7CisKKwkJ
aWYgKGkgPj0gY291bnQpIHsKKwkJCXRzdF9yZXMoVEZBSUwsCisJCQkJImdvdCB1bm5lY2Vzc2Fy
eSBldmVudDogbWFzaz0lbGx4ICIKKwkJCQkicGlkPSV1IGZkPSVkIiwKKwkJCQkodW5zaWduZWQg
bG9uZyBsb25nKSBtZXRhZGF0YS0+bWFzaywKKwkJCQltZXRhZGF0YS0+cGlkLAorCQkJCW1ldGFk
YXRhLT5mZCk7CisJCQltZXRhZGF0YS0+bWFzayA9IDA7CisJCX0gZWxzZSBpZiAobWV0YWRhdGEt
PmZkICE9IEZBTl9OT0ZEKSB7CisJCQl0c3RfcmVzKFRGQUlMLAorCQkJCSJSZWNlaXZlZCB1bmV4
cGVjdGVkIGZpbGUgZGVzY3JpcHRvciAlZCBpbiAiCisJCQkJImV2ZW50LiBFeHBlY3RlZCB0byBn
ZXQgRkFOX05PRkQoJWQpIiwKKwkJCQltZXRhZGF0YS0+ZmQsIEZBTl9OT0ZEKTsKKwkJfSBlbHNl
IGlmIChtZXRhZGF0YS0+bWFzayAhPSBldmVudF9zZXRbaV0ubWFzaykgeworCQkJdHN0X3JlcyhU
RkFJTCwKKwkJCQkiR290IGV2ZW50OiBtYXNrPSVsbHggKGV4cGVjdGVkICVsbHgpICIKKwkJCQki
cGlkPSV1IGZkPSVkIiwKKwkJCQkodW5zaWduZWQgbG9uZyBsb25nKSBtZXRhZGF0YS0+bWFzaywK
KwkJCQlldmVudF9zZXRbaV0ubWFzaywKKwkJCQkodW5zaWduZWQpIG1ldGFkYXRhLT5waWQsCisJ
CQkJbWV0YWRhdGEtPmZkKTsKKwkJfSBlbHNlIGlmIChtZXRhZGF0YS0+cGlkICE9IGdldHBpZCgp
KSB7CisJCQl0c3RfcmVzKFRGQUlMLAorCQkJCSJHb3QgZXZlbnQ6IG1hc2s9JWxseCBwaWQ9JXUg
IgorCQkJCSIoZXhwZWN0ZWQgJXUpIGZkPSVkIiwKKwkJCQkodW5zaWduZWQgbG9uZyBsb25nKSBt
ZXRhZGF0YS0+bWFzaywKKwkJCQkodW5zaWduZWQpIG1ldGFkYXRhLT5waWQsCisJCQkJKHVuc2ln
bmVkKSBnZXRwaWQoKSwKKwkJCQltZXRhZGF0YS0+ZmQpOworCQl9IGVsc2UgaWYgKGV2ZW50X2Zp
bGVfaGFuZGxlLT5oYW5kbGVfYnl0ZXMgIT0KKwkJCQlldmVudF9zZXRbaV0uaGFuZGxlLmhhbmRs
ZV9ieXRlcykgeworCQkJdHN0X3JlcyhURkFJTCwKKwkJCQkiR290IGV2ZW50OiBoYW5kbGVfYnl0
ZXMgKCV4KSByZXR1cm5lZCBpbiAiCisJCQkJImV2ZW50IGRvZXMgbm90IGVxdWFsIGhhbmRsZV9i
eXRlcyAoJXgpICIKKwkJCQkicmV0dW5yZWQgaW4gbmFtZV90b19oYW5kbGVfYXQoMikiLAorCQkJ
CWV2ZW50X2ZpbGVfaGFuZGxlLT5oYW5kbGVfYnl0ZXMsCisJCQkJZXZlbnRfc2V0W2ldLmhhbmRs
ZS5oYW5kbGVfYnl0ZXMpOworCQl9IGVsc2UgaWYgKGV2ZW50X2ZpbGVfaGFuZGxlLT5oYW5kbGVf
dHlwZSAhPQorCQkJCWV2ZW50X3NldFtpXS5oYW5kbGUuaGFuZGxlX3R5cGUpIHsKKwkJCXRzdF9y
ZXMoVEZBSUwsCisJCQkJImhhbmRsZV90eXBlICgleCkgcmV0dXJuZWQgaW4gZXZlbnQgZG9lcyBu
b3QgIgorCQkJCSJlcXVhbCB0byBoYW5kbGVfdHlwZSAoJXgpIHJldHVybmVkIGluICIKKwkJCQki
bmFtZV90b19oYW5kbGVfYXQoMikiLAorCQkJCWV2ZW50X2ZpbGVfaGFuZGxlLT5oYW5kbGVfdHlw
ZSwKKwkJCQlldmVudF9zZXRbaV0uaGFuZGxlLmhhbmRsZV90eXBlKTsKKwkJfSBlbHNlIGlmICht
ZW1jbXAoZXZlbnRfZmlsZV9oYW5kbGUtPmZfaGFuZGxlLAorCQkJCQlldmVudF9zZXRbaV0uaGFu
ZGxlLmZfaGFuZGxlLAorCQkJCQlldmVudF9zZXRbaV0uaGFuZGxlLmhhbmRsZV9ieXRlcykKKwkJ
CQkJIT0gMCkgeworCQkJdHN0X3JlcyhURkFJTCwKKwkJCQkiZXZlbnRfZmlsZV9oYW5kbGUtPmZf
aGFuZGxlIGRvZXMgbm90IG1hdGNoICIKKwkJCQkiaGFuZGxlLmZfaGFuZGxlIHJldHVybmVkIGlu
ICIKKwkJCQkibmFtZV90b19oYW5kbGVfYXQoMikiKTsKKwkJfSBlbHNlIGlmIChtZW1jbXAoJmV2
ZW50X2ZpZC0+ZnNpZCwgJmV2ZW50X3NldFtpXS5mc2lkLAorCQkJCQlzaXplb2YoZXZlbnRfc2V0
W2ldLmZzaWQpKSAhPSAwKSB7CisJCQl0c3RfcmVzKFRGQUlMLAorCQkJCSJldmVudF9maWQtPmZz
aWQgIT0gc3RhdHMuZl9mc2lkIHRoYXQgd2FzICIKKwkJCQkib2J0YWluZWQgdmlhIHN0YXRmcygy
KSIpOworCQl9IGVsc2UgeworCQkJdHN0X3JlcyhUUEFTUywKKwkJCQkiR290IGV2ZW50OiBtYXNr
PSVsbHgsIHBpZD0ldSwgIgorCQkJCSJmaWQ9JXguJXguJWx4IHZhbHVlcyIsCisJCQkJbWV0YWRh
dGEtPm1hc2ssCisJCQkJZ2V0cGlkKCksCisJCQkJZXZlbnRfZmlkLT5mc2lkLnZhbFswXSwKKwkJ
CQlldmVudF9maWQtPmZzaWQudmFsWzFdLAorCQkJCSoodW5zaWduZWQgbG9uZyAqKQorCQkJCWV2
ZW50X2ZpbGVfaGFuZGxlLT5mX2hhbmRsZSk7CisJCX0KKwl9CisKKwlmb3IgKDsgaSA8IGNvdW50
OyBpKyspCisJCXRzdF9yZXMoVEZBSUwsCisJCQkiRGlkbid0IHJlY2VpdmUgZXZlbnQ6IG1hc2s9
JWxseCIsCisJCQlldmVudF9zZXRbaV0ubWFzayk7Cit9CisKK3N0YXRpYyB2b2lkIGRvX2NsZWFu
dXAodm9pZCkKK3sKKwlpZiAoZmFub3RpZnlfZmQgPiAwKQorCQlTQUZFX0NMT1NFKGZhbm90aWZ5
X2ZkKTsKK30KKworc3RhdGljIHN0cnVjdCB0c3RfdGVzdCB0ZXN0ID0geworCS5uZWVkc19yb290
ID0gMSwKKwkubmVlZHNfdG1wZGlyID0gMSwKKwkubW91bnRfZGV2aWNlID0gMSwKKwkubW50cG9p
bnQgPSBNT1VOVF9QT0lOVCwKKwkuYWxsX2ZpbGVzeXN0ZW1zID0gMSwKKwkuc2V0dXAgPSBkb19z
ZXR1cCwKKwkudGVzdF9hbGwgPSBkb190ZXN0LAorCS5jbGVhbnVwID0gZG9fY2xlYW51cAorfTsK
KworI2Vsc2UKKwlUU1RfVEVTVF9DT05GKCJTeXN0ZW0gZG9lcyBub3QgaGF2ZSByZXF1aXJlZCBm
YW5vdGlmeSBzdXBwb3J0Iik7CisjZW5kaWYKLS0gCjIuMjEuMAoKCi0tIApNYXR0aGV3IEJvYnJv
d3NraQoKLS0gCk1haWxpbmcgbGlzdCBpbmZvOiBodHRwczovL2xpc3RzLmxpbnV4Lml0L2xpc3Rp
bmZvL2x0cAo=
