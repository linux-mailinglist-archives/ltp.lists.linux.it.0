Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [IPv6:2001:1418:10:5::2])
	by mail.lfdr.de (Postfix) with ESMTPS id E28D592F682
	for <lists+linux-ltp@lfdr.de>; Fri, 12 Jul 2024 09:51:23 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id A48D73D19A5
	for <lists+linux-ltp@lfdr.de>; Fri, 12 Jul 2024 09:51:23 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-2.smtp.seeweb.it (in-2.smtp.seeweb.it [217.194.8.2])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (secp384r1))
 (No client certificate requested)
 by picard.linux.it (Postfix) with ESMTPS id 1F8243CB579
 for <ltp@lists.linux.it>; Fri, 12 Jul 2024 09:51:14 +0200 (CEST)
Authentication-Results: in-2.smtp.seeweb.it; spf=pass (sender SPF authorized)
 smtp.mailfrom=redhat.com (client-ip=170.10.133.124;
 helo=us-smtp-delivery-124.mimecast.com; envelope-from=liwan@redhat.com;
 receiver=lists.linux.it)
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
 (No client certificate requested)
 by in-2.smtp.seeweb.it (Postfix) with ESMTPS id 99F4B60007A
 for <ltp@lists.linux.it>; Fri, 12 Jul 2024 09:51:11 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1720770669;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=2yegnZFZ/2FKDYqhAowHzsx9BZBytLNfZSfmOAuOdn8=;
 b=JPqy88uJd81XFqp5R5mga3EkgXbWHnVUceRQtS1Wc4bXkMPrMWx6umUHQGtIgnHzlbtP7A
 DL1hlqJ4VD/n2mHU+36RXo/5ev0GJiF5WWh21t6WCyw536SGakMPfwr9I4prJxmifdn3lT
 OYZulAG4OaHUvDeER3pOybYdoySrL+4=
Received: from mail-pj1-f72.google.com (mail-pj1-f72.google.com
 [209.85.216.72]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-22-FZ5f9GtUMRGdhE04tX4xUQ-1; Fri, 12 Jul 2024 03:51:04 -0400
X-MC-Unique: FZ5f9GtUMRGdhE04tX4xUQ-1
Received: by mail-pj1-f72.google.com with SMTP id
 98e67ed59e1d1-2c961f68638so1658363a91.2
 for <ltp@lists.linux.it>; Fri, 12 Jul 2024 00:51:04 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1720770663; x=1721375463;
 h=cc:to:subject:message-id:date:from:in-reply-to:references
 :mime-version:x-gm-message-state:from:to:cc:subject:date:message-id
 :reply-to;
 bh=2yegnZFZ/2FKDYqhAowHzsx9BZBytLNfZSfmOAuOdn8=;
 b=xQcyN9eb+LzK+BgLNjmJfJR9pCWKCfZMHc4I5Gcx0wDDGX9m9EK00ipXk+D/Q7npaU
 TAmcgEoB0TBAK/5pO9bMHBxchuu3B//2ahYXy589UCiZW30/kjR91n/nVnsTVjJbk3AV
 T7TQxmFgUs3C4m/WVUhc2quNJCYoIbVmDEfdmzai/3GAtNB+gTEPMBVkna9P2lQfUbXR
 RgQHaKVlA4whr6onFj30gECyJsHJck6lCM3iOhyY/9UE+Eshy0li0MAGRhoYlG0RICkV
 20TiL/BOhRVeEOVFFZWxnObovdGbkvsnWOJs3iewcG7vvfwQUH0BTNZ0AcZz04ITKLb2
 iuxQ==
X-Gm-Message-State: AOJu0YyxK1zrhdSHxnJkEXWkRA3jNRPzYxy5cAKf0VnbZNpx8KsNxx/R
 IDJQ3dZB8hiF4M3jT2Qm+wKciF8fOsIsvJ6gkkDbQ9HzqREF/MRWSdoVJMC8zBW0X0UDpEbwlTH
 jeDglD1Gx3iojd/CPqcUaeW9rqqZOBzdhV95+q4XkhNsgYH5tH10760+J3zgEvelzwRwd+OTpSt
 5Ar/w3UkLW5P5EsAVWtyNdL3uBCXh+0z0f9Q==
X-Received: by 2002:a17:90b:3786:b0:2c9:79d3:a15d with SMTP id
 98e67ed59e1d1-2ca35c7bfb0mr9074919a91.29.1720770662642; 
 Fri, 12 Jul 2024 00:51:02 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IF4VY5mPxpZ8saxmz1quG1GaUTOwHSfMsV+xcC0am2rUQ9HIzLasrKxP7YtJg3WyGf49i53H+KD5TgvLzolW14=
X-Received: by 2002:a17:90b:3786:b0:2c9:79d3:a15d with SMTP id
 98e67ed59e1d1-2ca35c7bfb0mr9074909a91.29.1720770662125; Fri, 12 Jul 2024
 00:51:02 -0700 (PDT)
MIME-Version: 1.0
References: <20240711-landlock-v3-0-c7b0e9edf9b0@suse.com>
 <20240711-landlock-v3-9-c7b0e9edf9b0@suse.com>
In-Reply-To: <20240711-landlock-v3-9-c7b0e9edf9b0@suse.com>
From: Li Wang <liwang@redhat.com>
Date: Fri, 12 Jul 2024 15:50:49 +0800
Message-ID: <CAEemH2cGxKDhzN=CJuiP5Wbp2TXm08Dnj1WSyO2ZUO8+RPG_oQ@mail.gmail.com>
To: Andrea Cervesato <andrea.cervesato@suse.de>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
X-Spam-Status: No, score=0.1 required=7.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,DKIM_VALID_EF,DMARC_PASS,HTML_MESSAGE,SPF_HELO_NONE,
 SPF_PASS shortcircuit=no autolearn=disabled version=4.0.0
X-Spam-Checker-Version: SpamAssassin 4.0.0 (2022-12-13) on in-2.smtp.seeweb.it
X-Virus-Scanned: clamav-milter 1.0.3 at in-2.smtp.seeweb.it
X-Virus-Status: Clean
X-Content-Filtered-By: Mailman/MimeDel 2.1.29
Subject: Re: [LTP] [PATCH v3 09/11] Add landlock04 test
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Cc: ltp@lists.linux.it
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

TmljZSB3b3JrIQpSZXZpZXdlZC1ieTogTGkgV2FuZyA8bGl3YW5nQHJlZGhhdC5jb20+CgpPbiBU
aHUsIEp1bCAxMSwgMjAyNCBhdCA3OjIx4oCvUE0gQW5kcmVhIENlcnZlc2F0byA8YW5kcmVhLmNl
cnZlc2F0b0BzdXNlLmRlPgp3cm90ZToKCj4gRnJvbTogQW5kcmVhIENlcnZlc2F0byA8YW5kcmVh
LmNlcnZlc2F0b0BzdXNlLmNvbT4KPgo+IFRoaXMgdGVzdCB2ZXJpZmllcyB0aGF0IGFsbCBsYW5k
bG9jayBydWxlcyBhcmUgd29ya2luZyBwcm9wZXJseS4KPiBUaGUgd2F5IHdlIGRvIGl0IGlzIHRv
IHZlcmlmeSB0aGF0IGFsbCBkaXNhYmxlZCBzeXNjYWxscyBhcmUgbm90Cj4gd29ya2luZyBidXQg
dGhlIG9uZSB3ZSBlbmFibGVkIHZpYSBzcGVjaWZjIGxhbmRsb2NrIHJ1bGVzLgo+Cj4gU2lnbmVk
LW9mZi1ieTogQW5kcmVhIENlcnZlc2F0byA8YW5kcmVhLmNlcnZlc2F0b0BzdXNlLmNvbT4KPiAt
LS0KPiAgcnVudGVzdC9zeXNjYWxscyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
fCAgIDEgKwo+ICB0ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrLy5naXRpZ25vcmUg
ICAgICB8ICAgMiArCj4gIHRlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxvY2svbGFuZGxv
Y2swNC5jICAgIHwgMjE0ICsrKysrKysrKysrKysKPiAgdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxs
cy9sYW5kbG9jay9sYW5kbG9ja19leGVjLmMgfCAgIDkgKwo+ICAuLi4va2VybmVsL3N5c2NhbGxz
L2xhbmRsb2NrL2xhbmRsb2NrX3Rlc3Rlci5oICAgICB8IDM1MAo+ICsrKysrKysrKysrKysrKysr
KysrKwo+ICA1IGZpbGVzIGNoYW5nZWQsIDU3NiBpbnNlcnRpb25zKCspCj4KPiBkaWZmIC0tZ2l0
IGEvcnVudGVzdC9zeXNjYWxscyBiL3J1bnRlc3Qvc3lzY2FsbHMKPiBpbmRleCBmMmI2NGMwZGYu
LjNjN2NkNjZlMiAxMDA2NDQKPiAtLS0gYS9ydW50ZXN0L3N5c2NhbGxzCj4gKysrIGIvcnVudGVz
dC9zeXNjYWxscwo+IEBAIC02ODgsNiArNjg4LDcgQEAga2lsbDEzIGtpbGwxMwo+ICBsYW5kbG9j
azAxIGxhbmRsb2NrMDEKPiAgbGFuZGxvY2swMiBsYW5kbG9jazAyCj4gIGxhbmRsb2NrMDMgbGFu
ZGxvY2swMwo+ICtsYW5kbG9jazA0IGxhbmRsb2NrMDQKPgo+ICBsY2hvd24wMSBsY2hvd24wMQo+
ICBsY2hvd24wMV8xNiBsY2hvd24wMV8xNgo+IGRpZmYgLS1naXQgYS90ZXN0Y2FzZXMva2VybmVs
L3N5c2NhbGxzL2xhbmRsb2NrLy5naXRpZ25vcmUKPiBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2Fs
bHMvbGFuZGxvY2svLmdpdGlnbm9yZQo+IGluZGV4IGY3OWNkMDkwYi4uNGZlOGQ3Y2JhIDEwMDY0
NAo+IC0tLSBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxvY2svLmdpdGlnbm9yZQo+
ICsrKyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxvY2svLmdpdGlnbm9yZQo+IEBA
IC0xLDMgKzEsNSBAQAo+ICtsYW5kbG9ja19leGVjCj4gIGxhbmRsb2NrMDEKPiAgbGFuZGxvY2sw
Mgo+ICBsYW5kbG9jazAzCj4gK2xhbmRsb2NrMDQKPiBkaWZmIC0tZ2l0IGEvdGVzdGNhc2VzL2tl
cm5lbC9zeXNjYWxscy9sYW5kbG9jay9sYW5kbG9jazA0LmMKPiBiL3Rlc3RjYXNlcy9rZXJuZWwv
c3lzY2FsbHMvbGFuZGxvY2svbGFuZGxvY2swNC5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2NDQKPiBp
bmRleCAwMDAwMDAwMDAuLjMwZmQ5NDAwZgo+IC0tLSAvZGV2L251bGwKPiArKysgYi90ZXN0Y2Fz
ZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2NrMDQuYwo+IEBAIC0wLDAgKzEsMjE0
IEBACj4gKy8vIFNQRFgtTGljZW5zZS1JZGVudGlmaWVyOiBHUEwtMi4wLW9yLWxhdGVyCj4gKy8q
Cj4gKyAqIENvcHlyaWdodCAoQykgMjAyNCBTVVNFIExMQyBBbmRyZWEgQ2VydmVzYXRvIDwKPiBh
bmRyZWEuY2VydmVzYXRvQHN1c2UuY29tPgo+ICsgKi8KPiArCj4gKy8qXAo+ICsgKiBbRGVzY3Jp
cHRpb25dCj4gKyAqCj4gKyAqIFRoaXMgdGVzdCB2ZXJpZmllcyB0aGF0IGFsbCBsYW5kbG9jayBy
dWxlcyBhcmUgd29ya2luZyBwcm9wZXJseS4gVGhlCj4gd2F5IHdlCj4gKyAqIGRvIGl0IGlzIHRv
IHZlcmlmeSB0aGF0IGFsbCBkaXNhYmxlZCBzeXNjYWxscyBhcmUgbm90IHdvcmtpbmcgYnV0IHRo
ZQo+IG9uZSB3ZQo+ICsgKiBlbmFibGVkIHZpYSBzcGVjaWZjIGxhbmRsb2NrIHJ1bGVzLgo+ICsg
Ki8KPiArCj4gKyNpbmNsdWRlICJsYW5kbG9ja19jb21tb24uaCIKPiArI2luY2x1ZGUgImxhbmRs
b2NrX3Rlc3Rlci5oIgo+ICsjaW5jbHVkZSAidHN0X3NhZmVfc3RkaW8uaCIKPiArCj4gKyNkZWZp
bmUgQUNDRVNTX05BTUUoeCkgI3gKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgbGFuZGxvY2tfcnVsZXNl
dF9hdHRyICpydWxlc2V0X2F0dHI7Cj4gK3N0YXRpYyBzdHJ1Y3QgbGFuZGxvY2tfcGF0aF9iZW5l
YXRoX2F0dHIgKnBhdGhfYmVuZWF0aF9hdHRyOwo+ICsKPiArc3RhdGljIHN0cnVjdCB0dmFyaWFu
dCB7Cj4gKyAgICAgICBpbnQgYWNjZXNzOwo+ICsgICAgICAgY2hhciAqZGVzYzsKPiArfSB0dmFy
aWFudHNbXSA9IHsKPiArICAgICAgIHsKPiArICAgICAgICAgICAgICAgTEFORExPQ0tfQUNDRVNT
X0ZTX1JFQURfRklMRSB8IExBTkRMT0NLX0FDQ0VTU19GU19FWEVDVVRFLAo+ICsgICAgICAgICAg
ICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19BQ0NFU1NfRlNfRVhFQ1VURSkKPiArICAgICAgIH0s
Cj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19XUklURV9G
SUxFLAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19BQ0NFU1NfRlNfV1JJ
VEVfRklMRSkKPiArICAgICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRM
T0NLX0FDQ0VTU19GU19SRUFEX0ZJTEUsCj4gKyAgICAgICAgICAgICAgIEFDQ0VTU19OQU1FKExB
TkRMT0NLX0FDQ0VTU19GU19SRUFEX0ZJTEUpCj4gKyAgICAgICB9LAo+ICsgICAgICAgewo+ICsg
ICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfUkVBRF9ESVIsCj4gKyAgICAgICAgICAg
ICAgIEFDQ0VTU19OQU1FKExBTkRMT0NLX0FDQ0VTU19GU19SRUFEX0RJUikKPiArICAgICAgIH0s
Cj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19SRU1PVkVf
RElSLAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19BQ0NFU1NfRlNfUkVN
T1ZFX0RJUikKPiArICAgICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRM
T0NLX0FDQ0VTU19GU19SRU1PVkVfRklMRSwKPiArICAgICAgICAgICAgICAgQUNDRVNTX05BTUUo
TEFORExPQ0tfQUNDRVNTX0ZTX1JFTU9WRV9GSUxFKQo+ICsgICAgICAgfSwKPiArICAgICAgIHsK
PiArICAgICAgICAgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfQ0hBUiwKPiArICAgICAg
ICAgICAgICAgQUNDRVNTX05BTUUoTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfQ0hBUikKPiArICAg
ICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19N
QUtFX0JMT0NLLAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19BQ0NFU1Nf
RlNfTUFLRV9CTE9DSykKPiArICAgICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAg
IExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX1JFRywKPiArICAgICAgICAgICAgICAgQUNDRVNTX05B
TUUoTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfUkVHKQo+ICsgICAgICAgfSwKPiArICAgICAgIHsK
PiArICAgICAgICAgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfU09DSywKPiArICAgICAg
ICAgICAgICAgQUNDRVNTX05BTUUoTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfU09DSykKPiArICAg
ICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19N
QUtFX0ZJRk8sCj4gKyAgICAgICAgICAgICAgIEFDQ0VTU19OQU1FKExBTkRMT0NLX0FDQ0VTU19G
U19NQUtFX0ZJRk8pCj4gKyAgICAgICB9LAo+ICsgICAgICAgewo+ICsgICAgICAgICAgICAgICBM
QU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9TWU0sCj4gKyAgICAgICAgICAgICAgIEFDQ0VTU19OQU1F
KExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX1NZTSkKPiArICAgICAgIH0sCj4gKyAgICAgICB7Cj4g
KyAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19XUklURV9GSUxFIHwKPiBMQU5ETE9D
S19BQ0NFU1NfRlNfVFJVTkNBVEUsCj4gKyAgICAgICAgICAgICAgIEFDQ0VTU19OQU1FKExBTkRM
T0NLX0FDQ0VTU19GU19UUlVOQ0FURSkKPiArICAgICAgIH0sCj4gK307Cj4gKwo+ICtzdGF0aWMg
dm9pZCBydW4odm9pZCkKPiArewo+ICsgICAgICAgaWYgKCFTQUZFX0ZPUksoKSkgewo+ICsgICAg
ICAgICAgICAgICBzdHJ1Y3QgdHZhcmlhbnQgIHZhcmlhbnQgPSB0dmFyaWFudHNbdHN0X3Zhcmlh
bnRdOwo+ICsKPiArICAgICAgICAgICAgICAgdGVzdGVyX3J1bl9hbGxfcnVsZXModmFyaWFudC5h
Y2Nlc3MpOwo+ICsgICAgICAgICAgICAgICBfZXhpdCgwKTsKPiArICAgICAgIH0KPiArfQo+ICsK
PiArc3RhdGljIHZvaWQgZW5hYmxlX2V4ZWNfbGlicyhjb25zdCBpbnQgcnVsZXNldF9mZCkKPiAr
ewo+ICsgICAgICAgRklMRSAqZnA7Cj4gKyAgICAgICBjaGFyIGxpbmVbMTAyNF07Cj4gKyAgICAg
ICBjaGFyIHBhdGhbUEFUSF9NQVhdOwo+ICsgICAgICAgY2hhciBkZXBlbmRlbmN5WzhdW1BBVEhf
TUFYXTsKPiArICAgICAgIGludCBjb3VudCA9IDA7Cj4gKyAgICAgICBpbnQgZHVwbGljYXRlID0g
MDsKPiArCj4gKyAgICAgICBmcCA9IFNBRkVfRk9QRU4oIi9wcm9jL3NlbGYvbWFwcyIsICJyIik7
Cj4gKwo+ICsgICAgICAgd2hpbGUgKGZnZXRzKGxpbmUsIHNpemVvZihsaW5lKSwgZnApKSB7Cj4g
KyAgICAgICAgICAgICAgIGlmIChzdHJzdHIobGluZSwgIi5zbyIpID09IE5VTEwpCj4gKyAgICAg
ICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gKwo+ICsgICAgICAgICAgICAgICBTQUZFX1NT
Q0FORihsaW5lLCAiJSp4LSUqeCAlKnMgJSp4ICUqcyAlKmQgJXMiLCBwYXRoKTsKPiArCj4gKyAg
ICAgICAgICAgICAgIGZvciAoaW50IGkgPSAwOyBpIDwgY291bnQ7IGkrKykgewo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIGlmIChzdHJjbXAocGF0aCwgZGVwZW5kZW5jeVtpXSkgPT0gMCkgewo+
ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZHVwbGljYXRlID0gMTsKPiArICAgICAg
ICAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrOwo+ICsgICAgICAgICAgICAgICAgICAgICAg
IH0KPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgaWYgKGR1cGxpY2F0
ZSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIGR1cGxpY2F0ZSA9IDA7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAgY29udGludWU7Cj4gKyAgICAgICAgICAgICAgIH0KPiArCj4gKyAgICAg
ICAgICAgICAgIHN0cm5jcHkoZGVwZW5kZW5jeVtjb3VudF0sIHBhdGgsIFBBVEhfTUFYKTsKPiAr
ICAgICAgICAgICAgICAgY291bnQrKzsKPiArCj4gKyAgICAgICAgICAgICAgIHRzdF9yZXMoVElO
Rk8sICJFbmFibGUgcmVhZC9leGVjIHBlcm1pc3Npb25zIGZvciAlcyIsCj4gcGF0aCk7Cj4gKwo+
ICsgICAgICAgICAgICAgICBwYXRoX2JlbmVhdGhfYXR0ci0+YWxsb3dlZF9hY2Nlc3MgPQo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19SRUFEX0ZJTEUgfAo+ICsg
ICAgICAgICAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19FWEVDVVRFOwo+ICsgICAg
ICAgICAgICAgICBwYXRoX2JlbmVhdGhfYXR0ci0+cGFyZW50X2ZkID0gU0FGRV9PUEVOKHBhdGgs
IE9fUEFUSCB8Cj4gT19DTE9FWEVDKTsKPiArCj4gKyAgICAgICAgICAgICAgIFNBRkVfTEFORExP
Q0tfQUREX1JVTEUoCj4gKyAgICAgICAgICAgICAgICAgICAgICAgcnVsZXNldF9mZCwKPiArICAg
ICAgICAgICAgICAgICAgICAgICBMQU5ETE9DS19SVUxFX1BBVEhfQkVORUFUSCwKPiArICAgICAg
ICAgICAgICAgICAgICAgICBwYXRoX2JlbmVhdGhfYXR0ciwKPiArICAgICAgICAgICAgICAgICAg
ICAgICAwKTsKPiArCj4gKyAgICAgICAgICAgICAgIFNBRkVfQ0xPU0UocGF0aF9iZW5lYXRoX2F0
dHItPnBhcmVudF9mZCk7Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgU0FGRV9GQ0xPU0UoZnAp
Owo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBzZXR1cCh2b2lkKQo+ICt7Cj4gKyAgICAgICBzdHJ1
Y3QgdHZhcmlhbnQgdmFyaWFudCA9IHR2YXJpYW50c1t0c3RfdmFyaWFudF07Cj4gKyAgICAgICBp
bnQgcnVsZXNldF9mZDsKPiArCj4gKyAgICAgICB2ZXJpZnlfbGFuZGxvY2tfaXNfZW5hYmxlZCgp
Owo+ICsgICAgICAgdGVzdGVyX2NyZWF0ZV90cmVlKCk7Cj4gKwo+ICsgICAgICAgdHN0X3JlcyhU
SU5GTywgIlRlc3RpbmcgJXMiLCB2YXJpYW50LmRlc2MpOwo+ICsKPiArICAgICAgIHJ1bGVzZXRf
YXR0ci0+aGFuZGxlZF9hY2Nlc3NfZnMgPSB0ZXN0ZXJfZ2V0X2FsbF9ydWxlcygpOwo+ICsKPiAr
ICAgICAgIHJ1bGVzZXRfZmQgPSBTQUZFX0xBTkRMT0NLX0NSRUFURV9SVUxFU0VUKAo+ICsgICAg
ICAgICAgICAgICBydWxlc2V0X2F0dHIsIHNpemVvZihzdHJ1Y3QgbGFuZGxvY2tfcnVsZXNldF9h
dHRyKSwgMCk7Cj4gKwo+ICsgICAgICAgLyogc2luY2Ugb3VyIGJpbmFyeSBpcyBkeW5hbWljYWxs
eSBsaW5rZWQsIHdlIG5lZWQgdG8gZW5hYmxlCj4gZGVwZW5kZW5jZXMKPiArICAgICAgICAqIHRv
IGJlIHJlYWQgYW5kIGV4ZWN1dGVkCj4gKyAgICAgICAgKi8KPiArICAgICAgIGVuYWJsZV9leGVj
X2xpYnMocnVsZXNldF9mZCk7Cj4gKwo+ICsgICAgICAgcGF0aF9iZW5lYXRoX2F0dHItPmFsbG93
ZWRfYWNjZXNzID0gdmFyaWFudC5hY2Nlc3M7Cj4gKyAgICAgICBwYXRoX2JlbmVhdGhfYXR0ci0+
cGFyZW50X2ZkID0gU0FGRV9PUEVOKAo+ICsgICAgICAgICAgICAgICBTQU5EQk9YX0ZPTERFUiwg
T19QQVRIIHwgT19DTE9FWEVDKTsKPiArCj4gKyAgICAgICBTQUZFX0xBTkRMT0NLX0FERF9SVUxF
KAo+ICsgICAgICAgICAgICAgICBydWxlc2V0X2ZkLAo+ICsgICAgICAgICAgICAgICBMQU5ETE9D
S19SVUxFX1BBVEhfQkVORUFUSCwKPiArICAgICAgICAgICAgICAgcGF0aF9iZW5lYXRoX2F0dHIs
Cj4gKyAgICAgICAgICAgICAgIDApOwo+ICsKPiArICAgICAgIFNBRkVfQ0xPU0UocGF0aF9iZW5l
YXRoX2F0dHItPnBhcmVudF9mZCk7Cj4gKwo+ICsgICAgICAgZW5mb3JjZV9ydWxlc2V0KHJ1bGVz
ZXRfZmQpOwo+ICsgICAgICAgU0FGRV9DTE9TRShydWxlc2V0X2ZkKTsKPiArfQo+ICsKPiArc3Rh
dGljIHN0cnVjdCB0c3RfdGVzdCB0ZXN0ID0gewo+ICsgICAgICAgLnRlc3RfYWxsID0gcnVuLAo+
ICsgICAgICAgLnNldHVwID0gc2V0dXAsCj4gKyAgICAgICAubWluX2t2ZXIgPSAiNS4xMyIsCj4g
KyAgICAgICAuZm9ya3NfY2hpbGQgPSAxLAo+ICsgICAgICAgLm5lZWRzX3RtcGRpciA9IDEsCj4g
KyAgICAgICAubmVlZHNfcm9vdCA9IDEsCj4gKyAgICAgICAudGVzdF92YXJpYW50cyA9IEFSUkFZ
X1NJWkUodHZhcmlhbnRzKSwKPiArICAgICAgIC5yZXNvdXJjZV9maWxlcyA9IChjb25zdCBjaGFy
ICpbXSkgewo+ICsgICAgICAgICAgICAgICBURVNUQVBQLAo+ICsgICAgICAgICAgICAgICBOVUxM
LAo+ICsgICAgICAgfSwKPiArICAgICAgIC5uZWVkc19rY29uZmlncyA9IChjb25zdCBjaGFyICpb
XSkgewo+ICsgICAgICAgICAgICAgICAiQ09ORklHX1NFQ1VSSVRZX0xBTkRMT0NLPXkiLAo+ICsg
ICAgICAgICAgICAgICBOVUxMCj4gKyAgICAgICB9LAo+ICsgICAgICAgLmJ1ZnMgPSAoc3RydWN0
IHRzdF9idWZmZXJzIFtdKSB7Cj4gKyAgICAgICAgICAgICAgIHsmcnVsZXNldF9hdHRyLCAuc2l6
ZSA9IHNpemVvZihzdHJ1Y3QKPiBsYW5kbG9ja19ydWxlc2V0X2F0dHIpfSwKPiArICAgICAgICAg
ICAgICAgeyZwYXRoX2JlbmVhdGhfYXR0ciwgLnNpemUgPSBzaXplb2Yoc3RydWN0Cj4gbGFuZGxv
Y2tfcGF0aF9iZW5lYXRoX2F0dHIpfSwKPiArICAgICAgICAgICAgICAge30sCj4gKyAgICAgICB9
LAo+ICsgICAgICAgLmNhcHMgPSAoc3RydWN0IHRzdF9jYXAgW10pIHsKPiArICAgICAgICAgICAg
ICAgVFNUX0NBUChUU1RfQ0FQX1JFUSwgQ0FQX1NZU19BRE1JTiksCj4gKyAgICAgICAgICAgICAg
IFRTVF9DQVAoVFNUX0NBUF9SRVEsIENBUF9NS05PRCksCj4gKyAgICAgICAgICAgICAgIHt9Cj4g
KyAgICAgICB9LAo+ICsgICAgICAgLmZvcm1hdF9kZXZpY2UgPSAxLAo+ICsgICAgICAgLm1vdW50
X2RldmljZSA9IDEsCj4gKyAgICAgICAubW50cG9pbnQgPSBTQU5EQk9YX0ZPTERFUiwKPiArICAg
ICAgIC5hbGxfZmlsZXN5c3RlbXMgPSAxLAo+ICsgICAgICAgLnNraXBfZmlsZXN5c3RlbXMgPSAo
Y29uc3QgY2hhciAqW10pIHsKPiArICAgICAgICAgICAgICAgInZmYXQiLAo+ICsgICAgICAgICAg
ICAgICAiZXhmYXQiLAo+ICsgICAgICAgICAgICAgICBOVUxMCj4gKyAgICAgICB9LAo+ICsgICAg
ICAgLm1heF9ydW50aW1lID0gMzYwMCwKPiArfTsKPiBkaWZmIC0tZ2l0IGEvdGVzdGNhc2VzL2tl
cm5lbC9zeXNjYWxscy9sYW5kbG9jay9sYW5kbG9ja19leGVjLmMKPiBiL3Rlc3RjYXNlcy9rZXJu
ZWwvc3lzY2FsbHMvbGFuZGxvY2svbGFuZGxvY2tfZXhlYy5jCj4gbmV3IGZpbGUgbW9kZSAxMDA2
NDQKPiBpbmRleCAwMDAwMDAwMDAuLmFhZTVjNzZiMgo+IC0tLSAvZGV2L251bGwKPiArKysgYi90
ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2NrX2V4ZWMuYwo+IEBAIC0w
LDAgKzEsOSBAQAo+ICsvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRl
cgo+ICsvKgo+ICsgKiBDb3B5cmlnaHQgKEMpIDIwMjQgU1VTRSBMTEMgQW5kcmVhIENlcnZlc2F0
byA8Cj4gYW5kcmVhLmNlcnZlc2F0b0BzdXNlLmNvbT4KPiArICovCj4gKwo+ICtpbnQgbWFpbih2
b2lkKQo+ICt7Cj4gKyAgICAgICByZXR1cm4gMDsKPiArfQo+IGRpZmYgLS1naXQgYS90ZXN0Y2Fz
ZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2NrX3Rlc3Rlci5oCj4gYi90ZXN0Y2Fz
ZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2NrX3Rlc3Rlci5oCj4gbmV3IGZpbGUg
bW9kZSAxMDA2NDQKPiBpbmRleCAwMDAwMDAwMDAuLjg5Y2EwODVkNwo+IC0tLSAvZGV2L251bGwK
PiArKysgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2NrX3Rlc3Rl
ci5oCj4gQEAgLTAsMCArMSwzNTAgQEAKPiArLyogU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAtb3ItbGF0ZXIgKi8KPiArLyoKPiArICogQ29weXJpZ2h0IChDKSAyMDI0IFNVU0UgTExD
IEFuZHJlYSBDZXJ2ZXNhdG8gPAo+IGFuZHJlYS5jZXJ2ZXNhdG9Ac3VzZS5jb20+Cj4gKyAqLwo+
ICsKPiArI2lmbmRlZiBMQU5ETE9DS19URVNURVJfSAo+ICsKPiArI2luY2x1ZGUgInRzdF90ZXN0
LmgiCj4gKyNpbmNsdWRlICJsYXBpL2xhbmRsb2NrLmgiCj4gKyNpbmNsdWRlIDxzeXMvc3lzbWFj
cm9zLmg+Cj4gKwo+ICsjZGVmaW5lIFBFUk1fTU9ERSAwNzAwCj4gKwo+ICsjZGVmaW5lIFNBTkRC
T1hfRk9MREVSICJzYW5kYm94Igo+ICsjZGVmaW5lIFRFU1RBUFAgICAgICAgICAgICAgICAgICAg
ICAgICAibGFuZGxvY2tfZXhlYyIKPiArCj4gKyNkZWZpbmUgRklMRV9FWEVDICAgICAgICAgICAg
ICBTQU5EQk9YX0ZPTERFUiIvIlRFU1RBUFAKPiArI2RlZmluZSBGSUxFX1JFQUQgICAgICAgICAg
ICAgIFNBTkRCT1hfRk9MREVSIi9maWxlX3JlYWQiCj4gKyNkZWZpbmUgRklMRV9XUklURSAgICAg
ICAgICAgICBTQU5EQk9YX0ZPTERFUiIvZmlsZV93cml0ZSIKPiArI2RlZmluZSBGSUxFX1JFTU9W
RSAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi9maWxlX3JlbW92ZSIKPiArI2RlZmluZSBGSUxF
X1VOTElOSyAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi9maWxlX3VubGluayIKPiArI2RlZmlu
ZSBGSUxFX1VOTElOS0FUICBTQU5EQk9YX0ZPTERFUiIvZmlsZV91bmxpbmthdCIKPiArI2RlZmlu
ZSBGSUxFX1RSVU5DQVRFICBTQU5EQk9YX0ZPTERFUiIvZmlsZV90cnVuY2F0ZSIKPiArI2RlZmlu
ZSBGSUxFX1JFR1VMQVIgICBTQU5EQk9YX0ZPTERFUiIvcmVndWxhcjAiCj4gKyNkZWZpbmUgRklM
RV9TT0NLRVQgICAgICAgICAgICBTQU5EQk9YX0ZPTERFUiIvc29ja2V0MCIKPiArI2RlZmluZSBG
SUxFX0ZJRk8gICAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi9maWZvMCIKPiArI2RlZmluZSBG
SUxFX1NZTTAgICAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi9zeW1ib2xpYzAiCj4gKyNkZWZp
bmUgRklMRV9TWU0xICAgICAgICAgICAgICBTQU5EQk9YX0ZPTERFUiIvc3ltYm9saWMxIgo+ICsj
ZGVmaW5lIERJUl9SRUFERElSICAgICAgICAgICAgU0FOREJPWF9GT0xERVIiL2Rpcl9yZWFkZGly
Igo+ICsjZGVmaW5lIERJUl9STURJUiAgICAgICAgICAgICAgU0FOREJPWF9GT0xERVIiL2Rpcl9y
bWRpciIKPiArI2RlZmluZSBERVZfQ0hBUjAgICAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi9j
aGFyZGV2MCIKPiArI2RlZmluZSBERVZfQkxLMCAgICAgICAgICAgICAgIFNBTkRCT1hfRk9MREVS
Ii9ibGtkZXYwIgo+ICsKPiArI2RlZmluZSBBTExfUlVMRVMgKFwKPiArICAgICAgIExBTkRMT0NL
X0FDQ0VTU19GU19FWEVDVVRFIHwgXAo+ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX1dSSVRF
X0ZJTEUgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfUkVBRF9GSUxFIHwgXAo+ICsg
ICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX1JFQURfRElSIHwgXAo+ICsgICAgICAgTEFORExPQ0tf
QUNDRVNTX0ZTX1JFTU9WRV9ESVIgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfUkVN
T1ZFX0ZJTEUgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9DSEFSIHwgXAo+
ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfRElSIHwgXAo+ICsgICAgICAgTEFORExP
Q0tfQUNDRVNTX0ZTX01BS0VfUkVHIHwgXAo+ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX01B
S0VfU09DSyB8IFwKPiArICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX0ZJRk8gfCBcCj4g
KyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9CTE9DSyB8IFwKPiArICAgICAgIExBTkRM
T0NLX0FDQ0VTU19GU19NQUtFX1NZTSB8IFwKPiArICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19S
RUZFUiB8IFwKPiArICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19UUlVOQ0FURSB8IFwKPiArICAg
ICAgIExBTkRMT0NLX0FDQ0VTU19ORVRfQklORF9UQ1AgfCBcCj4gKyAgICAgICBMQU5ETE9DS19B
Q0NFU1NfTkVUX0NPTk5FQ1RfVENQIHwgXAo+ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX0lP
Q1RMX0RFVikKPiArCj4gK3N0YXRpYyBjaGFyICpyZWFkZGlyX2ZpbGVzW10gPSB7Cj4gKyAgICAg
ICBESVJfUkVBRERJUiIvZmlsZTAiLAo+ICsgICAgICAgRElSX1JFQURESVIiL2ZpbGUxIiwKPiAr
ICAgICAgIERJUl9SRUFERElSIi9maWxlMiIsCj4gK307Cj4gKwo+ICtzdGF0aWMgaW50IGRldl9j
aHI7Cj4gK3N0YXRpYyBpbnQgZGV2X2JsazsKPiArCj4gK3N0YXRpYyBpbnQgdGVzdGVyX2dldF9h
bGxfcnVsZXModm9pZCkKPiArewo+ICsgICAgICAgaW50IGFiaTsKPiArICAgICAgIGludCBhbGxf
cnVsZXMgPSBBTExfUlVMRVM7Cj4gKwo+ICsgICAgICAgYWJpID0gU0FGRV9MQU5ETE9DS19DUkVB
VEVfUlVMRVNFVCgKPiArICAgICAgICAgICAgICAgTlVMTCwgMCwgTEFORExPQ0tfQ1JFQVRFX1JV
TEVTRVRfVkVSU0lPTik7Cj4gKwo+ICsgICAgICAgaWYgKGFiaSA8IDIpCj4gKyAgICAgICAgICAg
ICAgIGFsbF9ydWxlcyAmPSB+TEFORExPQ0tfQUNDRVNTX0ZTX1JFRkVSOwo+ICsKPiArICAgICAg
IGlmIChhYmkgPCAzKQo+ICsgICAgICAgICAgICAgICBhbGxfcnVsZXMgJj0gfkxBTkRMT0NLX0FD
Q0VTU19GU19UUlVOQ0FURTsKPiArCj4gKyAgICAgICBpZiAoYWJpIDwgNCkgewo+ICsgICAgICAg
ICAgICAgICBhbGxfcnVsZXMgJj0gfihMQU5ETE9DS19BQ0NFU1NfTkVUX0JJTkRfVENQIHwKPiAr
ICAgICAgICAgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NFU1NfTkVUX0NPTk5FQ1RfVENQKTsK
PiArICAgICAgIH0KPiArCj4gKyAgICAgICBpZiAoYWJpIDwgNSkKPiArICAgICAgICAgICAgICAg
YWxsX3J1bGVzICY9IH5MQU5ETE9DS19BQ0NFU1NfRlNfSU9DVExfREVWOwo+ICsKPiArICAgICAg
IHJldHVybiBhbGxfcnVsZXM7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIHRlc3Rlcl9jcmVhdGVf
dHJlZSh2b2lkKQo+ICt7Cj4gKyAgICAgICBpZiAoYWNjZXNzKFNBTkRCT1hfRk9MREVSLCBGX09L
KSA9PSAtMSkKPiArICAgICAgICAgICAgICAgU0FGRV9NS0RJUihTQU5EQk9YX0ZPTERFUiwgUEVS
TV9NT0RFKTsKPiArCj4gKyAgICAgICAvKiBmb2xkZXJzICovCj4gKyAgICAgICBTQUZFX01LRElS
KERJUl9STURJUiwgUEVSTV9NT0RFKTsKPiArICAgICAgIFNBRkVfTUtESVIoRElSX1JFQURESVIs
IFBFUk1fTU9ERSk7Cj4gKyAgICAgICBmb3IgKHNpemVfdCBpID0gMDsgaSA8IEFSUkFZX1NJWkUo
cmVhZGRpcl9maWxlcyk7IGkrKykKPiArICAgICAgICAgICAgICAgU0FGRV9UT1VDSChyZWFkZGly
X2ZpbGVzW2ldLCBQRVJNX01PREUsIE5VTEwpOwo+ICsKPiArICAgICAgIC8qIGZpbGVzICovCj4g
KyAgICAgICB0c3RfZmlsbF9maWxlKEZJTEVfUkVBRCwgJ2EnLCBnZXRwYWdlc2l6ZSgpLCAxKTsK
PiArICAgICAgIFNBRkVfVE9VQ0goRklMRV9XUklURSwgUEVSTV9NT0RFLCBOVUxMKTsKPiArICAg
ICAgIFNBRkVfVE9VQ0goRklMRV9SRU1PVkUsIFBFUk1fTU9ERSwgTlVMTCk7Cj4gKyAgICAgICBT
QUZFX1RPVUNIKEZJTEVfVU5MSU5LLCBQRVJNX01PREUsIE5VTEwpOwo+ICsgICAgICAgU0FGRV9U
T1VDSChGSUxFX1VOTElOS0FULCBQRVJNX01PREUsIE5VTEwpOwo+ICsgICAgICAgU0FGRV9UT1VD
SChGSUxFX1RSVU5DQVRFLCBQRVJNX01PREUsIE5VTEwpOwo+ICsgICAgICAgU0FGRV9UT1VDSChG
SUxFX1NZTTAsIFBFUk1fTU9ERSwgTlVMTCk7Cj4gKyAgICAgICBTQUZFX0NQKFRFU1RBUFAsIEZJ
TEVfRVhFQyk7Cj4gKwo+ICsgICAgICAgLyogZGV2aWNlcyAqLwo+ICsgICAgICAgZGV2X2NociA9
IG1ha2VkZXYoMSwgMyk7Cj4gKyAgICAgICBkZXZfYmxrID0gbWFrZWRldig3LCAwKTsKPiArfQo+
ICsKPiArc3RhdGljIHZvaWQgX3Rlc3RfZXhlYyhjb25zdCBpbnQgcmVzdWx0KQo+ICt7Cj4gKyAg
ICAgICBpbnQgc3RhdHVzOwo+ICsgICAgICAgcGlkX3QgcGlkOwo+ICsgICAgICAgY2hhciAqY29u
c3QgYXJnc1tdID0geyhjaGFyICopRklMRV9FWEVDLCBOVUxMfTsKPiArCj4gKyAgICAgICB0c3Rf
cmVzKFRJTkZPLCAiVGVzdCBiaW5hcnkgZXhlY3V0aW9uIik7Cj4gKwo+ICsgICAgICAgcGlkID0g
U0FGRV9GT1JLKCk7Cj4gKyAgICAgICBpZiAoIXBpZCkgewo+ICsgICAgICAgICAgICAgICBpbnQg
cnZhbDsKPiArCj4gKyAgICAgICAgICAgICAgIGlmIChyZXN1bHQgPT0gVFBBU1MpIHsKPiArICAg
ICAgICAgICAgICAgICAgICAgICBydmFsID0gZXhlY3ZlKEZJTEVfRVhFQywgYXJncywgTlVMTCk7
Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgaWYgKHJ2YWwgPT0gLTEpCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB0c3RfcmVzKFRGQUlMIHwgVEVSUk5PLCAiRmFpbGVkIHRvIGV4
ZWN1dGUKPiB0ZXN0IGJpbmFyeSIpOwo+ICsgICAgICAgICAgICAgICB9IGVsc2Ugewo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIFRTVF9FWFBfRkFJTChleGVjdmUoRklMRV9FWEVDLCBhcmdzLCBO
VUxMKSwKPiBFQUNDRVMpOwo+ICsgICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAgICAgICAgICAg
ICBfZXhpdCgxKTsKPiArICAgICAgIH0KPiArCj4gKyAgICAgICBTQUZFX1dBSVRQSUQocGlkLCAm
c3RhdHVzLCAwKTsKPiArICAgICAgIGlmICghV0lGRVhJVEVEKHN0YXR1cykgfHwgV0VYSVRTVEFU
VVMoc3RhdHVzKSAhPSAwKQo+ICsgICAgICAgICAgICAgICByZXR1cm47Cj4gKwo+ICsgICAgICAg
dHN0X3JlcyhyZXN1bHQsICJUZXN0IGJpbmFyeSBoYXMgYmVlbiBleGVjdXRlZCIpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBfdGVzdF93cml0ZShjb25zdCBpbnQgcmVzdWx0KQo+ICt7Cj4gKyAg
ICAgICB0c3RfcmVzKFRJTkZPLCAiVGVzdCB3cml0aW5nIGZpbGUiKTsKPiArCj4gKyAgICAgICBp
ZiAocmVzdWx0ID09IFRQQVNTKQo+ICsgICAgICAgICAgICAgICBUU1RfRVhQX0ZEKG9wZW4oRklM
RV9XUklURSwgT19XUk9OTFksIFBFUk1fTU9ERSkpOwo+ICsgICAgICAgZWxzZQo+ICsgICAgICAg
ICAgICAgICBUU1RfRVhQX0ZBSUwob3BlbihGSUxFX1dSSVRFLCBPX1dST05MWSwgUEVSTV9NT0RF
KSwKPiBFQUNDRVMpOwo+ICsKPiArICAgICAgIGlmIChUU1RfUkVUICE9IC0xKQo+ICsgICAgICAg
ICAgICAgICBTQUZFX0NMT1NFKFRTVF9SRVQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfdGVz
dF9yZWFkKGNvbnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAgIHRzdF9yZXMoVElORk8sICJU
ZXN0IHJlYWRpbmcgZmlsZSIpOwo+ICsKPiArICAgICAgIGlmIChyZXN1bHQgPT0gVFBBU1MpCj4g
KyAgICAgICAgICAgICAgIFRTVF9FWFBfRkQob3BlbihGSUxFX1JFQUQsIE9fUkRPTkxZLCBQRVJN
X01PREUpKTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9GQUlMKG9w
ZW4oRklMRV9SRUFELCBPX1JET05MWSwgUEVSTV9NT0RFKSwgRUFDQ0VTKTsKPiArCj4gKyAgICAg
ICBpZiAoVFNUX1JFVCAhPSAtMSkKPiArICAgICAgICAgICAgICAgU0FGRV9DTE9TRShUU1RfUkVU
KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX3Rlc3RfcmVhZGRpcihjb25zdCBpbnQgcmVzdWx0
KQo+ICt7Cj4gKyAgICAgICB0c3RfcmVzKFRJTkZPLCAiVGVzdCByZWFkaW5nIGRpcmVjdG9yeSIp
Owo+ICsKPiArICAgICAgIERJUiAqZGlyOwo+ICsgICAgICAgc3RydWN0IGRpcmVudCAqZGU7Cj4g
KyAgICAgICBpbnQgZmlsZXNfY291bnRlZCA9IDA7Cj4gKwo+ICsgICAgICAgZGlyID0gb3BlbmRp
cihESVJfUkVBRERJUik7Cj4gKyAgICAgICBpZiAoIWRpcikgewo+ICsgICAgICAgICAgICAgICB0
c3RfcmVzKHJlc3VsdCA9PSBUUEFTUyA/IFRGQUlMIDogVFBBU1MsCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgIkNhbid0IHJlYWQgJyVzJyBkaXJlY3RvcnkiLCBESVJfUkVBRERJUik7Cj4gKwo+
ICsgICAgICAgICAgICAgICByZXR1cm47Cj4gKyAgICAgICB9Cj4gKwo+ICsgICAgICAgdHN0X3Jl
cyhyZXN1bHQsICJDYW4gcmVhZCAnJXMnIGRpcmVjdG9yeSIsIERJUl9SRUFERElSKTsKPiArICAg
ICAgIGlmIChyZXN1bHQgPT0gVEZBSUwpCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArCj4g
KyAgICAgICB3aGlsZSAoKGRlID0gcmVhZGRpcihkaXIpKSAhPSBOVUxMKSB7Cj4gKyAgICAgICAg
ICAgICAgIGlmIChkZS0+ZF90eXBlICE9IERUX1JFRykKPiArICAgICAgICAgICAgICAgICAgICAg
ICBjb250aW51ZTsKPiArCj4gKyAgICAgICAgICAgICAgIGZvciAoc2l6ZV90IGkgPSAwOyBpIDwg
QVJSQVlfU0laRShyZWFkZGlyX2ZpbGVzKTsgaSsrKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgaWYgKHJlYWRkaXJfZmlsZXNbaV0gPT0gTlVMTCkKPiArICAgICAgICAgICAgICAgICAgICAg
ICAgICAgICAgIGNvbnRpbnVlOwo+ICsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAoc3Ry
c3RyKHJlYWRkaXJfZmlsZXNbaV0sIGRlLT5kX25hbWUpICE9IE5VTEwpCj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICBmaWxlc19jb3VudGVkKys7Cj4gKyAgICAgICAgICAgICAgIH0K
PiArICAgICAgIH0KPiArCj4gKyAgICAgICBTQUZFX0NMT1NFRElSKGRpcik7Cj4gKwo+ICsgICAg
ICAgVFNUX0VYUF9FUV9MSShmaWxlc19jb3VudGVkLCBBUlJBWV9TSVpFKHJlYWRkaXJfZmlsZXMp
KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX3Rlc3Rfcm1kaXIoY29uc3QgaW50IHJlc3VsdCkK
PiArewo+ICsgICAgICAgdHN0X3JlcyhUSU5GTywgIlRlc3QgcmVtb3ZpbmcgZGlyZWN0b3J5Iik7
Cj4gKwo+ICsgICAgICAgaWYgKHJlc3VsdCA9PSBUUEFTUykKPiArICAgICAgICAgICAgICAgVFNU
X0VYUF9QQVNTKHJtZGlyKERJUl9STURJUikpOwo+ICsgICAgICAgZWxzZQo+ICsgICAgICAgICAg
ICAgICBUU1RfRVhQX0ZBSUwocm1kaXIoRElSX1JNRElSKSwgRUFDQ0VTKTsKPiArfQo+ICsKPiAr
c3RhdGljIHZvaWQgX3Rlc3Rfcm1maWxlKGNvbnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAg
IHRzdF9yZXMoVElORk8sICJUZXN0IHJlbW92aW5nIGZpbGUiKTsKPiArCj4gKyAgICAgICBpZiAo
cmVzdWx0ID09IFRQQVNTKSB7Cj4gKyAgICAgICAgICAgICAgIFRTVF9FWFBfUEFTUyh1bmxpbmso
RklMRV9VTkxJTkspKTsKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9QQVNTKHJlbW92ZShGSUxF
X1JFTU9WRSkpOwo+ICsgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9G
QUlMKHVubGluayhGSUxFX1VOTElOSyksIEVBQ0NFUyk7Cj4gKyAgICAgICAgICAgICAgIFRTVF9F
WFBfRkFJTChyZW1vdmUoRklMRV9SRU1PVkUpLCBFQUNDRVMpOwo+ICsgICAgICAgfQo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBfdGVzdF9tYWtlKAo+ICsgICAgICAgY29uc3QgY2hhciAqcGF0aCwK
PiArICAgICAgIGNvbnN0IGludCB0eXBlLAo+ICsgICAgICAgY29uc3QgaW50IGRldiwKPiArICAg
ICAgIGNvbnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAgIHRzdF9yZXMoVElORk8sICJUZXN0
IG5vcm1hbCBvciBzcGVjaWFsIGZpbGVzIGNyZWF0aW9uIik7Cj4gKwo+ICsgICAgICAgaWYgKHJl
c3VsdCA9PSBUUEFTUykKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9QQVNTKG1rbm9kKHBhdGgs
IHR5cGUgfCAwNDAwLCBkZXYpKTsKPiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgVFNU
X0VYUF9GQUlMKG1rbm9kKHBhdGgsIHR5cGUgfCAwNDAwLCBkZXYpLCBFQUNDRVMpOwo+ICt9Cj4g
Kwo+ICtzdGF0aWMgdm9pZCBfdGVzdF9zeW1ib2xpYyhjb25zdCBpbnQgcmVzdWx0KQo+ICt7Cj4g
KyAgICAgICB0c3RfcmVzKFRJTkZPLCAiVGVzdCBzeW1ib2xpYyBsaW5rcyIpOwo+ICsKPiArICAg
ICAgIGlmIChyZXN1bHQgPT0gVFBBU1MpCj4gKyAgICAgICAgICAgICAgIFRTVF9FWFBfUEFTUyhz
eW1saW5rKEZJTEVfU1lNMCwgRklMRV9TWU0xKSk7Cj4gKyAgICAgICBlbHNlCj4gKyAgICAgICAg
ICAgICAgIFRTVF9FWFBfRkFJTChzeW1saW5rKEZJTEVfU1lNMCwgRklMRV9TWU0xKSwgRUFDQ0VT
KTsKPiArfQo+ICsKPiArc3RhdGljIHZvaWQgX3Rlc3RfdHJ1bmNhdGUoY29uc3QgaW50IHJlc3Vs
dCkKPiArewo+ICsgICAgICAgaW50IGZkOwo+ICsKPiArICAgICAgIHRzdF9yZXMoVElORk8sICJU
ZXN0IHRydW5jYXRpbmcgZmlsZSIpOwo+ICsKPiArICAgICAgIGlmIChyZXN1bHQgPT0gVFBBU1Mp
IHsKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9QQVNTKHRydW5jYXRlKEZJTEVfVFJVTkNBVEUs
IDEwKSk7Cj4gKwo+ICsgICAgICAgICAgICAgICBmZCA9IFRTVF9FWFBfRkQob3BlbihGSUxFX1RS
VU5DQVRFLCBPX1dST05MWSwgUEVSTV9NT0RFKSk7Cj4gKyAgICAgICAgICAgICAgIGlmIChmZCAh
PSAtMSkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIFRTVF9FWFBfUEFTUyhmdHJ1bmNhdGUo
ZmQsIDEwKSk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgU0FGRV9DTE9TRShmZCk7Cj4gKyAg
ICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIGZkID0gVFNUX0VYUF9GRChvcGVu
KEZJTEVfVFJVTkNBVEUsIE9fV1JPTkxZIHwgT19UUlVOQywKPiBQRVJNX01PREUpKTsKPiArICAg
ICAgICAgICAgICAgaWYgKGZkICE9IC0xKQo+ICsgICAgICAgICAgICAgICAgICAgICAgIFNBRkVf
Q0xPU0UoZmQpOwo+ICsgICAgICAgfSBlbHNlIHsKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9G
QUlMKHRydW5jYXRlKEZJTEVfVFJVTkNBVEUsIDEwKSwgRUFDQ0VTKTsKPiArCj4gKyAgICAgICAg
ICAgICAgIGZkID0gb3BlbihGSUxFX1RSVU5DQVRFLCBPX1dST05MWSwgUEVSTV9NT0RFKTsKPiAr
ICAgICAgICAgICAgICAgaWYgKGZkICE9IC0xKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAg
VFNUX0VYUF9GQUlMKGZ0cnVuY2F0ZShmZCwgMTApLCBFQUNDRVMpOwo+ICsgICAgICAgICAgICAg
ICAgICAgICAgIFNBRkVfQ0xPU0UoZmQpOwo+ICsgICAgICAgICAgICAgICB9Cj4gKwo+ICsgICAg
ICAgICAgICAgICBUU1RfRVhQX0ZBSUwob3BlbihGSUxFX1RSVU5DQVRFLCBPX1dST05MWSB8IE9f
VFJVTkMsCj4gUEVSTV9NT0RFKSwKPiArICAgICAgICAgICAgICAgICAgICAgICBFQUNDRVMpOwo+
ICsKPiArICAgICAgICAgICAgICAgaWYgKFRTVF9SRVQgIT0gLTEpCj4gKyAgICAgICAgICAgICAg
ICAgICAgICAgU0FGRV9DTE9TRShUU1RfUkVUKTsKPiArICAgICAgIH0KPiArfQo+ICsKPiArc3Rh
dGljIHZvaWQgdGVzdGVyX3J1bl9ydWxlcyhjb25zdCBpbnQgcnVsZXMsIGNvbnN0IGludCByZXN1
bHQpCj4gK3sKPiArICAgICAgIGlmIChydWxlcyAmIExBTkRMT0NLX0FDQ0VTU19GU19FWEVDVVRF
KQo+ICsgICAgICAgICAgICAgICBfdGVzdF9leGVjKHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYg
KHJ1bGVzICYgTEFORExPQ0tfQUNDRVNTX0ZTX1dSSVRFX0ZJTEUpCj4gKyAgICAgICAgICAgICAg
IF90ZXN0X3dyaXRlKHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFORExPQ0tf
QUNDRVNTX0ZTX1JFQURfRklMRSkKPiArICAgICAgICAgICAgICAgX3Rlc3RfcmVhZChyZXN1bHQp
Owo+ICsKPiArICAgICAgIGlmIChydWxlcyAmIExBTkRMT0NLX0FDQ0VTU19GU19SRUFEX0RJUikK
PiArICAgICAgICAgICAgICAgX3Rlc3RfcmVhZGRpcihyZXN1bHQpOwo+ICsKPiArICAgICAgIGlm
IChydWxlcyAmIExBTkRMT0NLX0FDQ0VTU19GU19SRU1PVkVfRElSKQo+ICsgICAgICAgICAgICAg
ICBfdGVzdF9ybWRpcihyZXN1bHQpOwo+ICsKPiArICAgICAgIGlmIChydWxlcyAmIExBTkRMT0NL
X0FDQ0VTU19GU19SRU1PVkVfRklMRSkKPiArICAgICAgICAgICAgICAgX3Rlc3Rfcm1maWxlKHJl
c3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFORExPQ0tfQUNDRVNTX0ZTX01BS0Vf
Q0hBUikKPiArICAgICAgICAgICAgICAgX3Rlc3RfbWFrZShERVZfQ0hBUjAsIFNfSUZDSFIsIGRl
dl9jaHIsIHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFORExPQ0tfQUNDRVNT
X0ZTX01BS0VfQkxPQ0spCj4gKyAgICAgICAgICAgICAgIF90ZXN0X21ha2UoREVWX0JMSzAsIFNf
SUZCTEssIGRldl9ibGssIHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFORExP
Q0tfQUNDRVNTX0ZTX01BS0VfUkVHKQo+ICsgICAgICAgICAgICAgICBfdGVzdF9tYWtlKEZJTEVf
UkVHVUxBUiwgU19JRlJFRywgMCwgcmVzdWx0KTsKPiArCj4gKyAgICAgICBpZiAocnVsZXMgJiBM
QU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9TT0NLKQo+ICsgICAgICAgICAgICAgICBfdGVzdF9tYWtl
KEZJTEVfU09DS0VULCBTX0lGU09DSywgMCwgcmVzdWx0KTsKPiArCj4gKyAgICAgICBpZiAocnVs
ZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9GSUZPKQo+ICsgICAgICAgICAgICAgICBfdGVz
dF9tYWtlKEZJTEVfRklGTywgU19JRklGTywgMCwgcmVzdWx0KTsKPiArCj4gKyAgICAgICBpZiAo
cnVsZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9TWU0pCj4gKyAgICAgICAgICAgICAgIF90
ZXN0X3N5bWJvbGljKHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFORExPQ0tf
QUNDRVNTX0ZTX1RSVU5DQVRFKSB7Cj4gKyAgICAgICAgICAgICAgIGlmICgodHN0X2t2ZXJjbXAo
NiwgMiwgMCkpIDwgMCkgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHRzdF9yZXMoVElORk8s
ICJTa2lwIHRydW5jYXRlIHRlc3QuIE1pbmltdW0ga2VybmVsCj4gdmVyc2lvbiBpcyA2LjIiKTsK
PiArICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47Cj4gKyAgICAgICAgICAgICAgIH0KPiAr
Cj4gKyAgICAgICAgICAgICAgIF90ZXN0X3RydW5jYXRlKHJlc3VsdCk7Cj4gKyAgICAgICB9Cj4g
K30KPiArCj4gK3N0YXRpYyBpbmxpbmUgdm9pZCB0ZXN0ZXJfcnVuX2FsbF9ydWxlcyhjb25zdCBp
bnQgcGFzc19ydWxlcykKPiArewo+ICsgICAgICAgaW50IGZhaWxfcnVsZXM7Cj4gKyAgICAgICBp
bnQgYWxsX3J1bGVzOwo+ICsKPiArICAgICAgIGFsbF9ydWxlcyA9IHRlc3Rlcl9nZXRfYWxsX3J1
bGVzKCk7Cj4gKyAgICAgICBmYWlsX3J1bGVzID0gYWxsX3J1bGVzICYgfnBhc3NfcnVsZXM7Cj4g
Kwo+ICsgICAgICAgdGVzdGVyX3J1bl9ydWxlcyhwYXNzX3J1bGVzLCBUUEFTUyk7Cj4gKyAgICAg
ICB0ZXN0ZXJfcnVuX3J1bGVzKGZhaWxfcnVsZXMsIFRGQUlMKTsKPiArfQo+ICsKPiArI2VuZGlm
Cj4KPiAtLQo+IDIuNDMuMAo+Cj4KPiAtLQo+IE1haWxpbmcgbGlzdCBpbmZvOiBodHRwczovL2xp
c3RzLmxpbnV4Lml0L2xpc3RpbmZvL2x0cAo+Cj4KCi0tIApSZWdhcmRzLApMaSBXYW5nCgotLSAK
TWFpbGluZyBsaXN0IGluZm86IGh0dHBzOi8vbGlzdHMubGludXguaXQvbGlzdGluZm8vbHRwCg==
