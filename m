Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [IPv6:2001:1418:10:5::2])
	by mail.lfdr.de (Postfix) with ESMTPS id 4CCD422637
	for <lists+linux-ltp@lfdr.de>; Sun, 19 May 2019 07:26:30 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id 1ACEB3EA5A3
	for <lists+linux-ltp@lfdr.de>; Sun, 19 May 2019 07:26:30 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-3.smtp.seeweb.it (in-3.smtp.seeweb.it
 [IPv6:2001:4b78:1:20::3])
 by picard.linux.it (Postfix) with ESMTP id 06B783EA441
 for <ltp@lists.linux.it>; Sun, 19 May 2019 07:26:27 +0200 (CEST)
Received: from mail-pl1-x641.google.com (mail-pl1-x641.google.com
 [IPv6:2607:f8b0:4864:20::641])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by in-3.smtp.seeweb.it (Postfix) with ESMTPS id 0C6E51A00EED
 for <ltp@lists.linux.it>; Sun, 19 May 2019 07:26:26 +0200 (CEST)
Received: by mail-pl1-x641.google.com with SMTP id f97so5181662plb.5
 for <ltp@lists.linux.it>; Sat, 18 May 2019 22:26:25 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=mbobrowski-org.20150623.gappssmtp.com; s=20150623;
 h=date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:in-reply-to:user-agent;
 bh=OyDU7cjg2B1Qr52Qaxu+gjf1vmW0JFqvbCm/ocS+RuI=;
 b=OPcGUoHkhRcPlN/kHQYQ4LJx8/+6sSqQ8EJCQEbTkQMjiBB0A1Cd7fcV984o6IZQXO
 R+iILan1dm0Y/BeXtKWXJBGPjcbbYJtYYYOzu8kbWkPJbpuE65YnctvtGLHOVN72vUJn
 xBgFh2AuEKlbvtrh6w3LLDgfeaK2Z/GEA25Lyf+nThIgjZ60LshDA3Ajl46oKUc1Rsvg
 Aq5iAq0sUqkx11TknsvFQS+klb5r+/6VoShY8zjzDBaGl70gLAqB51JrDdcmYDFhY23/
 SuebmP8DVoMzgmiRv+tlZooJE+yp1MK0jv6Vq2JRDmBgdp39BxDUB0GFNSteg7LCZ/mh
 65VA==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id:references
 :mime-version:content-disposition:in-reply-to:user-agent;
 bh=OyDU7cjg2B1Qr52Qaxu+gjf1vmW0JFqvbCm/ocS+RuI=;
 b=e/zL01JFoFmwViTH3ip7Tn7/NkIp3e/+DgQYBe7TpVxqIEVqo/Dookn0S+ffhITVtj
 UQTrZfxhTpNfzlc4p9f7c3ibnzJOE3c8aFLFomaSBsthiaLz8Cm2Xs3Xs6etMITmDX8R
 TvEE0kNrCN8f/2ffei4MuYODha8rbck+iZVLwD8L9bb+8ccUBSdEqDA4rEl99HMv8vHY
 z2EpZvVK+gr6RzNNWtuUFoMuts6KuBI36nLXuHt156OX96tRUTX1c/BrY2JhLTndrPyr
 BKxz7nbVkgHw3lDEHEf3swS82SNm1iMMBYnn7atCEaSvmLnpZDtYyjgtz/YYiYDN/A3g
 OKzg==
X-Gm-Message-State: APjAAAXQ12YtGPrin5wAgcPaaiGIxhjS2NdLv8rlk0xMEMARyNvNwnBJ
 IzEIMe2QMT/r8TfopVZKt4ZGhB3yyA==
X-Google-Smtp-Source: APXvYqyK4LbGeOINITGdg0IJBq9Hkc44T44NjIqQtEqRQXeerEwO/289FS379qWJ1dn5TIpiO1Bxhw==
X-Received: by 2002:a17:902:8c8c:: with SMTP id
 t12mr68434850plo.116.1558243584156; 
 Sat, 18 May 2019 22:26:24 -0700 (PDT)
Received: from poseidon.Home (n114-74-156-190.sbr2.nsw.optusnet.com.au.
 [114.74.156.190])
 by smtp.gmail.com with ESMTPSA id a18sm22393894pfr.22.2019.05.18.22.26.20
 (version=TLS1_2 cipher=ECDHE-RSA-CHACHA20-POLY1305 bits=256/256);
 Sat, 18 May 2019 22:26:23 -0700 (PDT)
Date: Sun, 19 May 2019 15:26:15 +1000
From: Matthew Bobrowski <mbobrowski@mbobrowski.org>
To: ltp@lists.linux.it
Message-ID: <52fcc83b7fee6ba8d3499297fca4311e3fe74906.1558242368.git.mbobrowski@mbobrowski.org>
References: <cover.1558242368.git.mbobrowski@mbobrowski.org>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <cover.1558242368.git.mbobrowski@mbobrowski.org>
User-Agent: Mutt/1.11.3 (2019-02-01)
X-Virus-Scanned: clamav-milter 0.99.2 at in-3.smtp.seeweb.it
X-Virus-Status: Clean
X-Spam-Status: No, score=0.1 required=7.0 tests=DKIM_SIGNED,DKIM_VALID,
 SPF_HELO_NONE,SPF_NONE autolearn=disabled version=3.4.0
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on in-3.smtp.seeweb.it
Cc: jack@suse.cz
Subject: [LTP] [PATCH v3 3/3] syscalls/fanotify15: verify fid for dirent
 events
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

QSBuZXcgdGVzdCBmaWxlIHRoYXQgcHJvdmlkZXMgY292ZXJhZ2UgZm9yIG5ldyBkaXJlbnQgZXZl
bnRzIGFkZGVkLiBBCm5ldyBsaW5lIGVudHJ5IHdpdGhpbiB0aGUgcnVudGVzdC9zeXNjYWxscyBm
aWxlIGhhcyBiZWVuIGFsc28gYWRkZWQgdG8Kc3VwcG9ydCB0aGlzIG5ldyB0ZXN0IGZpbGUuCgpT
aWduZWQtb2ZmLWJ5OiBNYXR0aGV3IEJvYnJvd3NraSA8bWJvYnJvd3NraUBtYm9icm93c2tpLm9y
Zz4KUmV2aWV3ZWQtYnk6IEFtaXIgR29sZHN0ZWluIDxhbWlyNzNpbEBnbWFpbC5jb20+Ci0tLQog
cnVudGVzdC9zeXNjYWxscyAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAxICsKIHRl
c3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdpdGlnbm9yZSB8ICAgMSArCiAuLi4v
a2VybmVsL3N5c2NhbGxzL2Zhbm90aWZ5L2Zhbm90aWZ5MTUuYyAgICAgfCAyNDUgKysrKysrKysr
KysrKysrKysrCiAzIGZpbGVzIGNoYW5nZWQsIDI0NyBpbnNlcnRpb25zKCspCiBjcmVhdGUgbW9k
ZSAxMDA2NDQgdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9mYW5vdGlmeS9mYW5vdGlmeTE1LmMK
CmRpZmYgLS1naXQgYS9ydW50ZXN0L3N5c2NhbGxzIGIvcnVudGVzdC9zeXNjYWxscwppbmRleCA1
YzYyODk1YjAuLjJmOWYxNDczNiAxMDA2NDQKLS0tIGEvcnVudGVzdC9zeXNjYWxscworKysgYi9y
dW50ZXN0L3N5c2NhbGxzCkBAIC01MzksNiArNTM5LDcgQEAgZmFub3RpZnkxMSBmYW5vdGlmeTEx
CiBmYW5vdGlmeTEyIGZhbm90aWZ5MTIKIGZhbm90aWZ5MTMgZmFub3RpZnkxMwogZmFub3RpZnkx
NCBmYW5vdGlmeTE0CitmYW5vdGlmeTE1IGZhbm90aWZ5MTUKIAogaW9wZXJtMDEgaW9wZXJtMDEK
IGlvcGVybTAyIGlvcGVybTAyCmRpZmYgLS1naXQgYS90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxz
L2Zhbm90aWZ5Ly5naXRpZ25vcmUgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2Zhbm90aWZ5
Ly5naXRpZ25vcmUKaW5kZXggYmYzODljOTZhLi42OGU0Y2M3YWEgMTAwNjQ0Ci0tLSBhL3Rlc3Rj
YXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdpdGlnbm9yZQorKysgYi90ZXN0Y2FzZXMv
a2VybmVsL3N5c2NhbGxzL2Zhbm90aWZ5Ly5naXRpZ25vcmUKQEAgLTEyLDQgKzEyLDUgQEAKIC9m
YW5vdGlmeTEyCiAvZmFub3RpZnkxMwogL2Zhbm90aWZ5MTQKKy9mYW5vdGlmeTE1CiAvZmFub3Rp
ZnlfY2hpbGQKZGlmZiAtLWdpdCBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkv
ZmFub3RpZnkxNS5jIGIvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9mYW5vdGlmeS9mYW5vdGlm
eTE1LmMKbmV3IGZpbGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwLi4wMmYzYjM0YWIKLS0t
IC9kZXYvbnVsbAorKysgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2Zhbm90aWZ5L2Zhbm90
aWZ5MTUuYwpAQCAtMCwwICsxLDI0NSBAQAorLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQ
TC0yLjAtb3ItbGF0ZXIKKy8qCisgKiBDb3B5cmlnaHQgKGMpIDIwMTkgQ1RFUkEgTmV0d29ya3Mu
IEFsbCBSaWdodHMgUmVzZXJ2ZWQuCisgKgorICogU3RhcnRlZCBieSBBbWlyIEdvbGRzdGVpbiA8
YW1pcjczaWxAZ21haWwuY29tPgorICogTW9kaWZpZWQgYnkgTWF0dGhldyBCb2Jyb3dza2kgPG1i
b2Jyb3dza2lAbWJvYnJvd3NraS5vcmc+CisgKgorICogREVTQ1JJUFRJT04KKyAqCVRlc3QgZmls
ZSB0aGF0IGhhcyBiZWVuIHB1cnBvc2VseSBkZXNpZ25lZCB0byB2ZXJpZnkKKyAqCUZBTl9SRVBP
UlRfRklEIGZ1bmN0aW9uYWxpdHkgd2hpbGUgdXNpbmcgbmV3bHkgZGVmaW5lZCBkaXJlbnQKKyAq
CWV2ZW50cy4KKyAqLworI2RlZmluZSBfR05VX1NPVVJDRQorI2luY2x1ZGUgImNvbmZpZy5oIgor
CisjaW5jbHVkZSA8c3RyaW5nLmg+CisjaW5jbHVkZSA8ZXJybm8uaD4KKyNpbmNsdWRlIDxmY250
bC5oPgorI2luY2x1ZGUgPHN5cy9zdGF0ZnMuaD4KKyNpbmNsdWRlIDxzeXMvdHlwZXMuaD4KKwor
I2luY2x1ZGUgInRzdF90ZXN0LmgiCisjaW5jbHVkZSAiZmFub3RpZnkuaCIKKworI2lmIGRlZmlu
ZWQoSEFWRV9TWVNfRkFOT1RJRllfSCkKKyNpbmNsdWRlIDxzeXMvZmFub3RpZnkuaD4KKworI2Rl
ZmluZSBCVUZfU0laRSAyNTYKKyNkZWZpbmUgRVZFTlRfTUFYIDI1NgorCisjZGVmaW5lIE1PVU5U
X1BPSU5UICJtbnRwb2ludCIKKyNkZWZpbmUgVEVTVF9ESVIgTU9VTlRfUE9JTlQiL3Rlc3RfZGly
IgorI2RlZmluZSBESVIxIFRFU1RfRElSIi9kaXIxIgorI2RlZmluZSBESVIyIFRFU1RfRElSIi9k
aXIyIgorI2RlZmluZSBGSUxFMSBURVNUX0RJUiIvZmlsZTEiCisjZGVmaW5lIEZJTEUyIFRFU1Rf
RElSIi9maWxlMiIKKworc3RydWN0IGV2ZW50X3QgeworCXVuc2lnbmVkIGxvbmcgbG9uZyBtYXNr
OworCV9fa2VybmVsX2ZzaWRfdCBmc2lkOworCXN0cnVjdCBmaWxlX2hhbmRsZSBoYW5kbGU7CisJ
Y2hhciBidWZbTUFYX0hBTkRMRV9TWl07Cit9OworCitzdGF0aWMgaW50IGZhbm90aWZ5X2ZkOwor
c3RhdGljIGNoYXIgZXZlbnRzX2J1ZltCVUZfU0laRV07CitzdGF0aWMgc3RydWN0IGV2ZW50X3Qg
ZXZlbnRfc2V0W0VWRU5UX01BWF07CisKK3N0YXRpYyB2b2lkIGRvX3NldHVwKHZvaWQpCit7CisJ
aW50IGZkOworCisJLyogQ2hlY2sga2VybmVsIGZvciBmYW5vdGlmeSBzdXBwb3J0ICovCisJZmQg
PSBTQUZFX0ZBTk9USUZZX0lOSVQoRkFOX0NMQVNTX05PVElGLCBPX1JET05MWSk7CisJU0FGRV9D
TE9TRShmZCk7CisKKwlmYW5vdGlmeV9mZCA9IGZhbm90aWZ5X2luaXQoRkFOX1JFUE9SVF9GSUQs
IE9fUkRPTkxZKTsKKwlpZiAoZmFub3RpZnlfZmQgPT0gLTEpIHsKKwkJaWYgKGVycm5vID09IEVJ
TlZBTCkKKwkJCXRzdF9icmsoVENPTkYsCisJCQkJIkZBTl9SRVBPUlRfRklEIG5vdCBzdXBwb3J0
ZWQgaW4ga2VybmVsIik7CisJCXRzdF9icmsoVEJST0sgfCBURVJSTk8sCisJCQkiZmFub3RpZnlf
aW5pdChGQU5fUkVQT1JUX0ZJRCwgT19SRE9OTFkpIGZhaWxlZCIpOworCX0KKworCVNBRkVfTUtE
SVIoVEVTVF9ESVIsIDA3NTUpOworfQorCitzdGF0aWMgdm9pZCBkb190ZXN0KHZvaWQpCit7CisJ
aW50IGksIGZkLCBsZW4sIGNvdW50ID0gMDsKKworCXN0cnVjdCBmaWxlX2hhbmRsZSAqZXZlbnRf
ZmlsZV9oYW5kbGU7CisJc3RydWN0IGZhbm90aWZ5X2V2ZW50X21ldGFkYXRhICptZXRhZGF0YTsK
KwlzdHJ1Y3QgZmFub3RpZnlfZXZlbnRfaW5mb19maWQgKmV2ZW50X2ZpZDsKKworCWlmIChmYW5v
dGlmeV9tYXJrKGZhbm90aWZ5X2ZkLCBGQU5fTUFSS19BREQgfCBGQU5fTUFSS19GSUxFU1lTVEVN
LAorCQkJCUZBTl9DUkVBVEUgfCBGQU5fREVMRVRFIHwgRkFOX0FUVFJJQiB8CisJCQkJRkFOX01P
VkVEX0ZST00gfCBGQU5fTU9WRURfVE8gfAorCQkJCUZBTl9ERUxFVEVfU0VMRiB8IEZBTl9PTkRJ
UiwKKwkJCQlBVF9GRENXRCwgVEVTVF9ESVIpID09IC0xKSB7CisJCWlmIChlcnJubyA9PSBFTk9E
RVYpCisJCQl0c3RfYnJrKFRDT05GLAorCQkJCSJGQU5fUkVQT1JUX0ZJRCBub3Qgc3VwcG9ydGVk
IG9uICVzICIKKwkJCQkiZmlsZXN5c3RlbSIsIHRzdF9kZXZpY2UtPmZzX3R5cGUpOworCQl0c3Rf
YnJrKFRCUk9LIHwgVEVSUk5PLAorCQkJImZhbm90aWZ5X21hcmsoJWQsIEZBTl9NQVJLX0FERCwg
RkFOX0NSRUFURSB8ICIKKwkJCSJGQU5fREVMRVRFIHwgRkFOX01PVkVEX0ZST00gfCBGQU5fTU9W
RURfVE8gfCAiCisJCQkiRkFOX0RFTEVURV9TRUxGIHwgRkFOX09ORElSLCBBVF9GRENXRCwgJXMp
IGZhaWxlZCIsCisJCQlmYW5vdGlmeV9mZCwgVEVTVF9ESVIpOworCX0KKworCS8qIEdlbmVyYXRl
IGEgc2VxdWVuY2Ugb2YgZXZlbnRzICovCisJZXZlbnRfc2V0W2NvdW50XS5tYXNrID0gRkFOX0NS
RUFURSB8IEZBTl9NT1ZFRF9GUk9NIHwgRkFOX01PVkVEX1RPIHwgXAorCQkJCUZBTl9ERUxFVEU7
CisJZXZlbnRfc2V0W2NvdW50XS5oYW5kbGUuaGFuZGxlX2J5dGVzID0gTUFYX0hBTkRMRV9TWjsK
KwlmYW5vdGlmeV9nZXRfZmlkKFRFU1RfRElSLCAmZXZlbnRfc2V0W2NvdW50XS5mc2lkLAorCQkJ
ICZldmVudF9zZXRbY291bnRdLmhhbmRsZSk7CisJY291bnQrKzsKKworCWZkID0gU0FGRV9DUkVB
VChGSUxFMSwgMDY0NCk7CisJU0FGRV9DTE9TRShmZCk7CisKKwlTQUZFX1JFTkFNRShGSUxFMSwg
RklMRTIpOworCisJZXZlbnRfc2V0W2NvdW50XS5tYXNrID0gRkFOX0FUVFJJQiB8IEZBTl9ERUxF
VEVfU0VMRjsKKwlldmVudF9zZXRbY291bnRdLmhhbmRsZS5oYW5kbGVfYnl0ZXMgPSBNQVhfSEFO
RExFX1NaOworCWZhbm90aWZ5X2dldF9maWQoRklMRTIsICZldmVudF9zZXRbY291bnRdLmZzaWQs
CisJCQkgJmV2ZW50X3NldFtjb3VudF0uaGFuZGxlKTsKKwljb3VudCsrOworCisJU0FGRV9VTkxJ
TksoRklMRTIpOworCisJLyogR2VuZXJhdGUgYSBzZXF1ZW5jZSBvZiBldmVudHMgb24gYSBkaXJl
Y3RvcnkuIFN1YnNlcXVlbnQgZXZlbnRzCisJICogYXJlIG1lcmdlZCwgc28gaXQncyByZXF1aXJl
ZCB0aGF0IHdlIHNldCBGQU5fT05ESVIgb25jZSBpbgorCSAqIG9yZGVyIHRvIGFja25vd2xlZGdl
IHRoYXQgY2hhbmdlcyByZWxhdGVkIHRvIGEgc3ViZGlyZWN0b3J5CisJICogdG9vayBwbGFjZS4g
RXZlbnRzIG9uIHN1YmRpcmVjdG9yaWVzIGFyZSBub3QgbWVyZ2VkIHdpdGggZXZlbnRzCisJICog
b24gbm9uLXN1YmRpcmVjdG9yaWVzLgorCSAqLworCWV2ZW50X3NldFtjb3VudF0ubWFzayA9IEZB
Tl9PTkRJUiB8IEZBTl9DUkVBVEUgfCBGQU5fTU9WRURfRlJPTSB8IFwKKwkJCQlGQU5fTU9WRURf
VE8gfCBGQU5fREVMRVRFOworCWV2ZW50X3NldFtjb3VudF0uaGFuZGxlLmhhbmRsZV9ieXRlcyA9
IE1BWF9IQU5ETEVfU1o7CisJZmFub3RpZnlfZ2V0X2ZpZChURVNUX0RJUiwgJmV2ZW50X3NldFtj
b3VudF0uZnNpZCwKKwkJCSAmZXZlbnRfc2V0W2NvdW50XS5oYW5kbGUpOworCWNvdW50Kys7CisK
KwlTQUZFX01LRElSKERJUjEsIDA3NTUpOworCisJU0FGRV9SRU5BTUUoRElSMSwgRElSMik7CisK
KwlldmVudF9zZXRbY291bnRdLm1hc2sgPSBGQU5fT05ESVIgfCBGQU5fREVMRVRFX1NFTEY7CisJ
ZXZlbnRfc2V0W2NvdW50XS5oYW5kbGUuaGFuZGxlX2J5dGVzID0gTUFYX0hBTkRMRV9TWjsKKwlm
YW5vdGlmeV9nZXRfZmlkKERJUjIsICZldmVudF9zZXRbY291bnRdLmZzaWQsCisJCQkgJmV2ZW50
X3NldFtjb3VudF0uaGFuZGxlKTsKKwljb3VudCsrOworCisJU0FGRV9STURJUihESVIyKTsKKwor
CS8qIFJlYWQgZXZlbnRzIGZyb20gdGhlIGV2ZW50IHF1ZXVlICovCisJbGVuID0gU0FGRV9SRUFE
KDAsIGZhbm90aWZ5X2ZkLCBldmVudHNfYnVmLCBCVUZfU0laRSk7CisKKwkvKiBQcm9jZXNzIGVh
Y2ggZXZlbnQgaW4gYnVmZmVyICovCisJZm9yIChpID0gMCwgbWV0YWRhdGEgPSAoc3RydWN0IGZh
bm90aWZ5X2V2ZW50X21ldGFkYXRhICopIGV2ZW50c19idWY7CisJCUZBTl9FVkVOVF9PSyhtZXRh
ZGF0YSwgbGVuKTsKKwkJbWV0YWRhdGEgPSBGQU5fRVZFTlRfTkVYVChtZXRhZGF0YSxsZW4pLCBp
KyspIHsKKwkJZXZlbnRfZmlkID0gKHN0cnVjdCBmYW5vdGlmeV9ldmVudF9pbmZvX2ZpZCAqKSAo
bWV0YWRhdGEgKyAxKTsKKwkJZXZlbnRfZmlsZV9oYW5kbGUgPSAoc3RydWN0IGZpbGVfaGFuZGxl
ICopIGV2ZW50X2ZpZC0+aGFuZGxlOworCisJCWlmIChpID49IGNvdW50KSB7CisJCQl0c3RfcmVz
KFRGQUlMLAorCQkJCSJnb3QgdW5uZWNlc3NhcnkgZXZlbnQ6IG1hc2s9JWxseCAiCisJCQkJInBp
ZD0ldSBmZD0lZCIsCisJCQkJKHVuc2lnbmVkIGxvbmcgbG9uZykgbWV0YWRhdGEtPm1hc2ssCisJ
CQkJbWV0YWRhdGEtPnBpZCwKKwkJCQltZXRhZGF0YS0+ZmQpOworCQkJbWV0YWRhdGEtPm1hc2sg
PSAwOworCQl9IGVsc2UgaWYgKG1ldGFkYXRhLT5mZCAhPSBGQU5fTk9GRCkgeworCQkJdHN0X3Jl
cyhURkFJTCwKKwkJCQkiUmVjZWl2ZWQgdW5leHBlY3RlZCBmaWxlIGRlc2NyaXB0b3IgJWQgaW4g
IgorCQkJCSJldmVudC4gRXhwZWN0ZWQgdG8gZ2V0IEZBTl9OT0ZEKCVkKSIsCisJCQkJbWV0YWRh
dGEtPmZkLCBGQU5fTk9GRCk7CisJCX0gZWxzZSBpZiAobWV0YWRhdGEtPm1hc2sgIT0gZXZlbnRf
c2V0W2ldLm1hc2spIHsKKwkJCXRzdF9yZXMoVEZBSUwsCisJCQkJIkdvdCBldmVudDogbWFzaz0l
bGx4IChleHBlY3RlZCAlbGx4KSAiCisJCQkJInBpZD0ldSBmZD0lZCIsCisJCQkJKHVuc2lnbmVk
IGxvbmcgbG9uZykgbWV0YWRhdGEtPm1hc2ssCisJCQkJZXZlbnRfc2V0W2ldLm1hc2ssCisJCQkJ
KHVuc2lnbmVkKSBtZXRhZGF0YS0+cGlkLAorCQkJCW1ldGFkYXRhLT5mZCk7CisJCX0gZWxzZSBp
ZiAobWV0YWRhdGEtPnBpZCAhPSBnZXRwaWQoKSkgeworCQkJdHN0X3JlcyhURkFJTCwKKwkJCQki
R290IGV2ZW50OiBtYXNrPSVsbHggcGlkPSV1ICIKKwkJCQkiKGV4cGVjdGVkICV1KSBmZD0lZCIs
CisJCQkJKHVuc2lnbmVkIGxvbmcgbG9uZykgbWV0YWRhdGEtPm1hc2ssCisJCQkJKHVuc2lnbmVk
KSBtZXRhZGF0YS0+cGlkLAorCQkJCSh1bnNpZ25lZCkgZ2V0cGlkKCksCisJCQkJbWV0YWRhdGEt
PmZkKTsKKwkJfSBlbHNlIGlmIChldmVudF9maWxlX2hhbmRsZS0+aGFuZGxlX2J5dGVzICE9CisJ
CQkJZXZlbnRfc2V0W2ldLmhhbmRsZS5oYW5kbGVfYnl0ZXMpIHsKKwkJCXRzdF9yZXMoVEZBSUws
CisJCQkJIkdvdCBldmVudDogaGFuZGxlX2J5dGVzICgleCkgcmV0dXJuZWQgaW4gIgorCQkJCSJl
dmVudCBkb2VzIG5vdCBlcXVhbCBoYW5kbGVfYnl0ZXMgKCV4KSAiCisJCQkJInJldHVucmVkIGlu
IG5hbWVfdG9faGFuZGxlX2F0KDIpIiwKKwkJCQlldmVudF9maWxlX2hhbmRsZS0+aGFuZGxlX2J5
dGVzLAorCQkJCWV2ZW50X3NldFtpXS5oYW5kbGUuaGFuZGxlX2J5dGVzKTsKKwkJfSBlbHNlIGlm
IChldmVudF9maWxlX2hhbmRsZS0+aGFuZGxlX3R5cGUgIT0KKwkJCQlldmVudF9zZXRbaV0uaGFu
ZGxlLmhhbmRsZV90eXBlKSB7CisJCQl0c3RfcmVzKFRGQUlMLAorCQkJCSJoYW5kbGVfdHlwZSAo
JXgpIHJldHVybmVkIGluIGV2ZW50IGRvZXMgbm90ICIKKwkJCQkiZXF1YWwgdG8gaGFuZGxlX3R5
cGUgKCV4KSByZXR1cm5lZCBpbiAiCisJCQkJIm5hbWVfdG9faGFuZGxlX2F0KDIpIiwKKwkJCQll
dmVudF9maWxlX2hhbmRsZS0+aGFuZGxlX3R5cGUsCisJCQkJZXZlbnRfc2V0W2ldLmhhbmRsZS5o
YW5kbGVfdHlwZSk7CisJCX0gZWxzZSBpZiAobWVtY21wKGV2ZW50X2ZpbGVfaGFuZGxlLT5mX2hh
bmRsZSwKKwkJCQkJZXZlbnRfc2V0W2ldLmhhbmRsZS5mX2hhbmRsZSwKKwkJCQkJZXZlbnRfc2V0
W2ldLmhhbmRsZS5oYW5kbGVfYnl0ZXMpCisJCQkJCSE9IDApIHsKKwkJCXRzdF9yZXMoVEZBSUws
CisJCQkJImV2ZW50X2ZpbGVfaGFuZGxlLT5mX2hhbmRsZSBkb2VzIG5vdCBtYXRjaCAiCisJCQkJ
ImhhbmRsZS5mX2hhbmRsZSByZXR1cm5lZCBpbiAiCisJCQkJIm5hbWVfdG9faGFuZGxlX2F0KDIp
Iik7CisJCX0gZWxzZSBpZiAobWVtY21wKCZldmVudF9maWQtPmZzaWQsICZldmVudF9zZXRbaV0u
ZnNpZCwKKwkJCQkJc2l6ZW9mKGV2ZW50X3NldFtpXS5mc2lkKSkgIT0gMCkgeworCQkJdHN0X3Jl
cyhURkFJTCwKKwkJCQkiZXZlbnRfZmlkLT5mc2lkICE9IHN0YXRzLmZfZnNpZCB0aGF0IHdhcyAi
CisJCQkJIm9idGFpbmVkIHZpYSBzdGF0ZnMoMikiKTsKKwkJfSBlbHNlIHsKKwkJCXRzdF9yZXMo
VFBBU1MsCisJCQkJIkdvdCBldmVudDogbWFzaz0lbGx4LCBwaWQ9JXUsICIKKwkJCQkiZmlkPSV4
LiV4LiVseCB2YWx1ZXMiLAorCQkJCW1ldGFkYXRhLT5tYXNrLAorCQkJCWdldHBpZCgpLAorCQkJ
CWV2ZW50X2ZpZC0+ZnNpZC52YWxbMF0sCisJCQkJZXZlbnRfZmlkLT5mc2lkLnZhbFsxXSwKKwkJ
CQkqKHVuc2lnbmVkIGxvbmcgKikKKwkJCQlldmVudF9maWxlX2hhbmRsZS0+Zl9oYW5kbGUpOwor
CQl9CisJfQorCisJZm9yICg7IGkgPCBjb3VudDsgaSsrKQorCQl0c3RfcmVzKFRGQUlMLAorCQkJ
IkRpZG4ndCByZWNlaXZlIGV2ZW50OiBtYXNrPSVsbHgiLAorCQkJZXZlbnRfc2V0W2ldLm1hc2sp
OworfQorCitzdGF0aWMgdm9pZCBkb19jbGVhbnVwKHZvaWQpCit7CisJaWYgKGZhbm90aWZ5X2Zk
ID4gMCkKKwkJU0FGRV9DTE9TRShmYW5vdGlmeV9mZCk7Cit9CisKK3N0YXRpYyBzdHJ1Y3QgdHN0
X3Rlc3QgdGVzdCA9IHsKKwkubmVlZHNfcm9vdCA9IDEsCisJLm5lZWRzX3RtcGRpciA9IDEsCisJ
Lm1vdW50X2RldmljZSA9IDEsCisJLm1udHBvaW50ID0gTU9VTlRfUE9JTlQsCisJLmFsbF9maWxl
c3lzdGVtcyA9IDEsCisJLnNldHVwID0gZG9fc2V0dXAsCisJLnRlc3RfYWxsID0gZG9fdGVzdCwK
KwkuY2xlYW51cCA9IGRvX2NsZWFudXAKK307CisKKyNlbHNlCisJVFNUX1RFU1RfQ09ORigiU3lz
dGVtIGRvZXMgbm90IGhhdmUgcmVxdWlyZWQgZmFub3RpZnkgc3VwcG9ydCIpOworI2VuZGlmCi0t
IAoyLjIxLjAKCgotLSAKTWF0dGhldyBCb2Jyb3dza2kKCi0tIApNYWlsaW5nIGxpc3QgaW5mbzog
aHR0cHM6Ly9saXN0cy5saW51eC5pdC9saXN0aW5mby9sdHAK
