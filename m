Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [213.254.12.146])
	by mail.lfdr.de (Postfix) with ESMTPS id C70EB4CB6B
	for <lists+linux-ltp@lfdr.de>; Thu, 20 Jun 2019 11:59:07 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id 966312987B2
	for <lists+linux-ltp@lfdr.de>; Thu, 20 Jun 2019 11:59:07 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-4.smtp.seeweb.it (in-4.smtp.seeweb.it [217.194.8.4])
 by picard.linux.it (Postfix) with ESMTP id 8F5F92987A9
 for <ltp@lists.linux.it>; Thu, 20 Jun 2019 11:59:04 +0200 (CEST)
Received: from mail-pf1-x444.google.com (mail-pf1-x444.google.com
 [IPv6:2607:f8b0:4864:20::444])
 (using TLSv1.2 with cipher ECDHE-RSA-AES128-GCM-SHA256 (128/128 bits))
 (No client certificate requested)
 by in-4.smtp.seeweb.it (Postfix) with ESMTPS id 64ABA1000C55
 for <ltp@lists.linux.it>; Thu, 20 Jun 2019 11:58:59 +0200 (CEST)
Received: by mail-pf1-x444.google.com with SMTP id 81so1356681pfy.13
 for <ltp@lists.linux.it>; Thu, 20 Jun 2019 02:59:03 -0700 (PDT)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=mbobrowski-org.20150623.gappssmtp.com; s=20150623;
 h=date:from:to:cc:subject:message-id:references:mime-version
 :content-disposition:in-reply-to:user-agent;
 bh=tbrdB7XQIkDfPPaJQ6aY9O4XEpjUPoQSCh7LhND45Ik=;
 b=PNtp6LUfQs1yp+i7TiOfZG5Ui6aElsRqYJ5bwexNtb0pR8vhhXjXymjAFArPq65FfW
 I2knOkC4QbGw5asVYrGi0ItKYXkSA7+VAnGIJP3py3vNsPEHvuEI2u6ZlOnqEkZ/U+Mt
 E3P7+OSEVQ2q3LV3l7AlX8FXSEOGZMlSPxAFbbQD8iwDz0V9wSgi5DwAmgocX7/sYHfd
 Erk2zniGXqdSP5xiluEbfs1uVs5Blr5dMnnNWgMezRygo8w1tb8pX3baK9gCfgiOMPeO
 9NOsm/QIVr6kYGMsqq1Y0mJAqWvMkINbR+PnkssyBMAnjB18WiP9vDBq5N9cCvjUNR39
 RATg==
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20161025;
 h=x-gm-message-state:date:from:to:cc:subject:message-id:references
 :mime-version:content-disposition:in-reply-to:user-agent;
 bh=tbrdB7XQIkDfPPaJQ6aY9O4XEpjUPoQSCh7LhND45Ik=;
 b=ts5gLgRZbo22acId0j3AnvA178eWLNYPs2KZoCGjLmlcHyOlqtRF4KazaL0t7xUlkr
 d1NpvuaJ7OQhL2EQ1mCmUSDYNqbY103TlyoAr5zFj6B5Qb9kb5TqC4CrDksslDBE6iWX
 9TqDELF2SFUnIvXIL92in+NEsKKio7cPuFYSav5xCwBFcAMn5B/JuDmf/M+Km695XuHZ
 dCu17exnUfhyScvOG9CML/v/C8oz7D0kzuqIyK/o/Mkkdy+5M7uKh2JOPGx8HY195B4e
 XjGhaj1JRI1+vqGY8dP1egaRlCLkHz/JOeUDYm9KV4pHbvKJzMj/+Y2XaHZZxFyoFZyM
 +X8w==
X-Gm-Message-State: APjAAAWG/41mxX8E3YDv2DszgdWyevCbPenEIReGdS2q6Bf4f2c2X2q9
 Kyq9x1lC/j/nnVccQGwLx9MHEX/YVw==
X-Google-Smtp-Source: APXvYqwyB6fE8BQghnhjQd8X5AH7JtVts8VENmJtJXxbNkV+bNW4bbm+zGQgkp7p8zIrCZ8Hxx0+gg==
X-Received: by 2002:a17:90a:206a:: with SMTP id
 n97mr2250368pjc.10.1561024741614; 
 Thu, 20 Jun 2019 02:59:01 -0700 (PDT)
Received: from neo.Home ([114.78.0.167])
 by smtp.gmail.com with ESMTPSA id 30sm15345875pjk.17.2019.06.20.02.58.59
 (version=TLS1_3 cipher=AEAD-AES256-GCM-SHA384 bits=256/256);
 Thu, 20 Jun 2019 02:59:00 -0700 (PDT)
Date: Thu, 20 Jun 2019 19:58:55 +1000
From: Matthew Bobrowski <mbobrowski@mbobrowski.org>
To: ltp@lists.linux.it
Message-ID: <5abce371ba13e202fca416267c6e9c4c250cffda.1561018312.git.mbobrowski@mbobrowski.org>
References: <cover.1561018312.git.mbobrowski@mbobrowski.org>
MIME-Version: 1.0
Content-Disposition: inline
In-Reply-To: <cover.1561018312.git.mbobrowski@mbobrowski.org>
User-Agent: Mutt/1.10.1 (2018-07-13)
X-Virus-Scanned: clamav-milter 0.99.2 at in-4.smtp.seeweb.it
X-Virus-Status: Clean
X-Spam-Status: No, score=0.1 required=7.0 tests=DKIM_SIGNED,DKIM_VALID,
 SPF_HELO_NONE,SPF_NONE autolearn=disabled version=3.4.0
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on in-4.smtp.seeweb.it
Cc: jack@suse.cz
Subject: [LTP] [PATCH v5 3/4] syscalls/fanotify15: verify fid for dirent
 events
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

QSBuZXcgdGVzdCBmaWxlIHRoYXQgcHJvdmlkZXMgY292ZXJhZ2UgZm9yIG5ldyBkaXJlbnQgZXZl
bnRzIGhhcyBiZWVuCmFkZGVkLiBBIG5ldyBsaW5lIGVudHJ5IHdpdGhpbiB0aGUgcnVudGVzdC9z
eXNjYWxscyBmaWxlIGhhcyBiZWVuIGFsc28KYWRkZWQgdG8gc3VwcG9ydCB0aGUgdGVzdGluZyBv
ZiB0aGVzZSBuZXcgZGlyZW50IGV2ZW50cy4KClNpZ25lZC1vZmYtYnk6IE1hdHRoZXcgQm9icm93
c2tpIDxtYm9icm93c2tpQG1ib2Jyb3dza2kub3JnPgpSZXZpZXdlZC1ieTogQW1pciBHb2xkc3Rl
aW4gPGFtaXI3M2lsQGdtYWlsLmNvbT4KLS0tCiBydW50ZXN0L3N5c2NhbGxzICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB8ICAgMSArCiB0ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2Zh
bm90aWZ5Ly5naXRpZ25vcmUgICB8ICAgMSArCiB0ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2Zh
bm90aWZ5L2Zhbm90aWZ5MTUuYyB8IDI0NiArKysrKysrKysrKysrKysrKysrKysrKysKIDMgZmls
ZXMgY2hhbmdlZCwgMjQ4IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0Y2Fz
ZXMva2VybmVsL3N5c2NhbGxzL2Zhbm90aWZ5L2Zhbm90aWZ5MTUuYwoKZGlmZiAtLWdpdCBhL3J1
bnRlc3Qvc3lzY2FsbHMgYi9ydW50ZXN0L3N5c2NhbGxzCmluZGV4IDU2Zjg0ODI0YS4uMjVjYjI5
ZGFiIDEwMDY0NAotLS0gYS9ydW50ZXN0L3N5c2NhbGxzCisrKyBiL3J1bnRlc3Qvc3lzY2FsbHMK
QEAgLTUzNiw2ICs1MzYsNyBAQCBmYW5vdGlmeTExIGZhbm90aWZ5MTEKIGZhbm90aWZ5MTIgZmFu
b3RpZnkxMgogZmFub3RpZnkxMyBmYW5vdGlmeTEzCiBmYW5vdGlmeTE0IGZhbm90aWZ5MTQKK2Zh
bm90aWZ5MTUgZmFub3RpZnkxNQogCiBpb3Blcm0wMSBpb3Blcm0wMQogaW9wZXJtMDIgaW9wZXJt
MDIKZGlmZiAtLWdpdCBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdpdGln
bm9yZSBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvLmdpdGlnbm9yZQppbmRl
eCBiZjM4OWM5NmEuLjY4ZTRjYzdhYSAxMDA2NDQKLS0tIGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNj
YWxscy9mYW5vdGlmeS8uZ2l0aWdub3JlCisrKyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMv
ZmFub3RpZnkvLmdpdGlnbm9yZQpAQCAtMTIsNCArMTIsNSBAQAogL2Zhbm90aWZ5MTIKIC9mYW5v
dGlmeTEzCiAvZmFub3RpZnkxNAorL2Zhbm90aWZ5MTUKIC9mYW5vdGlmeV9jaGlsZApkaWZmIC0t
Z2l0IGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9mYW5vdGlmeS9mYW5vdGlmeTE1LmMgYi90
ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2Zhbm90aWZ5L2Zhbm90aWZ5MTUuYwpuZXcgZmlsZSBt
b2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAuLjY5ODFiNzg5MQotLS0gL2Rldi9udWxsCisrKyBi
L3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvZmFub3RpZnkvZmFub3RpZnkxNS5jCkBAIC0wLDAg
KzEsMjQ2IEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRlcgor
LyoKKyAqIENvcHlyaWdodCAoYykgMjAxOSBDVEVSQSBOZXR3b3Jrcy4gQWxsIFJpZ2h0cyBSZXNl
cnZlZC4KKyAqCisgKiBTdGFydGVkIGJ5IEFtaXIgR29sZHN0ZWluIDxhbWlyNzNpbEBnbWFpbC5j
b20+CisgKiBNb2RpZmllZCBieSBNYXR0aGV3IEJvYnJvd3NraSA8bWJvYnJvd3NraUBtYm9icm93
c2tpLm9yZz4KKyAqCisgKiBERVNDUklQVElPTgorICoJVGVzdCBmaWxlIHRoYXQgaGFzIGJlZW4g
cHVycG9zZWx5IGRlc2lnbmVkIHRvIHZlcmlmeQorICoJRkFOX1JFUE9SVF9GSUQgZnVuY3Rpb25h
bGl0eSB3aGlsZSB1c2luZyBuZXdseSBkZWZpbmVkIGRpcmVudAorICoJZXZlbnRzLgorICovCisj
ZGVmaW5lIF9HTlVfU09VUkNFCisjaW5jbHVkZSAiY29uZmlnLmgiCisKKyNpbmNsdWRlIDxzdHJp
bmcuaD4KKyNpbmNsdWRlIDxlcnJuby5oPgorI2luY2x1ZGUgPGZjbnRsLmg+CisjaW5jbHVkZSA8
c3lzL3N0YXRmcy5oPgorI2luY2x1ZGUgPHN5cy90eXBlcy5oPgorCisjaW5jbHVkZSAidHN0X3Rl
c3QuaCIKKyNpbmNsdWRlICJmYW5vdGlmeS5oIgorCisjaWYgZGVmaW5lZChIQVZFX1NZU19GQU5P
VElGWV9IKQorI2luY2x1ZGUgPHN5cy9mYW5vdGlmeS5oPgorCisjZGVmaW5lIEJVRl9TSVpFIDI1
NgorI2RlZmluZSBFVkVOVF9NQVggMjU2CisKKyNkZWZpbmUgTU9VTlRfUE9JTlQgIm1udHBvaW50
IgorI2RlZmluZSBURVNUX0RJUiBNT1VOVF9QT0lOVCIvdGVzdF9kaXIiCisjZGVmaW5lIERJUjEg
VEVTVF9ESVIiL2RpcjEiCisjZGVmaW5lIERJUjIgVEVTVF9ESVIiL2RpcjIiCisjZGVmaW5lIEZJ
TEUxIFRFU1RfRElSIi9maWxlMSIKKyNkZWZpbmUgRklMRTIgVEVTVF9ESVIiL2ZpbGUyIgorCitz
dHJ1Y3QgZXZlbnRfdCB7CisJdW5zaWduZWQgbG9uZyBsb25nIG1hc2s7CisJX19rZXJuZWxfZnNp
ZF90IGZzaWQ7CisJc3RydWN0IGZpbGVfaGFuZGxlIGhhbmRsZTsKKwljaGFyIGJ1ZltNQVhfSEFO
RExFX1NaXTsKK307CisKK3N0YXRpYyBpbnQgZmFub3RpZnlfZmQ7CitzdGF0aWMgY2hhciBldmVu
dHNfYnVmW0JVRl9TSVpFXTsKK3N0YXRpYyBzdHJ1Y3QgZXZlbnRfdCBldmVudF9zZXRbRVZFTlRf
TUFYXTsKKworc3RhdGljIHZvaWQgZG9fdGVzdCh2b2lkKQoreworCWludCBpLCBmZCwgbGVuLCBj
b3VudCA9IDA7CisKKwlzdHJ1Y3QgZmlsZV9oYW5kbGUgKmV2ZW50X2ZpbGVfaGFuZGxlOworCXN0
cnVjdCBmYW5vdGlmeV9ldmVudF9tZXRhZGF0YSAqbWV0YWRhdGE7CisJc3RydWN0IGZhbm90aWZ5
X2V2ZW50X2luZm9fZmlkICpldmVudF9maWQ7CisKKwlpZiAoZmFub3RpZnlfbWFyayhmYW5vdGlm
eV9mZCwgRkFOX01BUktfQUREIHwgRkFOX01BUktfRklMRVNZU1RFTSwKKwkJCQlGQU5fQ1JFQVRF
IHwgRkFOX0RFTEVURSB8IEZBTl9BVFRSSUIgfAorCQkJCUZBTl9NT1ZFRF9GUk9NIHwgRkFOX01P
VkVEX1RPIHwKKwkJCQlGQU5fREVMRVRFX1NFTEYgfCBGQU5fT05ESVIsCisJCQkJQVRfRkRDV0Qs
IFRFU1RfRElSKSA9PSAtMSkgeworCQlpZiAoZXJybm8gPT0gRU5PREVWKQorCQkJdHN0X2JyayhU
Q09ORiwKKwkJCQkiRkFOX1JFUE9SVF9GSUQgbm90IHN1cHBvcnRlZCBvbiAlcyAiCisJCQkJImZp
bGVzeXN0ZW0iLCB0c3RfZGV2aWNlLT5mc190eXBlKTsKKwkJdHN0X2JyayhUQlJPSyB8IFRFUlJO
TywKKwkJCSJmYW5vdGlmeV9tYXJrKCVkLCBGQU5fTUFSS19BREQsIEZBTl9DUkVBVEUgfCAiCisJ
CQkiRkFOX0RFTEVURSB8IEZBTl9NT1ZFRF9GUk9NIHwgRkFOX01PVkVEX1RPIHwgIgorCQkJIkZB
Tl9ERUxFVEVfU0VMRiB8IEZBTl9PTkRJUiwgQVRfRkRDV0QsICVzKSBmYWlsZWQiLAorCQkJZmFu
b3RpZnlfZmQsIFRFU1RfRElSKTsKKwl9CisKKwkvKiBHZW5lcmF0ZSBhIHNlcXVlbmNlIG9mIGV2
ZW50cyAqLworCWV2ZW50X3NldFtjb3VudF0ubWFzayA9IEZBTl9DUkVBVEUgfCBGQU5fTU9WRURf
RlJPTSB8IEZBTl9NT1ZFRF9UTyB8IFwKKwkJCQlGQU5fREVMRVRFOworCWV2ZW50X3NldFtjb3Vu
dF0uaGFuZGxlLmhhbmRsZV9ieXRlcyA9IE1BWF9IQU5ETEVfU1o7CisJZmFub3RpZnlfZ2V0X2Zp
ZChURVNUX0RJUiwgJmV2ZW50X3NldFtjb3VudF0uZnNpZCwKKwkJCSAmZXZlbnRfc2V0W2NvdW50
XS5oYW5kbGUpOworCWNvdW50Kys7CisKKwlmZCA9IFNBRkVfQ1JFQVQoRklMRTEsIDA2NDQpOwor
CVNBRkVfQ0xPU0UoZmQpOworCisJU0FGRV9SRU5BTUUoRklMRTEsIEZJTEUyKTsKKworCWV2ZW50
X3NldFtjb3VudF0ubWFzayA9IEZBTl9BVFRSSUIgfCBGQU5fREVMRVRFX1NFTEY7CisJZXZlbnRf
c2V0W2NvdW50XS5oYW5kbGUuaGFuZGxlX2J5dGVzID0gTUFYX0hBTkRMRV9TWjsKKwlmYW5vdGlm
eV9nZXRfZmlkKEZJTEUyLCAmZXZlbnRfc2V0W2NvdW50XS5mc2lkLAorCQkJICZldmVudF9zZXRb
Y291bnRdLmhhbmRsZSk7CisJY291bnQrKzsKKworCVNBRkVfVU5MSU5LKEZJTEUyKTsKKworCS8q
CisJICogR2VuZXJhdGUgYSBzZXF1ZW5jZSBvZiBldmVudHMgb24gYSBkaXJlY3RvcnkuIFN1YnNl
cXVlbnQgZXZlbnRzCisJICogYXJlIG1lcmdlZCwgc28gaXQncyByZXF1aXJlZCB0aGF0IHdlIHNl
dCBGQU5fT05ESVIgb25jZSBpbgorCSAqIG9yZGVyIHRvIGFja25vd2xlZGdlIHRoYXQgY2hhbmdl
cyByZWxhdGVkIHRvIGEgc3ViZGlyZWN0b3J5CisJICogdG9vayBwbGFjZS4gRXZlbnRzIG9uIHN1
YmRpcmVjdG9yaWVzIGFyZSBub3QgbWVyZ2VkIHdpdGggZXZlbnRzCisJICogb24gbm9uLXN1YmRp
cmVjdG9yaWVzLgorCSAqLworCWV2ZW50X3NldFtjb3VudF0ubWFzayA9IEZBTl9PTkRJUiB8IEZB
Tl9DUkVBVEUgfCBGQU5fTU9WRURfRlJPTSB8IFwKKwkJCQlGQU5fTU9WRURfVE8gfCBGQU5fREVM
RVRFOworCWV2ZW50X3NldFtjb3VudF0uaGFuZGxlLmhhbmRsZV9ieXRlcyA9IE1BWF9IQU5ETEVf
U1o7CisJZmFub3RpZnlfZ2V0X2ZpZChURVNUX0RJUiwgJmV2ZW50X3NldFtjb3VudF0uZnNpZCwK
KwkJCSAmZXZlbnRfc2V0W2NvdW50XS5oYW5kbGUpOworCWNvdW50Kys7CisKKwlTQUZFX01LRElS
KERJUjEsIDA3NTUpOworCisJU0FGRV9SRU5BTUUoRElSMSwgRElSMik7CisKKwlldmVudF9zZXRb
Y291bnRdLm1hc2sgPSBGQU5fT05ESVIgfCBGQU5fREVMRVRFX1NFTEY7CisJZXZlbnRfc2V0W2Nv
dW50XS5oYW5kbGUuaGFuZGxlX2J5dGVzID0gTUFYX0hBTkRMRV9TWjsKKwlmYW5vdGlmeV9nZXRf
ZmlkKERJUjIsICZldmVudF9zZXRbY291bnRdLmZzaWQsCisJCQkgJmV2ZW50X3NldFtjb3VudF0u
aGFuZGxlKTsKKwljb3VudCsrOworCisJU0FGRV9STURJUihESVIyKTsKKworCS8qIFJlYWQgZXZl
bnRzIGZyb20gdGhlIGV2ZW50IHF1ZXVlICovCisJbGVuID0gU0FGRV9SRUFEKDAsIGZhbm90aWZ5
X2ZkLCBldmVudHNfYnVmLCBCVUZfU0laRSk7CisKKwkvKiBQcm9jZXNzIGVhY2ggZXZlbnQgaW4g
YnVmZmVyICovCisJZm9yIChpID0gMCwgbWV0YWRhdGEgPSAoc3RydWN0IGZhbm90aWZ5X2V2ZW50
X21ldGFkYXRhICopIGV2ZW50c19idWY7CisJCUZBTl9FVkVOVF9PSyhtZXRhZGF0YSwgbGVuKTsK
KwkJbWV0YWRhdGEgPSBGQU5fRVZFTlRfTkVYVChtZXRhZGF0YSxsZW4pLCBpKyspIHsKKwkJZXZl
bnRfZmlkID0gKHN0cnVjdCBmYW5vdGlmeV9ldmVudF9pbmZvX2ZpZCAqKSAobWV0YWRhdGEgKyAx
KTsKKwkJZXZlbnRfZmlsZV9oYW5kbGUgPSAoc3RydWN0IGZpbGVfaGFuZGxlICopIGV2ZW50X2Zp
ZC0+aGFuZGxlOworCisJCWlmIChpID49IGNvdW50KSB7CisJCQl0c3RfcmVzKFRGQUlMLAorCQkJ
CSJnb3QgdW5uZWNlc3NhcnkgZXZlbnQ6IG1hc2s9JWxseCAiCisJCQkJInBpZD0ldSBmZD0lZCIs
CisJCQkJKHVuc2lnbmVkIGxvbmcgbG9uZykgbWV0YWRhdGEtPm1hc2ssCisJCQkJbWV0YWRhdGEt
PnBpZCwKKwkJCQltZXRhZGF0YS0+ZmQpOworCQkJbWV0YWRhdGEtPm1hc2sgPSAwOworCQl9IGVs
c2UgaWYgKG1ldGFkYXRhLT5mZCAhPSBGQU5fTk9GRCkgeworCQkJdHN0X3JlcyhURkFJTCwKKwkJ
CQkiUmVjZWl2ZWQgdW5leHBlY3RlZCBmaWxlIGRlc2NyaXB0b3IgJWQgaW4gIgorCQkJCSJldmVu
dC4gRXhwZWN0ZWQgdG8gZ2V0IEZBTl9OT0ZEKCVkKSIsCisJCQkJbWV0YWRhdGEtPmZkLCBGQU5f
Tk9GRCk7CisJCX0gZWxzZSBpZiAobWV0YWRhdGEtPm1hc2sgIT0gZXZlbnRfc2V0W2ldLm1hc2sp
IHsKKwkJCXRzdF9yZXMoVEZBSUwsCisJCQkJIkdvdCBldmVudDogbWFzaz0lbGx4IChleHBlY3Rl
ZCAlbGx4KSAiCisJCQkJInBpZD0ldSBmZD0lZCIsCisJCQkJKHVuc2lnbmVkIGxvbmcgbG9uZykg
bWV0YWRhdGEtPm1hc2ssCisJCQkJZXZlbnRfc2V0W2ldLm1hc2ssCisJCQkJKHVuc2lnbmVkKSBt
ZXRhZGF0YS0+cGlkLAorCQkJCW1ldGFkYXRhLT5mZCk7CisJCX0gZWxzZSBpZiAobWV0YWRhdGEt
PnBpZCAhPSBnZXRwaWQoKSkgeworCQkJdHN0X3JlcyhURkFJTCwKKwkJCQkiR290IGV2ZW50OiBt
YXNrPSVsbHggcGlkPSV1ICIKKwkJCQkiKGV4cGVjdGVkICV1KSBmZD0lZCIsCisJCQkJKHVuc2ln
bmVkIGxvbmcgbG9uZykgbWV0YWRhdGEtPm1hc2ssCisJCQkJKHVuc2lnbmVkKSBtZXRhZGF0YS0+
cGlkLAorCQkJCSh1bnNpZ25lZCkgZ2V0cGlkKCksCisJCQkJbWV0YWRhdGEtPmZkKTsKKwkJfSBl
bHNlIGlmIChldmVudF9maWxlX2hhbmRsZS0+aGFuZGxlX2J5dGVzICE9CisJCQkJZXZlbnRfc2V0
W2ldLmhhbmRsZS5oYW5kbGVfYnl0ZXMpIHsKKwkJCXRzdF9yZXMoVEZBSUwsCisJCQkJIkdvdCBl
dmVudDogaGFuZGxlX2J5dGVzICgleCkgcmV0dXJuZWQgaW4gIgorCQkJCSJldmVudCBkb2VzIG5v
dCBlcXVhbCBoYW5kbGVfYnl0ZXMgKCV4KSAiCisJCQkJInJldHVucmVkIGluIG5hbWVfdG9faGFu
ZGxlX2F0KDIpIiwKKwkJCQlldmVudF9maWxlX2hhbmRsZS0+aGFuZGxlX2J5dGVzLAorCQkJCWV2
ZW50X3NldFtpXS5oYW5kbGUuaGFuZGxlX2J5dGVzKTsKKwkJfSBlbHNlIGlmIChldmVudF9maWxl
X2hhbmRsZS0+aGFuZGxlX3R5cGUgIT0KKwkJCQlldmVudF9zZXRbaV0uaGFuZGxlLmhhbmRsZV90
eXBlKSB7CisJCQl0c3RfcmVzKFRGQUlMLAorCQkJCSJoYW5kbGVfdHlwZSAoJXgpIHJldHVybmVk
IGluIGV2ZW50IGRvZXMgbm90ICIKKwkJCQkiZXF1YWwgdG8gaGFuZGxlX3R5cGUgKCV4KSByZXR1
cm5lZCBpbiAiCisJCQkJIm5hbWVfdG9faGFuZGxlX2F0KDIpIiwKKwkJCQlldmVudF9maWxlX2hh
bmRsZS0+aGFuZGxlX3R5cGUsCisJCQkJZXZlbnRfc2V0W2ldLmhhbmRsZS5oYW5kbGVfdHlwZSk7
CisJCX0gZWxzZSBpZiAobWVtY21wKGV2ZW50X2ZpbGVfaGFuZGxlLT5mX2hhbmRsZSwKKwkJCQkJ
ZXZlbnRfc2V0W2ldLmhhbmRsZS5mX2hhbmRsZSwKKwkJCQkJZXZlbnRfc2V0W2ldLmhhbmRsZS5o
YW5kbGVfYnl0ZXMpCisJCQkJCSE9IDApIHsKKwkJCXRzdF9yZXMoVEZBSUwsCisJCQkJImV2ZW50
X2ZpbGVfaGFuZGxlLT5mX2hhbmRsZSBkb2VzIG5vdCBtYXRjaCAiCisJCQkJImhhbmRsZS5mX2hh
bmRsZSByZXR1cm5lZCBpbiAiCisJCQkJIm5hbWVfdG9faGFuZGxlX2F0KDIpIik7CisJCX0gZWxz
ZSBpZiAobWVtY21wKCZldmVudF9maWQtPmZzaWQsICZldmVudF9zZXRbaV0uZnNpZCwKKwkJCQkJ
c2l6ZW9mKGV2ZW50X3NldFtpXS5mc2lkKSkgIT0gMCkgeworCQkJdHN0X3JlcyhURkFJTCwKKwkJ
CQkiZXZlbnRfZmlkLT5mc2lkICE9IHN0YXRzLmZfZnNpZCB0aGF0IHdhcyAiCisJCQkJIm9idGFp
bmVkIHZpYSBzdGF0ZnMoMikiKTsKKwkJfSBlbHNlIHsKKwkJCXRzdF9yZXMoVFBBU1MsCisJCQkJ
IkdvdCBldmVudDogbWFzaz0lbGx4LCBwaWQ9JXUsICIKKwkJCQkiZmlkPSV4LiV4LiVseCB2YWx1
ZXMiLAorCQkJCW1ldGFkYXRhLT5tYXNrLAorCQkJCWdldHBpZCgpLAorCQkJCWV2ZW50X2ZpZC0+
ZnNpZC52YWxbMF0sCisJCQkJZXZlbnRfZmlkLT5mc2lkLnZhbFsxXSwKKwkJCQkqKHVuc2lnbmVk
IGxvbmcgKikKKwkJCQlldmVudF9maWxlX2hhbmRsZS0+Zl9oYW5kbGUpOworCQl9CisJfQorCisJ
Zm9yICg7IGkgPCBjb3VudDsgaSsrKQorCQl0c3RfcmVzKFRGQUlMLAorCQkJIkRpZG4ndCByZWNl
aXZlIGV2ZW50OiBtYXNrPSVsbHgiLAorCQkJZXZlbnRfc2V0W2ldLm1hc2spOworfQorCitzdGF0
aWMgdm9pZCBkb19zZXR1cCh2b2lkKQoreworCWludCBmZDsKKworCS8qIENoZWNrIGtlcm5lbCBm
b3IgZmFub3RpZnkgc3VwcG9ydCAqLworCWZkID0gU0FGRV9GQU5PVElGWV9JTklUKEZBTl9DTEFT
U19OT1RJRiwgT19SRE9OTFkpOworCVNBRkVfQ0xPU0UoZmQpOworCisJZmFub3RpZnlfZmQgPSBm
YW5vdGlmeV9pbml0KEZBTl9SRVBPUlRfRklELCBPX1JET05MWSk7CisJaWYgKGZhbm90aWZ5X2Zk
ID09IC0xKSB7CisJCWlmIChlcnJubyA9PSBFSU5WQUwpCisJCQl0c3RfYnJrKFRDT05GLAorCQkJ
CSJGQU5fUkVQT1JUX0ZJRCBub3Qgc3VwcG9ydGVkIGluIGtlcm5lbCIpOworCQl0c3RfYnJrKFRC
Uk9LIHwgVEVSUk5PLAorCQkJImZhbm90aWZ5X2luaXQoRkFOX1JFUE9SVF9GSUQsIE9fUkRPTkxZ
KSBmYWlsZWQiKTsKKwl9CisKKwlTQUZFX01LRElSKFRFU1RfRElSLCAwNzU1KTsKK30KKworc3Rh
dGljIHZvaWQgZG9fY2xlYW51cCh2b2lkKQoreworCWlmIChmYW5vdGlmeV9mZCA+IDApCisJCVNB
RkVfQ0xPU0UoZmFub3RpZnlfZmQpOworfQorCitzdGF0aWMgc3RydWN0IHRzdF90ZXN0IHRlc3Qg
PSB7CisJLm5lZWRzX3Jvb3QgPSAxLAorCS5uZWVkc190bXBkaXIgPSAxLAorCS5tb3VudF9kZXZp
Y2UgPSAxLAorCS5tbnRwb2ludCA9IE1PVU5UX1BPSU5ULAorCS5hbGxfZmlsZXN5c3RlbXMgPSAx
LAorCS50ZXN0X2FsbCA9IGRvX3Rlc3QsCisJLnNldHVwID0gZG9fc2V0dXAsCisJLmNsZWFudXAg
PSBkb19jbGVhbnVwCit9OworCisjZWxzZQorCVRTVF9URVNUX1RDT05GKCJTeXN0ZW0gZG9lcyBu
b3QgaGF2ZSByZXF1aXJlZCBmYW5vdGlmeSBzdXBwb3J0Iik7CisjZW5kaWYKLS0gCjIuMTYuNAoK
Ci0tIApNYXR0aGV3IEJvYnJvd3NraQoKLS0gCk1haWxpbmcgbGlzdCBpbmZvOiBodHRwczovL2xp
c3RzLmxpbnV4Lml0L2xpc3RpbmZvL2x0cAo=
