Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [213.254.12.146])
	by mail.lfdr.de (Postfix) with ESMTPS id 7F113AB55D8
	for <lists+linux-ltp@lfdr.de>; Tue, 13 May 2025 15:20:20 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/simple; d=lists.linux.it;
 i=@lists.linux.it; q=dns/txt; s=picard; t=1747142420; h=mime-version :
 references : in-reply-to : date : message-id : to : subject : list-id
 : list-unsubscribe : list-archive : list-post : list-help :
 list-subscribe : from : reply-to : cc : content-type :
 content-transfer-encoding : sender : from;
 bh=x7bNf/nBgPWDC0Mt1iJS+Qfi+wCVquOUr7ricvbqa6k=;
 b=fqEiaV7WU4IuOmttqJkHDKJ7EMJ9T8M3km7rRUN/eSI7cPXGmxVGQ3vTN/fHVub2cGXo8
 YV+0wK9S18EY6xCpEZyHbXlNIl+X8HHWKqbSx+PArBmXoY3Obx9sPwhnjAJy+fPDbbgdv7T
 8RPj72Dn2QCsagsCGP/FLj7/Fd0EKO4=
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id 3C2D33CC338
	for <lists+linux-ltp@lfdr.de>; Tue, 13 May 2025 15:20:20 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-4.smtp.seeweb.it (in-4.smtp.seeweb.it [217.194.8.4])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (secp384r1))
 (No client certificate requested)
 by picard.linux.it (Postfix) with ESMTPS id 219CB3CC329
 for <ltp@lists.linux.it>; Tue, 13 May 2025 15:20:06 +0200 (CEST)
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.133.124])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
 (No client certificate requested)
 by in-4.smtp.seeweb.it (Postfix) with ESMTPS id 9C0601000A49
 for <ltp@lists.linux.it>; Tue, 13 May 2025 15:20:04 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1747142403;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 content-transfer-encoding:content-transfer-encoding:
 in-reply-to:in-reply-to:references:references;
 bh=eLcEYiWrKX5R8ZfBVIMHxtUVgtQuYQdyfA9v9JU9do0=;
 b=dWzhDkZY47KX6zfsifngAJ5Rjpojq1vpNpouKqNH8whg6wo4o0K+3FlQmtlmrwYTZWNVqd
 3yXKgqte+lNaaKxR8trrTCgn/IKYRKlh7+R1ebUAQq6ihXK9bwb4drhFQx5+KP/4kNgocp
 d7/4hjaH3qU800RCGo7jSmYHWnE2Ark=
Received: from mail-pl1-f199.google.com (mail-pl1-f199.google.com
 [209.85.214.199]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-318-j74UVbU2OyqYpT_7UhlC8A-1; Tue, 13 May 2025 09:20:01 -0400
X-MC-Unique: j74UVbU2OyqYpT_7UhlC8A-1
X-Mimecast-MFC-AGG-ID: j74UVbU2OyqYpT_7UhlC8A_1747142401
Received: by mail-pl1-f199.google.com with SMTP id
 d9443c01a7336-22e7f041997so87201185ad.3
 for <ltp@lists.linux.it>; Tue, 13 May 2025 06:20:01 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1747142400; x=1747747200;
 h=content-transfer-encoding:cc:to:subject:message-id:date:from
 :in-reply-to:references:mime-version:x-gm-message-state:from:to:cc
 :subject:date:message-id:reply-to;
 bh=eLcEYiWrKX5R8ZfBVIMHxtUVgtQuYQdyfA9v9JU9do0=;
 b=Je9t0nGhZuo+QJv8NRY2HwJ4lu6a+LHQ1+6P6esEBs8hXjNzDII7asISOgLb+op90/
 QtjkFYkCw35tmEN5F6oZ+uTqKFBaYhfUH4kQtdQSSSEqj0hhOsnlZ2/T/HmPrLxM5Lf6
 ZIeX1GMg6eSkWTFzhIenxp3m20+KBjJ5OWRy/ti/vP4Wa7ZiX/7Fom1vmRsDuMk+KETv
 SfVQAQkBtGC9N8ydoPwyF5VkrE1CnAAtKulgIw3APVpgZoNDw8i2IAIWSV7ZDXbPh8T0
 ohYmbrlycpoUItbXr59Q6weMPLLZnLcxLrFJrEgWCMW3uzLfPe+RDbB1OxcnGvCoz6Tz
 IWAg==
X-Gm-Message-State: AOJu0YwW6/oJRNh24ryhpLGh+iDrZE+Nr7du6S2xPu3UX0zEQ+LLsXD7
 j5kMUtcojfPU9AlNIXwDvlJ+7jkFp7A7TOcOqy/bfZyHTZzOt3bVMss1DaFGqOYnVgkrUgyY4s8
 BYOdxMnwWxkSII0rxBL1s0PqRAdIgejOwuqJN7Ab/7rdyXHJ7+u3sCACbUsUx7URZCqFYZfK1vO
 SkQDQCZIk6Oja8owogh2rUJWENuIqxErtSiw==
X-Gm-Gg: ASbGncujVCAnaVQgWN98gWECdxEmYiTQWhczYU3L/78NTGxvGYG1pvBxtTduk3MFg6l
 x/i1koQ6a7x9LBTvu3f5w9jFG0XnyV9K4wPW9uP6Ki5oDjLrmfb3hYYhXiOfxcHLo4tnWxA==
X-Received: by 2002:a17:903:3bc7:b0:22f:a5ff:ec67 with SMTP id
 d9443c01a7336-22fc8b3399cmr229263595ad.17.1747142399332; 
 Tue, 13 May 2025 06:19:59 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IFlOZGHeGMC86NcIMQYrCKatceCHa5Of3zdvGaRa8b199t1rCnzbzN2wXr+5siB1pYd/b6PNMWJ6KlNeeu5E/k=
X-Received: by 2002:a17:903:3bc7:b0:22f:a5ff:ec67 with SMTP id
 d9443c01a7336-22fc8b3399cmr229262985ad.17.1747142398632; Tue, 13 May 2025
 06:19:58 -0700 (PDT)
MIME-Version: 1.0
References: <20250513065515.49865-1-liwang@redhat.com>
 <20250513065515.49865-3-liwang@redhat.com>
In-Reply-To: <20250513065515.49865-3-liwang@redhat.com>
Date: Tue, 13 May 2025 21:19:45 +0800
X-Gm-Features: AX0GCFvJ6M5Ib7XNxeUz3oyTBSJO4xYC0CtGCTPIZQD_Y3zx7lyA3UTpM2WTci8
Message-ID: <CAEemH2f-B1_09UO5J4No9ggCN0seZWZbngj16nTu5h904NC7wA@mail.gmail.com>
To: Li Wang <liwang@redhat.com>
X-Mimecast-Spam-Score: 0
X-Mimecast-MFC-PROC-ID: 5B1insIidETx5VivGhrW-lknZkN5KNWgo0OqdaVGT08_1747142401
X-Mimecast-Originator: redhat.com
X-Spam-Status: No, score=0.1 required=7.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,DKIM_VALID_EF,SPF_HELO_NONE,SPF_PASS shortcircuit=no
 autolearn=disabled version=4.0.1
X-Spam-Checker-Version: SpamAssassin 4.0.1 (2024-03-25) on in-4.smtp.seeweb.it
X-Virus-Scanned: clamav-milter 1.0.7 at in-4.smtp.seeweb.it
X-Virus-Status: Clean
Subject: Re: [LTP] [PATCH RFC 2/2] lib: moves test infrastructure states
 into a shared context structure
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
From: Li Wang via ltp <ltp@lists.linux.it>
Reply-To: Li Wang <liwang@redhat.com>
Cc: ltp@lists.linux.it
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

T24gVHVlLCBNYXkgMTMsIDIwMjUgYXQgMjo1NuKAr1BNIExpIFdhbmcgdmlhIGx0cCA8bHRwQGxp
c3RzLmxpbnV4Lml0PiB3cm90ZToKPgo+IFRoaXMgcGF0Y2ggaW50cm9kdWNlcyBhIG5ldyBzdHJ1
Y3QgY29udGV4dCB0byBjb25zb2xpZGF0ZSB2YXJpb3VzCj4gcnVudGltZSBzdGF0ZSB2YXJpYWJs
ZXMgcHJldmlvdXNseSBtYWludGFpbmVkIGFzIGdsb2JhbCB2YXJpYWJsZXMKPiBpbiB0c3RfdGVz
dC5jLiBUaGUgZ29hbCBpcyB0byBzdXBwb3J0IGJldHRlciBzdGF0ZSBzaGFyaW5nIGJldHdlZW4K
PiBwYXJlbnQgYW5kIGNoaWxkIHByb2Nlc3NlcyBwYXJ0aWN1bGFybHkgaW4gc2NlbmFyaW9zIHRo
YXQgaW52b2x2ZQo+IGNoZWNrcG9pbnRpbmcgb3IgZm9yay9leGVjIHBhdHRlcm5zLgo+Cj4gVG8g
YWNoaWV2ZSB0aGlzLCBhIG5ldyBzdHJ1Y3QgaXBjX3JlZ2lvbiBpcyBkZWZpbmVkLCB3aGljaCBl
bmNhcHN1bGF0ZXMKPiB0aHJlZSBjb21wb25lbnRzOiBhIG1hZ2ljIGZpZWxkIGZvciB2YWxpZGF0
aW9uLCBhIGNvbnRleHQgc3RydWN0dXJlIGZvcgo+IHJ1bnRpbWUgbWV0YWRhdGEsIGFuZCBhIHJl
c3VsdHMgc3RydWN0dXJlIGZvciB0ZXN0IHJlc3VsdCBjb3VudGVycy4KPgo+IFRlc3QgbGlicmFy
eSBJUEMgcmVnaW9uIChvbmx5IG9uZSBwYWdlIHNpemUpOgo+Cj4gICAgICAgICArLS0tLS0tLS0t
LS0tLS0tLS0tLS0tLSsKPiAgICAgICAgIHwgICBNYWdpYyBOdW1iZXIgICAgICAgfAo+ICAgICAg
ICAgKy0tLS0tLS0tLS0tLS0tLS0tLS0tLS0rCj4gICAgICAgICB8ICAgc3RydWN0IGNvbnRleHQg
ICAgIHwKPiAgICAgICAgICstLS0tLS0tLS0tLS0tLS0tLS0tLS0tKwo+ICAgICAgICAgfCAgIHN0
cnVjdCByZXN1bHRzICAgICB8Cj4gICAgICAgICArLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSsKPiAg
ICAgICAgIHwgICBmdXRleGVzW10sIG9yIE4vQSAgfAo+ICAgICAgICAgKy0tLS0tLS0tLS0tLS0t
LS0tLS0tLS0rCj4KPiBPcHRpb25hbGx5LCBhIGZ1dGV4IGFycmF5IGlzIGFwcGVuZGVkIGZvciB0
ZXN0IGNoZWNrcG9pbnQgc3luY2hyb25pemF0aW9uLgo+Cj4gVGhlIHBhdGNoIG1vZGlmaWVzIHNl
dHVwX2lwYygpIGFuZCB0c3RfcmVpbml0KCkgdG8gYWxsb2NhdGUgYW5kIG1hcCB0aGUKPiBzaGFy
ZWQgbWVtb3J5IHJlZ2lvbiB0aGF0IGhvbGRzIHRoZSBpcGNfcmVnaW9uLCBlbnN1cmluZyB0aGF0
IGNvbnRleHQsCj4gcmVzdWx0cywgYW5kIGZ1dGV4ZXMgcG9pbnRlcnMgYXJlIGNvcnJlY3RseSBp
bml0aWFsaXplZC4KPgo+IE92ZXJhbGwsIHRoaXMgcmVmYWN0b3IgcmVkdWNlcyBnbG9iYWwgc3Rh
dGUgcG9sbHV0aW9uLCBjZW50cmFsaXplcyB0aGUKPiBydW50aW1lIHN0YXRlIG1hbmFnZW1lbnQs
IGFuZCBlbmFibGVzIHNhZmUgYW5kIGVmZmljaWVudCBzdGF0ZSBzaGFyaW5nCj4gYWNyb3NzIHRl
c3QgbGlmZWN5Y2xlIHBoYXNlcy4gSXQgYWxzbyBzZXRzIHRoZSBmb3VuZGF0aW9uIGZvciBmdXR1
cmUKPiBpbXByb3ZlbWVudHMgc3VjaCBhcyBtdWx0aS10aHJlYWRlZCB0ZXN0IGNvb3JkaW5hdGlv
biBvciBlbmhhbmNlZCBJUEMKPiBtZWNoYW5pc21zLgo+Cj4gU2lnbmVkLW9mZi1ieTogTGkgV2Fu
ZyA8bGl3YW5nQHJlZGhhdC5jb20+Cj4gLS0tCj4gIGxpYi90c3RfdGVzdC5jIHwgMjM3ICsrKysr
KysrKysrKysrKysrKysrKysrKysrKystLS0tLS0tLS0tLS0tLS0tLS0tLS0KPiAgMSBmaWxlIGNo
YW5nZWQsIDEzNiBpbnNlcnRpb25zKCspLCAxMDEgZGVsZXRpb25zKC0pCj4KPiBkaWZmIC0tZ2l0
IGEvbGliL3RzdF90ZXN0LmMgYi9saWIvdHN0X3Rlc3QuYwo+IGluZGV4IGZiYmZkYTQyNi4uMTIy
Y2VjMTM1IDEwMDY0NAo+IC0tLSBhL2xpYi90c3RfdGVzdC5jCj4gKysrIGIvbGliL3RzdF90ZXN0
LmMKPiBAQCAtNTIsNiArNTIsNyBAQCBjb25zdCBjaGFyICpUQ0lEIF9fYXR0cmlidXRlX18oKHdl
YWspKTsKPiAgI2RlZmluZSBDVkVfREJfVVJMICJodHRwczovL2N2ZS5taXRyZS5vcmcvY2dpLWJp
bi9jdmVuYW1lLmNnaT9uYW1lPUNWRS0iCj4KPiAgI2RlZmluZSBERUZBVUxUX1RJTUVPVVQgMzAK
PiArI2RlZmluZSBMVFBfTUFHSUMgMHg0QzU0NTA0RCAvKiBNYWdpYyBudW1iZXIgaXMgIkxUUE0i
ICovCj4KPiAgc3RydWN0IHRzdF90ZXN0ICp0c3RfdGVzdDsKPgo+IEBAIC01OSwzNSArNjAsNDYg
QEAgc3RhdGljIGNvbnN0IGNoYXIgKnRjaWQ7Cj4gIHN0YXRpYyBpbnQgaXRlcmF0aW9ucyA9IDE7
Cj4gIHN0YXRpYyBmbG9hdCBkdXJhdGlvbiA9IC0xOwo+ICBzdGF0aWMgZmxvYXQgdGltZW91dF9t
dWwgPSAtMTsKPiAtc3RhdGljIGludCBtbnRwb2ludF9tb3VudGVkOwo+IC1zdGF0aWMgaW50IG92
bF9tb3VudGVkOwo+IC1zdGF0aWMgc3RydWN0IHRpbWVzcGVjIHRzdF9zdGFydF90aW1lOyAvKiB2
YWxpZCBvbmx5IGZvciB0ZXN0IHBpZCAqLwo+IC1zdGF0aWMgaW50IHRkZWJ1ZzsKPgo+IC1zdHJ1
Y3QgcmVzdWx0cyB7Cj4gLSAgICAgICBpbnQgcGFzc2VkOwo+IC0gICAgICAgaW50IHNraXBwZWQ7
Cj4gLSAgICAgICBpbnQgZmFpbGVkOwo+IC0gICAgICAgaW50IHdhcm5pbmdzOwo+IC0gICAgICAg
aW50IGJyb2tlbjsKPiArc3RydWN0IGNvbnRleHQgewo+ICsgICAgICAgcGlkX3QgbGliX3BpZDsK
PiArICAgICAgIHBpZF90IG1haW5fcGlkOwo+ICsgICAgICAgc3RydWN0IHRpbWVzcGVjIHN0YXJ0
X3RpbWU7Cj4gKyAgICAgICB1aW50MzJfdCBydW50aW1lOwo+ICsgICAgICAgdWludDMyX3Qgb3Zl
cmFsbF90aW1lOwo+ICAgICAgICAgLyoKPiAgICAgICAgICAqIFRoaXMgaXMgc2V0IGJ5IGEgY2Fs
bCB0byB0c3RfYnJrKCkgd2l0aCBUQlJPSyBwYXJhbWV0ZXIgYW5kIG1lYW5zCj4gICAgICAgICAg
KiB0aGF0IHRoZSB0ZXN0IHNob3VsZCBleGl0IGltbWVkaWF0ZWx5Lgo+ICAgICAgICAgICovCj4g
LSAgICAgICBpbnQgYWJvcnRfZmxhZzsKPiAtICAgICAgIHVuc2lnbmVkIGludCBydW50aW1lOwo+
IC0gICAgICAgdW5zaWduZWQgaW50IG92ZXJhbGxfdGltZTsKPiAtICAgICAgIHBpZF90IGxpYl9w
aWQ7Cj4gLSAgICAgICBwaWRfdCBtYWluX3BpZDsKPiArICAgICAgIHVpbnQzMl90IGFib3J0X2Zs
YWc7Cj4gKyAgICAgICB1aW50MzJfdCBtbnRwb2ludF9tb3VudGVkOjE7Cj4gKyAgICAgICB1aW50
MzJfdCBvdmxfbW91bnRlZDoxOwo+ICsgICAgICAgdWludDMyX3QgdGRlYnVnOjE7Cj4gIH07Cj4K
PiAtc3RhdGljIHN0cnVjdCByZXN1bHRzICpyZXN1bHRzOwo+ICtzdHJ1Y3QgcmVzdWx0cyB7Cj4g
KyAgICAgICB1aW50MzJfdCBwYXNzZWQ7Cj4gKyAgICAgICB1aW50MzJfdCBza2lwcGVkOwo+ICsg
ICAgICAgdWludDMyX3QgZmFpbGVkOwo+ICsgICAgICAgdWludDMyX3Qgd2FybmluZ3M7Cj4gKyAg
ICAgICB1aW50MzJfdCBicm9rZW47Cj4gK307Cj4KPiAtc3RhdGljIGludCBpcGNfZmQ7Cj4gK3N0
cnVjdCBpcGNfcmVnaW9uIHsKPiArICAgICAgIHVpbnQzMl90IG1hZ2ljOwo+ICsgICAgICAgc3Ry
dWN0IGNvbnRleHQgY29udGV4dDsKPiArICAgICAgIHN0cnVjdCByZXN1bHRzIHJlc3VsdHM7Cj4g
KyAgICAgICBmdXRleF90IGZ1dGV4ZXNbXTsKPiArfTsKPgo+IC1leHRlcm4gdm9pZCAqdHN0X2Z1
dGV4ZXM7Cj4gK3N0YXRpYyBzdHJ1Y3QgaXBjX3JlZ2lvbiAqaXBjOwo+ICtzdGF0aWMgc3RydWN0
IGNvbnRleHQgKmNvbnRleHQ7Cj4gK3N0YXRpYyBzdHJ1Y3QgcmVzdWx0cyAqcmVzdWx0czsKPiAr
Cj4gK2V4dGVybiB2b2xhdGlsZSB2b2lkICp0c3RfZnV0ZXhlczsKPiAgZXh0ZXJuIHVuc2lnbmVk
IGludCB0c3RfbWF4X2Z1dGV4ZXM7Cj4KPiArc3RhdGljIGludCBpcGNfZmQ7Cj4gIHN0YXRpYyBj
aGFyIGlwY19wYXRoWzEwNjRdOwo+ICBjb25zdCBjaGFyICp0c3RfaXBjX3BhdGggPSBpcGNfcGF0
aDsKPgo+IEBAIC0xMDIsNyArMTE0LDcgQEAgc3RhdGljIHZvaWQgZG9fZXhpdChpbnQgcmV0KSBf
X2F0dHJpYnV0ZV9fICgobm9yZXR1cm4pKTsKPgo+ICBzdGF0aWMgdm9pZCBzZXR1cF9pcGModm9p
ZCkKPiAgewo+IC0gICAgICAgc2l6ZV90IHNpemUgPSBnZXRwYWdlc2l6ZSgpOwo+ICsgICAgICAg
c2l6ZV90IHBhZ2Vfc2l6ZSA9IGdldHBhZ2VzaXplKCk7Cj4KPiAgICAgICAgIGlmIChhY2Nlc3Mo
Ii9kZXYvc2htIiwgRl9PSykgPT0gMCkgewo+ICAgICAgICAgICAgICAgICBzbnByaW50ZihzaG1f
cGF0aCwgc2l6ZW9mKHNobV9wYXRoKSwgIi9kZXYvc2htL2x0cF8lc18lZCIsCj4gQEAgLTEyNCwz
MiArMTM2LDQ0IEBAIHN0YXRpYyB2b2lkIHNldHVwX2lwYyh2b2lkKQo+ICAgICAgICAgICAgICAg
ICB0c3RfYnJrKFRCUk9LIHwgVEVSUk5PLCAib3BlbiglcykiLCBzaG1fcGF0aCk7Cj4gICAgICAg
ICBTQUZFX0NITU9EKHNobV9wYXRoLCAwNjY2KTsKPgo+IC0gICAgICAgU0FGRV9GVFJVTkNBVEUo
aXBjX2ZkLCBzaXplKTsKPiArICAgICAgIFNBRkVfRlRSVU5DQVRFKGlwY19mZCwgcGFnZV9zaXpl
KTsKPgo+IC0gICAgICAgcmVzdWx0cyA9IFNBRkVfTU1BUChOVUxMLCBzaXplLCBQUk9UX1JFQUQg
fCBQUk9UX1dSSVRFLCBNQVBfU0hBUkVELCBpcGNfZmQsIDApOwo+IC0KPiAtICAgICAgIC8qIENo
ZWNrcG9pbnRzIG5lZWRzIHRvIGJlIGFjY2Vzc2libGUgZnJvbSBwcm9jZXNzZXMgc3RhcnRlZCBi
eSBleGVjKCkgKi8KPiAtICAgICAgIGlmICh0c3RfdGVzdC0+bmVlZHNfY2hlY2twb2ludHMgfHwg
dHN0X3Rlc3QtPmNoaWxkX25lZWRzX3JlaW5pdCkgewo+IC0gICAgICAgICAgICAgICBzcHJpbnRm
KGlwY19wYXRoLCBJUENfRU5WX1ZBUiAiPSVzIiwgc2htX3BhdGgpOwo+IC0gICAgICAgICAgICAg
ICBwdXRlbnYoaXBjX3BhdGgpOwo+IC0gICAgICAgfSBlbHNlIHsKPiAtICAgICAgICAgICAgICAg
U0FGRV9VTkxJTksoc2htX3BhdGgpOwo+ICsgICAgICAgaXBjID0gbW1hcChOVUxMLCBwYWdlX3Np
emUsIFBST1RfUkVBRCB8IFBST1RfV1JJVEUsIE1BUF9TSEFSRUQsIGlwY19mZCwgMCk7Cj4gKyAg
ICAgICBpZiAoaXBjID09IE1BUF9GQUlMRUQpIHsKPiArICAgICAgICAgICAgICAgZnByaW50Zihz
dGRlcnIsICJtbWFwIGZhaWxlZCBpbiBlYXJseSBzZXR1cDogJXNcbiIsIHN0cmVycm9yKGVycm5v
KSk7Cj4gKyAgICAgICAgICAgICAgIGNsb3NlKGlwY19mZCk7Cj4gKyAgICAgICAgICAgICAgIGRv
X2V4aXQoMSk7Cj4gICAgICAgICB9Cj4KPiAgICAgICAgIFNBRkVfQ0xPU0UoaXBjX2ZkKTsKCkF0
IGhlcmUgZG8gbWVtc2V0IHplcm8gbWlnaHQgYmUgYmV0dGVyIHRoYW4ganVzdCBpbml0aWFsaXpp
bmcgcGlkcy4KCi0tLSBhL2xpYi90c3RfdGVzdC5jCisrKyBiL2xpYi90c3RfdGVzdC5jCkBAIC0x
NDcsNiArMTQ3LDggQEAgc3RhdGljIHZvaWQgc2V0dXBfaXBjKHZvaWQpCgogICAgICAgIFNBRkVf
Q0xPU0UoaXBjX2ZkKTsKCisgICAgICAgbWVtc2V0KGlwYywgMCwgcGFnZV9zaXplKTsKKwogICAg
ICAgIGlwYy0+bWFnaWMgPSBMVFBfTUFHSUM7CiAgICAgICAgY29udGV4dCA9ICZpcGMtPmNvbnRl
eHQ7CiAgICAgICAgcmVzdWx0cyA9ICZpcGMtPnJlc3VsdHM7CkBAIC0xNTksOSArMTYxLDYgQEAg
c3RhdGljIHZvaWQgc2V0dXBfaXBjKHZvaWQpCgogICAgICAgIH0KCi0gICAgICAgY29udGV4dC0+
bGliX3BpZCA9IDA7Ci0gICAgICAgY29udGV4dC0+bWFpbl9waWQgPSAwOwotCiAgICAgICAgLyog
U2V0IGVudmlyb25tZW50IHZhcmlhYmxlIGZvciBleGVjKCknZCBjaGlsZHJlbiAqLwogICAgICAg
IGlmICh0c3RfdGVzdC0+bmVlZHNfY2hlY2twb2ludHMgfHwgdHN0X3Rlc3QtPmNoaWxkX25lZWRz
X3JlaW5pdCkgewogICAgICAgICAgICAgICAgc25wcmludGYoaXBjX3BhdGgsIHNpemVvZihpcGNf
cGF0aCksIElQQ19FTlZfVkFSCiI9JXMiLCBzaG1fcGF0aCk7CgoKPgo+ICsgICAgICAgaXBjLT5t
YWdpYyA9IExUUF9NQUdJQzsKPiArICAgICAgIGNvbnRleHQgPSAmaXBjLT5jb250ZXh0Owo+ICsg
ICAgICAgcmVzdWx0cyA9ICZpcGMtPnJlc3VsdHM7Cj4gKwo+ICAgICAgICAgaWYgKHRzdF90ZXN0
LT5uZWVkc19jaGVja3BvaW50cykgewo+IC0gICAgICAgICAgICAgICB0c3RfZnV0ZXhlcyA9IChj
aGFyICopcmVzdWx0cyArIHNpemVvZihzdHJ1Y3QgcmVzdWx0cyk7Cj4gLSAgICAgICAgICAgICAg
IHRzdF9tYXhfZnV0ZXhlcyA9IChzaXplIC0gc2l6ZW9mKHN0cnVjdCByZXN1bHRzKSkvc2l6ZW9m
KGZ1dGV4X3QpOwo+ICsgICAgICAgICAgICAgICB0c3RfZnV0ZXhlcyA9IGlwYy0+ZnV0ZXhlczsK
PiArCj4gKyAgICAgICAgICAgICAgIHNpemVfdCBmdXRleGVzX29mZnNldCA9IChjaGFyICopaXBj
LT5mdXRleGVzIC0gKGNoYXIgKilpcGM7Cj4gKyAgICAgICAgICAgICAgIHRzdF9tYXhfZnV0ZXhl
cyA9IChwYWdlX3NpemUgLSBmdXRleGVzX29mZnNldCkgLyBzaXplb2YoZnV0ZXhfdCk7Cj4gKwo+
ICAgICAgICAgfQo+Cj4gLSAgICAgICByZXN1bHRzLT5saWJfcGlkID0gMDsKPiAtICAgICAgIHJl
c3VsdHMtPm1haW5fcGlkID0gMDsKPiArICAgICAgIGNvbnRleHQtPmxpYl9waWQgPSAwOwo+ICsg
ICAgICAgY29udGV4dC0+bWFpbl9waWQgPSAwOwo+ICsKPiArICAgICAgIC8qIFNldCBlbnZpcm9u
bWVudCB2YXJpYWJsZSBmb3IgZXhlYygpJ2QgY2hpbGRyZW4gKi8KPiArICAgICAgIGlmICh0c3Rf
dGVzdC0+bmVlZHNfY2hlY2twb2ludHMgfHwgdHN0X3Rlc3QtPmNoaWxkX25lZWRzX3JlaW5pdCkg
ewo+ICsgICAgICAgICAgICAgICBzbnByaW50ZihpcGNfcGF0aCwgc2l6ZW9mKGlwY19wYXRoKSwg
SVBDX0VOVl9WQVIgIj0lcyIsIHNobV9wYXRoKTsKPiArICAgICAgICAgICAgICAgcHV0ZW52KGlw
Y19wYXRoKTsKPiArICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgIFNBRkVfVU5MSU5L
KHNobV9wYXRoKTsKPiArICAgICAgIH0KPiAgfQo+Cj4gIHN0YXRpYyB2b2lkIGNsZWFudXBfaXBj
KHZvaWQpCj4gIHsKPiAtICAgICAgIHNpemVfdCBzaXplID0gZ2V0cGFnZXNpemUoKTsKPiArICAg
ICAgIHNpemVfdCBwYWdlX3NpemUgPSBnZXRwYWdlc2l6ZSgpOwo+Cj4gICAgICAgICBpZiAoaXBj
X2ZkID4gMCAmJiBjbG9zZShpcGNfZmQpKQo+ICAgICAgICAgICAgICAgICB0c3RfcmVzKFRXQVJO
IHwgVEVSUk5PLCAiY2xvc2UoaXBjX2ZkKSBmYWlsZWQiKTsKPiBAQCAtMTU3LDkgKzE4MSwxMSBA
QCBzdGF0aWMgdm9pZCBjbGVhbnVwX2lwYyh2b2lkKQo+ICAgICAgICAgaWYgKHNobV9wYXRoWzBd
ICYmICFhY2Nlc3Moc2htX3BhdGgsIEZfT0spICYmIHVubGluayhzaG1fcGF0aCkpCj4gICAgICAg
ICAgICAgICAgIHRzdF9yZXMoVFdBUk4gfCBURVJSTk8sICJ1bmxpbmsoJXMpIGZhaWxlZCIsIHNo
bV9wYXRoKTsKPgo+IC0gICAgICAgaWYgKHJlc3VsdHMpIHsKPiAtICAgICAgICAgICAgICAgbXN5
bmMoKHZvaWQgKilyZXN1bHRzLCBzaXplLCBNU19TWU5DKTsKPiAtICAgICAgICAgICAgICAgbXVu
bWFwKCh2b2lkICopcmVzdWx0cywgc2l6ZSk7Cj4gKyAgICAgICBpZiAoaXBjKSB7Cj4gKyAgICAg
ICAgICAgICAgIG1zeW5jKCh2b2lkICopaXBjLCBwYWdlX3NpemUsIE1TX1NZTkMpOwo+ICsgICAg
ICAgICAgICAgICBtdW5tYXAoKHZvaWQgKilpcGMsIHBhZ2Vfc2l6ZSk7Cj4gKyAgICAgICAgICAg
ICAgIGlwYyA9IE5VTEw7Cj4gKyAgICAgICAgICAgICAgIGNvbnRleHQgPSBOVUxMOwo+ICAgICAg
ICAgICAgICAgICByZXN1bHRzID0gTlVMTDsKPiAgICAgICAgIH0KPiAgfQo+IEBAIC0xNjcsNyAr
MTkzLDcgQEAgc3RhdGljIHZvaWQgY2xlYW51cF9pcGModm9pZCkKPiAgdm9pZCB0c3RfcmVpbml0
KHZvaWQpCj4gIHsKPiAgICAgICAgIGNvbnN0IGNoYXIgKnBhdGggPSBnZXRlbnYoSVBDX0VOVl9W
QVIpOwo+IC0gICAgICAgc2l6ZV90IHNpemUgPSBnZXRwYWdlc2l6ZSgpOwo+ICsgICAgICAgc2l6
ZV90IHBhZ2Vfc2l6ZSA9IGdldHBhZ2VzaXplKCk7Cj4gICAgICAgICBpbnQgZmQ7Cj4KPiAgICAg
ICAgIGlmICghcGF0aCkKPiBAQCAtMTc3LDEyICsyMDMsMjIgQEAgdm9pZCB0c3RfcmVpbml0KHZv
aWQpCj4gICAgICAgICAgICAgICAgIHRzdF9icmsoVEJST0ssICJGaWxlICVzIGRvZXMgbm90IGV4
aXN0ISIsIHBhdGgpOwo+Cj4gICAgICAgICBmZCA9IFNBRkVfT1BFTihwYXRoLCBPX1JEV1IpOwo+
ICsgICAgICAgaXBjID0gU0FGRV9NTUFQKE5VTEwsIHBhZ2Vfc2l6ZSwgUFJPVF9SRUFEIHwgUFJP
VF9XUklURSwgTUFQX1NIQVJFRCwgZmQsIDApOwo+ICsgICAgICAgU0FGRV9DTE9TRShmZCk7Cj4K
PiAtICAgICAgIHJlc3VsdHMgPSBTQUZFX01NQVAoTlVMTCwgc2l6ZSwgUFJPVF9SRUFEIHwgUFJP
VF9XUklURSwgTUFQX1NIQVJFRCwgZmQsIDApOwo+IC0gICAgICAgdHN0X2Z1dGV4ZXMgPSAoY2hh
ciAqKXJlc3VsdHMgKyBzaXplb2Yoc3RydWN0IHJlc3VsdHMpOwo+IC0gICAgICAgdHN0X21heF9m
dXRleGVzID0gKHNpemUgLSBzaXplb2Yoc3RydWN0IHJlc3VsdHMpKS9zaXplb2YoZnV0ZXhfdCk7
Cj4gKyAgICAgICBpZiAoaXBjLT5tYWdpYyAhPSBMVFBfTUFHSUMpCj4gKyAgICAgICAgICAgICAg
IHRzdF9icmsoVEJST0ssICJJbnZhbGlkIHNoYXJlZCBtZW1vcnkgcmVnaW9uIChiYWQgbWFnaWMp
Iik7Cj4KPiAtICAgICAgIFNBRkVfQ0xPU0UoZmQpOwo+ICsgICAgICAgLyogUmVzdG9yZSB0aGUg
cGFyZW50IGNvbnRleHQgZnJvbSBJUEMgcmVnaW9uICovCj4gKyAgICAgICBjb250ZXh0ID0gJmlw
Yy0+Y29udGV4dDsKPiArICAgICAgIHJlc3VsdHMgPSAmaXBjLT5yZXN1bHRzOwo+ICsKPiArICAg
ICAgIHRzdF9mdXRleGVzID0gaXBjLT5mdXRleGVzOwo+ICsgICAgICAgc2l6ZV90IGZ1dGV4ZXNf
b2Zmc2V0ID0gKGNoYXIgKilpcGMtPmZ1dGV4ZXMgLSAoY2hhciAqKWlwYzsKPiArICAgICAgIHRz
dF9tYXhfZnV0ZXhlcyA9IChwYWdlX3NpemUgLSBmdXRleGVzX29mZnNldCkgLyBzaXplb2YoZnV0
ZXhfdCk7Cj4gKwo+ICsgICAgICAgaWYgKGNvbnRleHQtPnRkZWJ1ZykKPiArICAgICAgICAgICAg
ICAgdHN0X3JlcyhUSU5GTywgInRzdF9yZWluaXQoKTogcmVzdG9yZWQgbWV0YWRhdGEgZm9yIFBJ
RCAlZCIsIGdldHBpZCgpKTsKPiAgfQo+Cj4gIGV4dGVybiBjaGFyICoqZW52aXJvbjsKPiBAQCAt
MjM2LDE5ICsyNzIsMTkgQEAgc3RhdGljIHZvaWQgdXBkYXRlX3Jlc3VsdHMoaW50IHR0eXBlKQo+
Cj4gICAgICAgICBzd2l0Y2ggKHR0eXBlKSB7Cj4gICAgICAgICBjYXNlIFRDT05GOgo+IC0gICAg
ICAgICAgICAgICB0c3RfYXRvbWljX2luYygmcmVzdWx0cy0+c2tpcHBlZCk7Cj4gKyAgICAgICAg
ICAgICAgIHRzdF9hdG9taWNfaW5jKChpbnQgKikmcmVzdWx0cy0+c2tpcHBlZCk7Cj4gICAgICAg
ICBicmVhazsKPiAgICAgICAgIGNhc2UgVFBBU1M6Cj4gLSAgICAgICAgICAgICAgIHRzdF9hdG9t
aWNfaW5jKCZyZXN1bHRzLT5wYXNzZWQpOwo+ICsgICAgICAgICAgICAgICB0c3RfYXRvbWljX2lu
YygoaW50ICopJnJlc3VsdHMtPnBhc3NlZCk7Cj4gICAgICAgICBicmVhazsKPiAgICAgICAgIGNh
c2UgVFdBUk46Cj4gLSAgICAgICAgICAgICAgIHRzdF9hdG9taWNfaW5jKCZyZXN1bHRzLT53YXJu
aW5ncyk7Cj4gKyAgICAgICAgICAgICAgIHRzdF9hdG9taWNfaW5jKChpbnQgKikmcmVzdWx0cy0+
d2FybmluZ3MpOwo+ICAgICAgICAgYnJlYWs7Cj4gICAgICAgICBjYXNlIFRGQUlMOgo+IC0gICAg
ICAgICAgICAgICB0c3RfYXRvbWljX2luYygmcmVzdWx0cy0+ZmFpbGVkKTsKPiArICAgICAgICAg
ICAgICAgdHN0X2F0b21pY19pbmMoKGludCAqKSZyZXN1bHRzLT5mYWlsZWQpOwo+ICAgICAgICAg
YnJlYWs7Cj4gICAgICAgICBjYXNlIFRCUk9LOgo+IC0gICAgICAgICAgICAgICB0c3RfYXRvbWlj
X2luYygmcmVzdWx0cy0+YnJva2VuKTsKPiArICAgICAgICAgICAgICAgdHN0X2F0b21pY19pbmMo
KGludCAqKSZyZXN1bHRzLT5icm9rZW4pOwo+ICAgICAgICAgYnJlYWs7Cj4gICAgICAgICB9Cj4g
IH0KPiBAQCAtMzk1LDcgKzQzMSw3IEBAIHZvaWQgdHN0X3ZicmtfKGNvbnN0IGNoYXIgKmZpbGUs
IGNvbnN0IGludCBsaW5lbm8sIGludCB0dHlwZSwgY29uc3QgY2hhciAqZm10LAo+ICAgICAgICAg
ICogSWYgdHN0X2JyaygpIGlzIGNhbGxlZCBmcm9tIHNvbWUgb2YgdGhlIEMgaGVscGVycyBldmVu
IGJlZm9yZSB0aGUKPiAgICAgICAgICAqIGxpYnJhcnkgd2FzIGluaXRpYWxpemVkLCBqdXN0IGV4
aXQuCj4gICAgICAgICAgKi8KPiAtICAgICAgIGlmICghcmVzdWx0cyB8fCAhcmVzdWx0cy0+bGli
X3BpZCkKPiArICAgICAgIGlmICghY29udGV4dCB8fCAhY29udGV4dC0+bGliX3BpZCkKPiAgICAg
ICAgICAgICAgICAgZXhpdChUVFlQRV9SRVNVTFQodHR5cGUpKTsKPgo+ICAgICAgICAgdXBkYXRl
X3Jlc3VsdHMoVFRZUEVfUkVTVUxUKHR0eXBlKSk7Cj4gQEAgLTQwNiwxMyArNDQyLDEzIEBAIHZv
aWQgdHN0X3ZicmtfKGNvbnN0IGNoYXIgKmZpbGUsIGNvbnN0IGludCBsaW5lbm8sIGludCB0dHlw
ZSwgY29uc3QgY2hhciAqZm10LAo+ICAgICAgICAgICogc3BlY2lmaWVkIGJ1dCBDTE9ORV9USFJF
QUQgaXMgbm90LiBVc2UgZGlyZWN0IHN5c2NhbGwgdG8gYXZvaWQKPiAgICAgICAgICAqIGNsZWFu
dXAgcnVubmluZyBpbiB0aGUgY2hpbGQuCj4gICAgICAgICAgKi8KPiAtICAgICAgIGlmICh0c3Rf
Z2V0cGlkKCkgPT0gcmVzdWx0cy0+bWFpbl9waWQpCj4gKyAgICAgICBpZiAodHN0X2dldHBpZCgp
ID09IGNvbnRleHQtPm1haW5fcGlkKQo+ICAgICAgICAgICAgICAgICBkb190ZXN0X2NsZWFudXAo
KTsKPgo+ICAgICAgICAgLyoKPiAgICAgICAgICAqIFRoZSB0ZXN0IGxpYnJhcnkgcHJvY2VzcyBy
ZXBvcnRzIHJlc3VsdCBzdGF0aXN0aWNzIGFuZCBleGl0cy4KPiAgICAgICAgICAqLwo+IC0gICAg
ICAgaWYgKGdldHBpZCgpID09IHJlc3VsdHMtPmxpYl9waWQpCj4gKyAgICAgICBpZiAoZ2V0cGlk
KCkgPT0gY29udGV4dC0+bGliX3BpZCkKPiAgICAgICAgICAgICAgICAgZG9fZXhpdChUVFlQRV9S
RVNVTFQodHR5cGUpKTsKPgo+ICAgICAgICAgLyoKPiBAQCAtNDIzLDE2ICs0NTksMTYgQEAgdm9p
ZCB0c3RfdmJya18oY29uc3QgY2hhciAqZmlsZSwgY29uc3QgaW50IGxpbmVubywgaW50IHR0eXBl
LCBjb25zdCBjaGFyICpmbXQsCj4gICAgICAgICAgKi8KPiAgICAgICAgIGlmIChUVFlQRV9SRVNV
TFQodHR5cGUpID09IFRCUk9LKSB7Cj4gICAgICAgICAgICAgICAgIGlmIChyZXN1bHRzKQo+IC0g
ICAgICAgICAgICAgICAgICAgICAgIHRzdF9hdG9taWNfaW5jKCZyZXN1bHRzLT5hYm9ydF9mbGFn
KTsKPiArICAgICAgICAgICAgICAgICAgICAgICB0c3RfYXRvbWljX2luYygoaW50ICopJmNvbnRl
eHQtPmFib3J0X2ZsYWcpOwo+Cj4gICAgICAgICAgICAgICAgIC8qCj4gICAgICAgICAgICAgICAg
ICAqIElmIFRCUk9LIHdhcyBjYWxsZWQgZnJvbSBvbmUgb2YgdGhlIGNoaWxkIHByb2Nlc3NlcyB3
ZSBraWxsCj4gICAgICAgICAgICAgICAgICAqIHRoZSBtYWluIHRlc3QgcHJvY2Vzcy4gVGhhdCBp
biB0dXJuIHRyaWdnZXJzIHRoZSBjb2RlIHRoYXQKPiAgICAgICAgICAgICAgICAgICoga2lsbHMg
bGVmdG92ZXIgY2hpbGRyZW4gb25jZSB0aGUgbWFpbiB0ZXN0IHByb2Nlc3MgZGlkIGV4aXQuCj4g
ICAgICAgICAgICAgICAgICAqLwo+IC0gICAgICAgICAgICAgICBpZiAocmVzdWx0cy0+bWFpbl9w
aWQgJiYgdHN0X2dldHBpZCgpICE9IHJlc3VsdHMtPm1haW5fcGlkKSB7Cj4gKyAgICAgICAgICAg
ICAgIGlmIChjb250ZXh0LT5tYWluX3BpZCAmJiB0c3RfZ2V0cGlkKCkgIT0gY29udGV4dC0+bWFp
bl9waWQpIHsKPiAgICAgICAgICAgICAgICAgICAgICAgICB0c3RfcmVzKFRJTkZPLCAiQ2hpbGQg
cHJvY2VzcyByZXBvcnRlZCBUQlJPSyBraWxsaW5nIHRoZSB0ZXN0Iik7Cj4gLSAgICAgICAgICAg
ICAgICAgICAgICAga2lsbChyZXN1bHRzLT5tYWluX3BpZCwgU0lHS0lMTCk7Cj4gKyAgICAgICAg
ICAgICAgICAgICAgICAga2lsbChjb250ZXh0LT5tYWluX3BpZCwgU0lHS0lMTCk7Cj4gICAgICAg
ICAgICAgICAgIH0KPiAgICAgICAgIH0KPgo+IEBAIC00NDQsNyArNDgwLDcgQEAgdm9pZCB0c3Rf
cmVzXyhjb25zdCBjaGFyICpmaWxlLCBjb25zdCBpbnQgbGluZW5vLCBpbnQgdHR5cGUsCj4gIHsK
PiAgICAgICAgIHZhX2xpc3QgdmE7Cj4KPiAtICAgICAgIGlmICh0dHlwZSA9PSBUREVCVUcgJiYg
IXRkZWJ1ZykKPiArICAgICAgIGlmICh0dHlwZSA9PSBUREVCVUcgJiYgY29udGV4dCAmJiAhY29u
dGV4dC0+dGRlYnVnKQo+ICAgICAgICAgICAgICAgICByZXR1cm47Cj4KPiAgICAgICAgIHZhX3N0
YXJ0KHZhLCBmbXQpOwo+IEBAIC03NTksNyArNzk1LDcgQEAgc3RhdGljIHZvaWQgcGFyc2Vfb3B0
cyhpbnQgYXJnYywgY2hhciAqYXJndltdKQo+ICAgICAgICAgICAgICAgICBicmVhazsKPiAgICAg
ICAgICAgICAgICAgY2FzZSAnRCc6Cj4gICAgICAgICAgICAgICAgICAgICAgICAgdHN0X3JlcyhU
SU5GTywgIkVuYWJsaW5nIGRlYnVnIGluZm8iKTsKPiAtICAgICAgICAgICAgICAgICAgICAgICB0
ZGVidWcgPSAxOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRleHQtPnRkZWJ1ZyA9IDE7
Cj4gICAgICAgICAgICAgICAgIGJyZWFrOwo+ICAgICAgICAgICAgICAgICBjYXNlICdoJzoKPiAg
ICAgICAgICAgICAgICAgICAgICAgICBwcmludF9oZWxwKCk7Cj4gQEAgLTExMDQsNyArMTE0MCw3
IEBAIHN0YXRpYyBpbnQgcHJlcGFyZV9hbmRfbW91bnRfcm9fZnMoY29uc3QgY2hhciAqZGV2LCBj
b25zdCBjaGFyICptbnRwb2ludCwKPiAgICAgICAgICAgICAgICAgcmV0dXJuIDE7Cj4gICAgICAg
ICB9Cj4KPiAtICAgICAgIG1udHBvaW50X21vdW50ZWQgPSAxOwo+ICsgICAgICAgY29udGV4dC0+
bW50cG9pbnRfbW91bnRlZCA9IDE7Cj4KPiAgICAgICAgIHNucHJpbnRmKGJ1Ziwgc2l6ZW9mKGJ1
ZiksICIlcy9kaXIvIiwgbW50cG9pbnQpOwo+ICAgICAgICAgU0FGRV9NS0RJUihidWYsIDA3Nzcp
Owo+IEBAIC0xMTI4LDE0ICsxMTY0LDE0IEBAIHN0YXRpYyB2b2lkIHByZXBhcmVfYW5kX21vdW50
X2Rldl9mcyhjb25zdCBjaGFyICptbnRwb2ludCkKPiAgICAgICAgICAgICAgICAgdHN0X3JlcyhU
SU5GTywgInRtcGRpciBpc24ndCBzdWl0YWJsZSBmb3IgY3JlYXRpbmcgZGV2aWNlcywgIgo+ICAg
ICAgICAgICAgICAgICAgICAgICAgICJtb3VudGluZyB0bXBmcyB3aXRob3V0IG5vZGV2IG9uICVz
IiwgbW50cG9pbnQpOwo+ICAgICAgICAgICAgICAgICBTQUZFX01PVU5UKE5VTEwsIG1udHBvaW50
LCAidG1wZnMiLCAwLCBOVUxMKTsKPiAtICAgICAgICAgICAgICAgbW50cG9pbnRfbW91bnRlZCA9
IDE7Cj4gKyAgICAgICAgICAgICAgIGNvbnRleHQtPm1udHBvaW50X21vdW50ZWQgPSAxOwo+ICAg
ICAgICAgfQo+ICB9Cj4KPiAgc3RhdGljIHZvaWQgcHJlcGFyZV9hbmRfbW91bnRfaHVnZXRsYl9m
cyh2b2lkKQo+ICB7Cj4gICAgICAgICBTQUZFX01PVU5UKCJub25lIiwgdHN0X3Rlc3QtPm1udHBv
aW50LCAiaHVnZXRsYmZzIiwgMCwgTlVMTCk7Cj4gLSAgICAgICBtbnRwb2ludF9tb3VudGVkID0g
MTsKPiArICAgICAgIGNvbnRleHQtPm1udHBvaW50X21vdW50ZWQgPSAxOwo+ICB9Cj4KPiAgaW50
IHRzdF9jcmVhdF91bmxpbmtlZChjb25zdCBjaGFyICpwYXRoLCBpbnQgZmxhZ3MsIG1vZGVfdCBt
b2RlKQo+IEBAIC0xMjIxLDcgKzEyNTcsNyBAQCBzdGF0aWMgdm9pZCBwcmVwYXJlX2RldmljZShz
dHJ1Y3QgdHN0X2ZzICpmcykKPgo+ICAgICAgICAgICAgICAgICBTQUZFX01PVU5UKGdldF9kZXZp
Y2VfbmFtZSh0ZGV2LmZzX3R5cGUpLCB0c3RfdGVzdC0+bW50cG9pbnQsCj4gICAgICAgICAgICAg
ICAgICAgICAgICAgICAgICAgICB0ZGV2LmZzX3R5cGUsIGZzLT5tbnRfZmxhZ3MsIG1udF9kYXRh
KTsKPiAtICAgICAgICAgICAgICAgbW50cG9pbnRfbW91bnRlZCA9IDE7Cj4gKyAgICAgICAgICAg
ICAgIGNvbnRleHQtPm1udHBvaW50X21vdW50ZWQgPSAxOwo+ICAgICAgICAgfQo+ICB9Cj4KPiBA
QCAtMTMxNiwyNyArMTM1MiwyNyBAQCBzdGF0aWMgdm9pZCBkb19zZXR1cChpbnQgYXJnYywgY2hh
ciAqYXJndltdKQo+ICAgICAgICAgaWYgKHRzdF90ZXN0LT5zdXBwb3J0ZWRfYXJjaHMgJiYgIXRz
dF9pc19vbl9hcmNoKHRzdF90ZXN0LT5zdXBwb3J0ZWRfYXJjaHMpKQo+ICAgICAgICAgICAgICAg
ICB0c3RfYnJrKFRDT05GLCAiVGhpcyBhcmNoICclcycgaXMgbm90IHN1cHBvcnRlZCBmb3IgdGVz
dCEiLCB0c3RfYXJjaC5uYW1lKTsKPgo+ICsgICAgICAgaWYgKHRzdF90ZXN0LT5zYW1wbGUpCj4g
KyAgICAgICAgICAgICAgIHRzdF90ZXN0ID0gdHN0X3RpbWVyX3Rlc3Rfc2V0dXAodHN0X3Rlc3Qp
Owo+ICsKPiArICAgICAgIGlmICh0c3RfdGVzdC0+cnVuc19zY3JpcHQpIHsKPiArICAgICAgICAg
ICAgICAgdHN0X3Rlc3QtPmNoaWxkX25lZWRzX3JlaW5pdCA9IDE7Cj4gKyAgICAgICAgICAgICAg
IHRzdF90ZXN0LT5mb3Jrc19jaGlsZCA9IDE7Cj4gKyAgICAgICB9Cj4gKwo+ICAgICAgICAgYXNz
ZXJ0X3Rlc3RfZm4oKTsKPgo+ICAgICAgICAgVENJRCA9IHRjaWQgPSBnZXRfdGNpZChhcmd2KTsK
Pgo+IC0gICAgICAgaWYgKHRzdF90ZXN0LT5zYW1wbGUpCj4gLSAgICAgICAgICAgICAgIHRzdF90
ZXN0ID0gdHN0X3RpbWVyX3Rlc3Rfc2V0dXAodHN0X3Rlc3QpOwo+ICsgICAgICAgc2V0dXBfaXBj
KCk7Cj4KPiAgICAgICAgIHBhcnNlX29wdHMoYXJnYywgYXJndik7Cj4KPiAgICAgICAgIGlmICh0
ZGVidWdfZW52ICYmICghc3RyY21wKHRkZWJ1Z19lbnYsICIxIikgfHwgIXN0cmNtcCh0ZGVidWdf
ZW52LCAieSIpKSkgewo+ICAgICAgICAgICAgICAgICB0c3RfcmVzKFRJTkZPLCAiRW5hYmxpbmcg
ZGVidWcgaW5mbyIpOwo+IC0gICAgICAgICAgICAgICB0ZGVidWcgPSAxOwo+IC0gICAgICAgfQo+
IC0KPiAtICAgICAgIGlmICh0c3RfdGVzdC0+cnVuc19zY3JpcHQpIHsKPiAtICAgICAgICAgICAg
ICAgdHN0X3Rlc3QtPmNoaWxkX25lZWRzX3JlaW5pdCA9IDE7Cj4gLSAgICAgICAgICAgICAgIHRz
dF90ZXN0LT5mb3Jrc19jaGlsZCA9IDE7Cj4gKyAgICAgICAgICAgICAgIGNvbnRleHQtPnRkZWJ1
ZyA9IDE7Cj4gICAgICAgICB9Cj4KPiAtICAgICAgIHNldHVwX2lwYygpOwo+IC0KPiAgICAgICAg
IGlmICh0c3RfdGVzdC0+bmVlZHNfa2NvbmZpZ3MgJiYgdHN0X2tjb25maWdfY2hlY2sodHN0X3Rl
c3QtPm5lZWRzX2tjb25maWdzKSkKPiAgICAgICAgICAgICAgICAgdHN0X2JyayhUQ09ORiwgIkFi
b3J0aW5nIGR1ZSB0byB1bnN1aXRhYmxlIGtlcm5lbCBjb25maWcsIHNlZSBhYm92ZSEiKTsKPgo+
IEBAIC0xNDU0LDcgKzE0OTAsNyBAQCBzdGF0aWMgdm9pZCBkb19zZXR1cChpbnQgYXJnYywgY2hh
ciAqYXJndltdKQo+ICAgICAgICAgaWYgKHRzdF90ZXN0LT5uZWVkc19odWdldGxiZnMpCj4gICAg
ICAgICAgICAgICAgIHByZXBhcmVfYW5kX21vdW50X2h1Z2V0bGJfZnMoKTsKPgo+IC0gICAgICAg
aWYgKHRzdF90ZXN0LT5uZWVkc19kZXZpY2UgJiYgIW1udHBvaW50X21vdW50ZWQpIHsKPiArICAg
ICAgIGlmICh0c3RfdGVzdC0+bmVlZHNfZGV2aWNlICYmICFjb250ZXh0LT5tbnRwb2ludF9tb3Vu
dGVkKSB7Cj4gICAgICAgICAgICAgICAgIHRkZXYuZGV2ID0gdHN0X2FjcXVpcmVfZGV2aWNlXyhO
VUxMLCB0c3RfdGVzdC0+ZGV2X21pbl9zaXplKTsKPgo+ICAgICAgICAgICAgICAgICBpZiAoIXRk
ZXYuZGV2KQo+IEBAIC0xNDgwLDEyICsxNTE2LDEyIEBAIHN0YXRpYyB2b2lkIGRvX3NldHVwKGlu
dCBhcmdjLCBjaGFyICphcmd2W10pCj4gICAgICAgICBpZiAodHN0X3Rlc3QtPm5lZWRzX292ZXJs
YXkgJiYgIXRzdF90ZXN0LT5tb3VudF9kZXZpY2UpCj4gICAgICAgICAgICAgICAgIHRzdF9icmso
VEJST0ssICJ0c3RfdGVzdC0+bW91bnRfZGV2aWNlIG11c3QgYmUgc2V0Iik7Cj4KPiAtICAgICAg
IGlmICh0c3RfdGVzdC0+bmVlZHNfb3ZlcmxheSAmJiAhbW50cG9pbnRfbW91bnRlZCkKPiArICAg
ICAgIGlmICh0c3RfdGVzdC0+bmVlZHNfb3ZlcmxheSAmJiAhY29udGV4dC0+bW50cG9pbnRfbW91
bnRlZCkKPiAgICAgICAgICAgICAgICAgdHN0X2JyayhUQlJPSywgInRzdF90ZXN0LT5tbnRwb2lu
dCBtdXN0IGJlIG1vdW50ZWQiKTsKPgo+IC0gICAgICAgaWYgKHRzdF90ZXN0LT5uZWVkc19vdmVy
bGF5ICYmICFvdmxfbW91bnRlZCkgewo+ICsgICAgICAgaWYgKHRzdF90ZXN0LT5uZWVkc19vdmVy
bGF5ICYmICFjb250ZXh0LT5vdmxfbW91bnRlZCkgewo+ICAgICAgICAgICAgICAgICBTQUZFX01P
VU5UX09WRVJMQVkoKTsKPiAtICAgICAgICAgICAgICAgb3ZsX21vdW50ZWQgPSAxOwo+ICsgICAg
ICAgICAgICAgICBjb250ZXh0LT5vdmxfbW91bnRlZCA9IDE7Cj4gICAgICAgICB9Cj4KPiAgICAg
ICAgIGlmICh0c3RfdGVzdC0+cmVzb3VyY2VfZmlsZXMpCj4gQEAgLTE1MDUsNyArMTU0MSw3IEBA
IHN0YXRpYyB2b2lkIGRvX3NldHVwKGludCBhcmdjLCBjaGFyICphcmd2W10pCj4KPiAgc3RhdGlj
IHZvaWQgZG9fdGVzdF9zZXR1cCh2b2lkKQo+ICB7Cj4gLSAgICAgICByZXN1bHRzLT5tYWluX3Bp
ZCA9IGdldHBpZCgpOwo+ICsgICAgICAgY29udGV4dC0+bWFpbl9waWQgPSBnZXRwaWQoKTsKPgo+
ICAgICAgICAgaWYgKCF0c3RfdGVzdC0+YWxsX2ZpbGVzeXN0ZW1zICYmIHRzdF90ZXN0LT5za2lw
X2ZpbGVzeXN0ZW1zKSB7Cj4gICAgICAgICAgICAgICAgIGxvbmcgZnNfdHlwZSA9IHRzdF9mc190
eXBlKCIuIik7Cj4gQEAgLTE1MjUsNyArMTU2MSw3IEBAIHN0YXRpYyB2b2lkIGRvX3Rlc3Rfc2V0
dXAodm9pZCkKPiAgICAgICAgIGlmICh0c3RfdGVzdC0+c2V0dXApCj4gICAgICAgICAgICAgICAg
IHRzdF90ZXN0LT5zZXR1cCgpOwo+Cj4gLSAgICAgICBpZiAocmVzdWx0cy0+bWFpbl9waWQgIT0g
dHN0X2dldHBpZCgpKQo+ICsgICAgICAgaWYgKGNvbnRleHQtPm1haW5fcGlkICE9IHRzdF9nZXRw
aWQoKSkKPiAgICAgICAgICAgICAgICAgdHN0X2JyayhUQlJPSywgIlJ1bmF3YXkgY2hpbGQgaW4g
c2V0dXAoKSEiKTsKPgo+ICAgICAgICAgaWYgKHRzdF90ZXN0LT5jYXBzKQo+IEBAIC0xNTM3LDEw
ICsxNTczLDEwIEBAIHN0YXRpYyB2b2lkIGRvX2NsZWFudXAodm9pZCkKPiAgICAgICAgIGlmICh0
c3RfdGVzdC0+bmVlZHNfY2dyb3VwX2N0cmxzKQo+ICAgICAgICAgICAgICAgICB0c3RfY2dfY2xl
YW51cCgpOwo+Cj4gLSAgICAgICBpZiAob3ZsX21vdW50ZWQpCj4gKyAgICAgICBpZiAoY29udGV4
dC0+b3ZsX21vdW50ZWQpCj4gICAgICAgICAgICAgICAgIFNBRkVfVU1PVU5UKE9WTF9NTlQpOwo+
Cj4gLSAgICAgICBpZiAobW50cG9pbnRfbW91bnRlZCkKPiArICAgICAgIGlmIChjb250ZXh0LT5t
bnRwb2ludF9tb3VudGVkKQo+ICAgICAgICAgICAgICAgICB0c3RfdW1vdW50KHRzdF90ZXN0LT5t
bnRwb2ludCk7Cj4KPiAgICAgICAgIGlmICh0c3RfdGVzdC0+bmVlZHNfZGV2aWNlICYmIHRkZXYu
ZGV2KQo+IEBAIC0xNTYyLDcgKzE1OTgsNyBAQCBzdGF0aWMgdm9pZCBkb19jbGVhbnVwKHZvaWQp
Cj4KPiAgc3RhdGljIHZvaWQgaGVhcnRiZWF0KHZvaWQpCj4gIHsKPiAtICAgICAgIGlmICh0c3Rf
Y2xvY2tfZ2V0dGltZShDTE9DS19NT05PVE9OSUMsICZ0c3Rfc3RhcnRfdGltZSkpCj4gKyAgICAg
ICBpZiAodHN0X2Nsb2NrX2dldHRpbWUoQ0xPQ0tfTU9OT1RPTklDLCAmY29udGV4dC0+c3RhcnRf
dGltZSkpCj4gICAgICAgICAgICAgICAgIHRzdF9yZXMoVFdBUk4gfCBURVJSTk8sICJ0c3RfY2xv
Y2tfZ2V0dGltZSgpIGZhaWxlZCIpOwo+Cj4gICAgICAgICBpZiAoZ2V0cHBpZCgpID09IDEpIHsK
PiBAQCAtMTU4OCw3ICsxNjI0LDcgQEAgc3RhdGljIHZvaWQgcnVuX3Rlc3RzKHZvaWQpCj4gICAg
ICAgICAgICAgICAgIGhlYXJ0YmVhdCgpOwo+ICAgICAgICAgICAgICAgICB0c3RfdGVzdC0+dGVz
dF9hbGwoKTsKPgo+IC0gICAgICAgICAgICAgICBpZiAodHN0X2dldHBpZCgpICE9IHJlc3VsdHMt
Pm1haW5fcGlkKQo+ICsgICAgICAgICAgICAgICBpZiAodHN0X2dldHBpZCgpICE9IGNvbnRleHQt
Pm1haW5fcGlkKQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGV4aXQoMCk7Cj4KPiAgICAgICAg
ICAgICAgICAgdHN0X3JlYXBfY2hpbGRyZW4oKTsKPiBAQCAtMTYwNCw3ICsxNjQwLDcgQEAgc3Rh
dGljIHZvaWQgcnVuX3Rlc3RzKHZvaWQpCj4gICAgICAgICAgICAgICAgIGhlYXJ0YmVhdCgpOwo+
ICAgICAgICAgICAgICAgICB0c3RfdGVzdC0+dGVzdChpKTsKPgo+IC0gICAgICAgICAgICAgICBp
ZiAodHN0X2dldHBpZCgpICE9IHJlc3VsdHMtPm1haW5fcGlkKQo+ICsgICAgICAgICAgICAgICBp
ZiAodHN0X2dldHBpZCgpICE9IGNvbnRleHQtPm1haW5fcGlkKQo+ICAgICAgICAgICAgICAgICAg
ICAgICAgIGV4aXQoMCk7Cj4KPiAgICAgICAgICAgICAgICAgdHN0X3JlYXBfY2hpbGRyZW4oKTsK
PiBAQCAtMTcwNCw3ICsxNzQwLDcgQEAgc3RhdGljIHZvaWQgYWxhcm1faGFuZGxlcihpbnQgc2ln
IExUUF9BVFRSSUJVVEVfVU5VU0VEKQo+Cj4gIHN0YXRpYyB2b2lkIGhlYXJ0YmVhdF9oYW5kbGVy
KGludCBzaWcgTFRQX0FUVFJJQlVURV9VTlVTRUQpCj4gIHsKPiAtICAgICAgIGFsYXJtKHJlc3Vs
dHMtPm92ZXJhbGxfdGltZSk7Cj4gKyAgICAgICBhbGFybShjb250ZXh0LT5vdmVyYWxsX3RpbWUp
Owo+ICAgICAgICAgc2lna2lsbF9yZXRyaWVzID0gMDsKPiAgfQo+Cj4gQEAgLTE3MjEsMTUgKzE3
NTcsMTUgQEAgdW5zaWduZWQgaW50IHRzdF9yZW1haW5pbmdfcnVudGltZSh2b2lkKQo+ICAgICAg
ICAgc3RhdGljIHN0cnVjdCB0aW1lc3BlYyBub3c7Cj4gICAgICAgICBpbnQgZWxhcHNlZDsKPgo+
IC0gICAgICAgaWYgKHJlc3VsdHMtPnJ1bnRpbWUgPT0gMCkKPiArICAgICAgIGlmIChjb250ZXh0
LT5ydW50aW1lID09IDApCj4gICAgICAgICAgICAgICAgIHRzdF9icmsoVEJST0ssICJSdW50aW1l
IG5vdCBzZXQhIik7Cj4KPiAgICAgICAgIGlmICh0c3RfY2xvY2tfZ2V0dGltZShDTE9DS19NT05P
VE9OSUMsICZub3cpKQo+ICAgICAgICAgICAgICAgICB0c3RfcmVzKFRXQVJOIHwgVEVSUk5PLCAi
dHN0X2Nsb2NrX2dldHRpbWUoKSBmYWlsZWQiKTsKPgo+IC0gICAgICAgZWxhcHNlZCA9IHRzdF90
aW1lc3BlY19kaWZmX21zKG5vdywgdHN0X3N0YXJ0X3RpbWUpIC8gMTAwMDsKPiAtICAgICAgIGlm
IChyZXN1bHRzLT5ydW50aW1lID4gKHVuc2lnbmVkIGludCkgZWxhcHNlZCkKPiAtICAgICAgICAg
ICAgICAgcmV0dXJuIHJlc3VsdHMtPnJ1bnRpbWUgLSBlbGFwc2VkOwo+ICsgICAgICAgZWxhcHNl
ZCA9IHRzdF90aW1lc3BlY19kaWZmX21zKG5vdywgY29udGV4dC0+c3RhcnRfdGltZSkgLyAxMDAw
Owo+ICsgICAgICAgaWYgKGNvbnRleHQtPnJ1bnRpbWUgPiAodW5zaWduZWQgaW50KSBlbGFwc2Vk
KQo+ICsgICAgICAgICAgICAgICByZXR1cm4gY29udGV4dC0+cnVudGltZSAtIGVsYXBzZWQ7Cj4K
PiAgICAgICAgIHJldHVybiAwOwo+ICB9Cj4gQEAgLTE3NTcsMjkgKzE3OTMsMjkgQEAgc3RhdGlj
IHZvaWQgc2V0X292ZXJhbGxfdGltZW91dCh2b2lkKQo+ICAgICAgICAgICAgICAgICByZXR1cm47
Cj4gICAgICAgICB9Cj4KPiAtICAgICAgIHJlc3VsdHMtPm92ZXJhbGxfdGltZSA9IHRzdF9tdWx0
aXBseV90aW1lb3V0KHRpbWVvdXQpICsgcmVzdWx0cy0+cnVudGltZTsKPiArICAgICAgIGNvbnRl
eHQtPm92ZXJhbGxfdGltZSA9IHRzdF9tdWx0aXBseV90aW1lb3V0KHRpbWVvdXQpICsgY29udGV4
dC0+cnVudGltZTsKPgo+ICAgICAgICAgdHN0X3JlcyhUSU5GTywgIk92ZXJhbGwgdGltZW91dCBw
ZXIgcnVuIGlzICV1aCAlMDJ1bSAlMDJ1cyIsCj4gLSAgICAgICAgICAgICAgIHJlc3VsdHMtPm92
ZXJhbGxfdGltZS8zNjAwLCAocmVzdWx0cy0+b3ZlcmFsbF90aW1lJTM2MDApLzYwLAo+IC0gICAg
ICAgICAgICAgICByZXN1bHRzLT5vdmVyYWxsX3RpbWUgJSA2MCk7Cj4gKyAgICAgICAgICAgICAg
IGNvbnRleHQtPm92ZXJhbGxfdGltZS8zNjAwLCAoY29udGV4dC0+b3ZlcmFsbF90aW1lJTM2MDAp
LzYwLAo+ICsgICAgICAgICAgICAgICBjb250ZXh0LT5vdmVyYWxsX3RpbWUgJSA2MCk7Cj4gIH0K
Pgo+ICB2b2lkIHRzdF9zZXRfdGltZW91dChpbnQgdGltZW91dCkKPiAgewo+ICAgICAgICAgaW50
IHRpbWVvdXRfYWRqID0gREVGQVVMVF9USU1FT1VUICsgdGltZW91dDsKPgo+IC0gICAgICAgcmVz
dWx0cy0+b3ZlcmFsbF90aW1lID0gdHN0X211bHRpcGx5X3RpbWVvdXQodGltZW91dF9hZGopICsg
cmVzdWx0cy0+cnVudGltZTsKPiArICAgICAgIGNvbnRleHQtPm92ZXJhbGxfdGltZSA9IHRzdF9t
dWx0aXBseV90aW1lb3V0KHRpbWVvdXRfYWRqKSArIGNvbnRleHQtPnJ1bnRpbWU7Cj4KPiAgICAg
ICAgIHRzdF9yZXMoVElORk8sICJPdmVyYWxsIHRpbWVvdXQgcGVyIHJ1biBpcyAldWggJTAydW0g
JTAydXMiLAo+IC0gICAgICAgICAgICAgICByZXN1bHRzLT5vdmVyYWxsX3RpbWUvMzYwMCwgKHJl
c3VsdHMtPm92ZXJhbGxfdGltZSUzNjAwKS82MCwKPiAtICAgICAgICAgICAgICAgcmVzdWx0cy0+
b3ZlcmFsbF90aW1lICUgNjApOwo+ICsgICAgICAgICAgICAgICBjb250ZXh0LT5vdmVyYWxsX3Rp
bWUvMzYwMCwgKGNvbnRleHQtPm92ZXJhbGxfdGltZSUzNjAwKS82MCwKPiArICAgICAgICAgICAg
ICAgY29udGV4dC0+b3ZlcmFsbF90aW1lICUgNjApOwo+Cj4gICAgICAgICBoZWFydGJlYXQoKTsK
PiAgfQo+Cj4gIHZvaWQgdHN0X3NldF9ydW50aW1lKGludCBydW50aW1lKQo+ICB7Cj4gLSAgICAg
ICByZXN1bHRzLT5ydW50aW1lID0gbXVsdGlwbHlfcnVudGltZShydW50aW1lKTsKPiArICAgICAg
IGNvbnRleHQtPnJ1bnRpbWUgPSBtdWx0aXBseV9ydW50aW1lKHJ1bnRpbWUpOwo+ICAgICAgICAg
dHN0X3JlcyhUSU5GTywgIlVwZGF0aW5nIHJ1bnRpbWUgdG8gJXVoICUwMnVtICUwMnVzIiwKPiAg
ICAgICAgICAgICAgICAgcnVudGltZS8zNjAwLCAocnVudGltZSUzNjAwKS82MCwgcnVudGltZSAl
IDYwKTsKPiAgICAgICAgIHNldF9vdmVyYWxsX3RpbWVvdXQoKTsKPiBAQCAtMTc5Myw3ICsxODI5
LDcgQEAgc3RhdGljIGludCBmb3JrX3Rlc3RydW4odm9pZCkKPiAgICAgICAgIFNBRkVfU0lHTkFM
KFNJR0lOVCwgc2lnaW50X2hhbmRsZXIpOwo+ICAgICAgICAgU0FGRV9TSUdOQUwoU0lHVEVSTSwg
c2lnaW50X2hhbmRsZXIpOwo+Cj4gLSAgICAgICBhbGFybShyZXN1bHRzLT5vdmVyYWxsX3RpbWUp
Owo+ICsgICAgICAgYWxhcm0oY29udGV4dC0+b3ZlcmFsbF90aW1lKTsKPgo+ICAgICAgICAgc2hv
d19mYWlsdXJlX2hpbnRzID0gMTsKPgo+IEBAIC0xODI3LDcgKzE4NjMsNyBAQCBzdGF0aWMgaW50
IGZvcmtfdGVzdHJ1bih2b2lkKQo+ICAgICAgICAgaWYgKFdJRkVYSVRFRChzdGF0dXMpICYmIFdF
WElUU1RBVFVTKHN0YXR1cykpCj4gICAgICAgICAgICAgICAgIHRzdF9icmsoVEJST0ssICJDaGls
ZCByZXR1cm5lZCB3aXRoICVpIiwgV0VYSVRTVEFUVVMoc3RhdHVzKSk7Cj4KPiAtICAgICAgIGlm
IChyZXN1bHRzLT5hYm9ydF9mbGFnKQo+ICsgICAgICAgaWYgKGNvbnRleHQtPmFib3J0X2ZsYWcp
Cj4gICAgICAgICAgICAgICAgIHJldHVybiAwOwo+Cj4gICAgICAgICBpZiAoV0lGU0lHTkFMRUQo
c3RhdHVzKSAmJiBXVEVSTVNJRyhzdGF0dXMpID09IFNJR0tJTEwpIHsKPiBAQCAtMTg4Niw5ICsx
OTIyLDkgQEAgc3RhdGljIGludCBydW5fdGNhc2Vfb25fZnMoc3RydWN0IHRzdF9mcyAqZnMsIGNv
bnN0IGNoYXIgKmZzX3R5cGUpCj4KPiAgICAgICAgIHJldCA9IGZvcmtfdGVzdHJ1bigpOwo+Cj4g
LSAgICAgICBpZiAobW50cG9pbnRfbW91bnRlZCkgewo+ICsgICAgICAgaWYgKGNvbnRleHQtPm1u
dHBvaW50X21vdW50ZWQpIHsKPiAgICAgICAgICAgICAgICAgdHN0X3Vtb3VudCh0c3RfdGVzdC0+
bW50cG9pbnQpOwo+IC0gICAgICAgICAgICAgICBtbnRwb2ludF9tb3VudGVkID0gMDsKPiArICAg
ICAgICAgICAgICAgY29udGV4dC0+bW50cG9pbnRfbW91bnRlZCA9IDA7Cj4gICAgICAgICB9Cj4K
PiAgICAgICAgIHJldHVybiByZXQ7Cj4gQEAgLTE5MTMsNyArMTk0OSw3IEBAIHN0YXRpYyBpbnQg
cnVuX3RjYXNlc19wZXJfZnModm9pZCkKPiAgICAgICAgICAgICAgICAgZm91bmRfdmFsaWRfZnMg
PSB0cnVlOwo+ICAgICAgICAgICAgICAgICBydW5fdGNhc2Vfb25fZnMoZnMsIGZpbGVzeXN0ZW1z
W2ldKTsKPgo+IC0gICAgICAgICAgICAgICBpZiAodHN0X2F0b21pY19sb2FkKCZyZXN1bHRzLT5h
Ym9ydF9mbGFnKSkKPiArICAgICAgICAgICAgICAgaWYgKHRzdF9hdG9taWNfbG9hZCgoaW50ICop
JmNvbnRleHQtPmFib3J0X2ZsYWcpKQo+ICAgICAgICAgICAgICAgICAgICAgICAgIGRvX2V4aXQo
MCk7Cj4gICAgICAgICB9Cj4KPiBAQCAtMTkzMyw5ICsxOTY5LDggQEAgdm9pZCB0c3RfcnVuX3Rj
YXNlcyhpbnQgYXJnYywgY2hhciAqYXJndltdLCBzdHJ1Y3QgdHN0X3Rlc3QgKnNlbGYpCj4gICAg
ICAgICB0c3RfdGVzdCA9IHNlbGY7Cj4KPiAgICAgICAgIGRvX3NldHVwKGFyZ2MsIGFyZ3YpOwo+
IC0KPiAtICAgICAgIHJlc3VsdHMtPmxpYl9waWQgPSBnZXRwaWQoKTsKPiAtICAgICAgIHRzdF9l
bmFibGVfb29tX3Byb3RlY3Rpb24ocmVzdWx0cy0+bGliX3BpZCk7Cj4gKyAgICAgICBjb250ZXh0
LT5saWJfcGlkID0gZ2V0cGlkKCk7Cj4gKyAgICAgICB0c3RfZW5hYmxlX29vbV9wcm90ZWN0aW9u
KGNvbnRleHQtPmxpYl9waWQpOwo+Cj4gICAgICAgICBTQUZFX1NJR05BTChTSUdBTFJNLCBhbGFy
bV9oYW5kbGVyKTsKPiAgICAgICAgIFNBRkVfU0lHTkFMKFNJR1VTUjEsIGhlYXJ0YmVhdF9oYW5k
bGVyKTsKPiBAQCAtMTk0Niw3ICsxOTgxLDcgQEAgdm9pZCB0c3RfcnVuX3RjYXNlcyhpbnQgYXJn
YywgY2hhciAqYXJndltdLCBzdHJ1Y3QgdHN0X3Rlc3QgKnNlbGYpCj4gICAgICAgICB0c3RfcmVz
KFRJTkZPLCAiVGVzdGVkIGtlcm5lbDogJXMgJXMgJXMiLCB1dmFsLnJlbGVhc2UsIHV2YWwudmVy
c2lvbiwgdXZhbC5tYWNoaW5lKTsKPgo+ICAgICAgICAgaWYgKHRzdF90ZXN0LT5ydW50aW1lKQo+
IC0gICAgICAgICAgICAgICByZXN1bHRzLT5ydW50aW1lID0gbXVsdGlwbHlfcnVudGltZSh0c3Rf
dGVzdC0+cnVudGltZSk7Cj4gKyAgICAgICAgICAgICAgIGNvbnRleHQtPnJ1bnRpbWUgPSBtdWx0
aXBseV9ydW50aW1lKHRzdF90ZXN0LT5ydW50aW1lKTsKPgo+ICAgICAgICAgc2V0X292ZXJhbGxf
dGltZW91dCgpOwo+Cj4gQEAgLTE5NTksNyArMTk5NCw3IEBAIHZvaWQgdHN0X3J1bl90Y2FzZXMo
aW50IGFyZ2MsIGNoYXIgKmFyZ3ZbXSwgc3RydWN0IHRzdF90ZXN0ICpzZWxmKQo+ICAgICAgICAg
ICAgICAgICBlbHNlCj4gICAgICAgICAgICAgICAgICAgICAgICAgZm9ya190ZXN0cnVuKCk7Cj4K
PiAtICAgICAgICAgICAgICAgaWYgKHRzdF9hdG9taWNfbG9hZCgmcmVzdWx0cy0+YWJvcnRfZmxh
ZykpCj4gKyAgICAgICAgICAgICAgIGlmICh0c3RfYXRvbWljX2xvYWQoKGludCAqKSZjb250ZXh0
LT5hYm9ydF9mbGFnKSkKPiAgICAgICAgICAgICAgICAgICAgICAgICBkb19leGl0KDApOwo+ICAg
ICAgICAgfQo+Cj4gLS0KPiAyLjQ5LjAKPgo+Cj4gLS0KPiBNYWlsaW5nIGxpc3QgaW5mbzogaHR0
cHM6Ly9saXN0cy5saW51eC5pdC9saXN0aW5mby9sdHAKPgoKCi0tIApSZWdhcmRzLApMaSBXYW5n
CgoKLS0gCk1haWxpbmcgbGlzdCBpbmZvOiBodHRwczovL2xpc3RzLmxpbnV4Lml0L2xpc3RpbmZv
L2x0cAo=
