Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [IPv6:2001:1418:10:5::2])
	by mail.lfdr.de (Postfix) with ESMTPS id 34CFC32879
	for <lists+linux-ltp@lfdr.de>; Mon,  3 Jun 2019 08:27:10 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id 03A972D0142
	for <lists+linux-ltp@lfdr.de>; Mon,  3 Jun 2019 08:27:10 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-2.smtp.seeweb.it (in-2.smtp.seeweb.it [217.194.8.2])
 by picard.linux.it (Postfix) with ESMTP id 119382B02EF
 for <ltp@lists.linux.it>; Mon,  3 Jun 2019 08:27:08 +0200 (CEST)
Received: from mx1.suse.de (mx2.suse.de [195.135.220.15])
 (using TLSv1.2 with cipher AECDH-AES256-SHA (256/256 bits))
 (No client certificate requested)
 by in-2.smtp.seeweb.it (Postfix) with ESMTPS id 6898460067A
 for <ltp@lists.linux.it>; Mon,  3 Jun 2019 08:27:06 +0200 (CEST)
Received: from relay2.suse.de (unknown [195.135.220.254])
 by mx1.suse.de (Postfix) with ESMTP id 6B3C8AEF3
 for <ltp@lists.linux.it>; Mon,  3 Jun 2019 06:27:06 +0000 (UTC)
From: Christian Amann <camann@suse.com>
To: ltp@lists.linux.it
Date: Mon,  3 Jun 2019 08:27:01 +0200
Message-Id: <20190603062701.9728-1-camann@suse.com>
X-Mailer: git-send-email 2.16.4
X-Virus-Scanned: clamav-milter 0.99.2 at in-2.smtp.seeweb.it
X-Virus-Status: Clean
X-Spam-Status: No, score=0.0 required=7.0 tests=SPF_HELO_NONE,SPF_PASS
 autolearn=disabled version=3.4.0
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on in-2.smtp.seeweb.it
Subject: [LTP] [PATCH v1] syscalls/accept02: add CVE-2017-8890 test case
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
MIME-Version: 1.0
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

SW4gS2VybmVscyBwcmlvciB0byA0LjEwLjE1IG1pc3NpbmcgY29tbWl0IDY1NzgzMWZmIHRoZSBt
dWx0aWNhc3QgZ3JvdXAKb2YgYSBzb2NrZXQgd2FzIGNvcGllZCBvdmVyIHRvIGEgbmV3IHNvY2tl
dCBjcmVhdGVkIHVzaW5nIHRoZSBhY2NlcHQoKQpzeXNjYWxsLiBUaGlzIGxlYWRzIHRvIGEgZG91
YmxlIGZyZWUgd2hlbiBjbG9zaW5nIGJvdGggdGhvc2Ugc29ja2V0cy4KClRoaXMgY2FuIG9ubHkg
YmUgY2hlY2tlZCBvbmNlIGEgbmV3IHNvY2tldCB3YXMgY3JlYXRlZCB3aGljaCBoYXMgdG8gYmUK
Y2xvc2VkIGV2ZW50dWFsbHkuIFRoYXQgbWVhbnMgdGhhdCB0aGlzIHRlc3QgY2FzZSBjYW4gY2F1
c2UgYW4gdW5zdGFibGUKc3lzdGVtIGlmIGl0IGRvZXMgbm90IHN1Y2NlZWQuCgpTaWduZWQtb2Zm
LWJ5OiBDaHJpc3RpYW4gQW1hbm4gPGNhbWFubkBzdXNlLmNvbT4KLS0tCiBydW50ZXN0L3N5c2Nh
bGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgIHwgICAyICsKIHRlc3RjYXNlcy9rZXJuZWwv
c3lzY2FsbHMvYWNjZXB0Ly5naXRpZ25vcmUgfCAgIDEgKwogdGVzdGNhc2VzL2tlcm5lbC9zeXNj
YWxscy9hY2NlcHQvTWFrZWZpbGUgICB8ICAgMiArCiB0ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxz
L2FjY2VwdC9hY2NlcHQwMi5jIHwgMTQzICsrKysrKysrKysrKysrKysrKysrKysrKysrKysKIDQg
ZmlsZXMgY2hhbmdlZCwgMTQ4IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCB0ZXN0
Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2VwdC9hY2NlcHQwMi5jCgpkaWZmIC0tZ2l0IGEvcnVu
dGVzdC9zeXNjYWxscyBiL3J1bnRlc3Qvc3lzY2FsbHMKaW5kZXggNzYyYjE1YjFmLi43OWVmMjk0
ZmUgMTAwNjQ0Ci0tLSBhL3J1bnRlc3Qvc3lzY2FsbHMKKysrIGIvcnVudGVzdC9zeXNjYWxscwpA
QCAtMiw2ICsyLDggQEAKIGFib3J0MDEgYWJvcnQwMQogCiBhY2NlcHQwMSBhY2NlcHQwMQorYWNj
ZXB0MDIgYWNjZXB0MDIKKwogYWNjZXB0NF8wMSBhY2NlcHQ0XzAxCiAKIGFjY2VzczAxIGFjY2Vz
czAxCmRpZmYgLS1naXQgYS90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2VwdC8uZ2l0aWdu
b3JlIGIvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9hY2NlcHQvLmdpdGlnbm9yZQppbmRleCAx
ZjZmOGFkYTAuLjViMTQ2MjY5OSAxMDA2NDQKLS0tIGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxs
cy9hY2NlcHQvLmdpdGlnbm9yZQorKysgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2Vw
dC8uZ2l0aWdub3JlCkBAIC0xICsxLDIgQEAKIC9hY2NlcHQwMQorL2FjY2VwdDAyCmRpZmYgLS1n
aXQgYS90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2VwdC9NYWtlZmlsZSBiL3Rlc3RjYXNl
cy9rZXJuZWwvc3lzY2FsbHMvYWNjZXB0L01ha2VmaWxlCmluZGV4IGJkNjE3ZDgwNi4uMDkxMDg3
MWM3IDEwMDY0NAotLS0gYS90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2VwdC9NYWtlZmls
ZQorKysgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2VwdC9NYWtlZmlsZQpAQCAtMjEs
MyArMjEsNSBAQCB0b3Bfc3JjZGlyCQk/PSAuLi8uLi8uLi8uLgogaW5jbHVkZSAkKHRvcF9zcmNk
aXIpL2luY2x1ZGUvbWsvdGVzdGNhc2VzLm1rCiAKIGluY2x1ZGUgJCh0b3Bfc3JjZGlyKS9pbmNs
dWRlL21rL2dlbmVyaWNfbGVhZl90YXJnZXQubWsKKworYWNjZXB0MDI6IENGTEFHUyArPSAtcHRo
cmVhZApkaWZmIC0tZ2l0IGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9hY2NlcHQvYWNjZXB0
MDIuYyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvYWNjZXB0L2FjY2VwdDAyLmMKbmV3IGZp
bGUgbW9kZSAxMDA2NDQKaW5kZXggMDAwMDAwMDAwLi42NjJhZTQzNDYKLS0tIC9kZXYvbnVsbAor
KysgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2FjY2VwdC9hY2NlcHQwMi5jCkBAIC0wLDAg
KzEsMTQzIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRlcgor
LyoKKyAqIENvcHlyaWdodCAoYykgMjAxOSBTVVNFIExMQworICogQXV0aG9yOiBDaHJpc3RpYW4g
QW1hbm4gPGNhbWFubkBzdXNlLmNvbT4KKyAqLworLyogVGVzdCBmb3IgQ1ZFLTIwMTctODg5MAor
ICoKKyAqIEluIEtlcm5lbHMgdXAgdG8gNC4xMC4xNSBtaXNzaW5nIGNvbW1pdCA2NTc4MzFmZiB0
aGUgbXVsdGljYXN0CisgKiBncm91cCBpbmZvcm1hdGlvbiBvZiBhIHNvY2tldCBnZXRzIGNvcGll
ZCBvdmVyIHRvIGEgbmV3bHkgY3JlYXRlZAorICogc29ja2V0IHdoZW4gdXNpbmcgdGhlIGFjY2Vw
dCgpIHN5c2NhbGwuIFRoaXMgd2lsbCBjYXVzZSBhIGRvdWJsZSBmcmVlCisgKiB3aGVuIGNsb3Np
bmcgdGhlIG9yaWdpbmFsIGFuZCB0aGUgY2xvbmVkIHNvY2tldC4KKyAqCisgKiBXQVJOSU5HOgor
ICogVGhlcmUgaXMgYSBoaWdoIGNoYW5jZSB0aGF0IHRoaXMgdGVzdCB3aWxsIGNhdXNlIGFuIHVu
c3RhYmxlIHN5c3RlbQorICogaWYgaXQgZG9lcyBub3Qgc3VjY2VlZCEKKyAqCisgKiBGb3IgbW9y
ZSBpbmZvcm1hdGlvbiBhYm91dCB0aGlzIENWRSBzZWU6CisgKiBodHRwczovL3d3dy5zdXNlLmNv
bS9zZWN1cml0eS9jdmUvQ1ZFLTIwMTctODg5MC8KKyAqLworCisjaW5jbHVkZSA8ZXJybm8uaD4K
KyNpbmNsdWRlIDxzeXMvc29ja2V0Lmg+CisjaW5jbHVkZSAidHN0X3Rlc3QuaCIKKyNpbmNsdWRl
ICJ0c3Rfc2FmZV9uZXQuaCIKKyNpbmNsdWRlICJ0c3Rfc2FmZV9wdGhyZWFkLmgiCisKKyNkZWZp
bmUgTVVMVElDQVNUSVAgIjIyNC4wLjAuMCIKKyNkZWZpbmUgTE9DQUxIT1NUSVAgIjEyNy4wLjAu
MSIKKworc3RhdGljIGludCBzZXJ2ZXJfc29ja2ZkOworc3RhdGljIGludCBjbG9uZV9zZXJ2ZXJf
c29ja2ZkOworc3RhdGljIGludCBjbGllbnRfc29ja2ZkOworc3RhdGljIGludCBzZXJ2ZXJfcG9y
dDsKK3N0YXRpYyBzb2NrbGVuX3QgYWRkcl9sZW47CisKK3N0YXRpYyBzdHJ1Y3Qgc29ja2FkZHJf
aW4gc2VydmVyX2FkZHI7CitzdGF0aWMgc3RydWN0IHNvY2thZGRyX2luIGNsaWVudF9hZGRyOwor
c3RhdGljIHN0cnVjdCBncm91cF9yZXEgbWNfZ3JvdXA7CisKKworc3RhdGljIHZvaWQgKnNlcnZl
cl90aHJlYWQodm9pZCAqYXJnKQoreworCWludCBvcCwgb3BfbGVuLCBtY19ncm91cF9sZW47CisK
KwlvcCA9IDE7CisJb3BfbGVuID0gc2l6ZW9mKG9wKTsKKwltY19ncm91cF9sZW4gPSBzaXplb2Yo
bWNfZ3JvdXApOworCisJc2VydmVyX3NvY2tmZCA9IFNBRkVfU09DS0VUKEFGX0lORVQsIFNPQ0tf
U1RSRUFNLCAwKTsKKworCVNBRkVfU0VUU09DS09QVChzZXJ2ZXJfc29ja2ZkLCBTT0xfU09DS0VU
LCBTT19SRVVTRUFERFIsICZvcCwgb3BfbGVuKTsKKwlTQUZFX1NFVFNPQ0tPUFQoc2VydmVyX3Nv
Y2tmZCwgU09MX0lQLCBNQ0FTVF9KT0lOX0dST1VQLAorCQkJJm1jX2dyb3VwLCBtY19ncm91cF9s
ZW4pOworCisJU0FGRV9CSU5EKHNlcnZlcl9zb2NrZmQsIChzdHJ1Y3Qgc29ja2FkZHIgKikmc2Vy
dmVyX2FkZHIsIGFkZHJfbGVuKTsKKwlTQUZFX0xJU1RFTihzZXJ2ZXJfc29ja2ZkLCAxKTsKKwor
CVRTVF9DSEVDS1BPSU5UX1dBS0UoMCk7CisKKwlURVNUKGFjY2VwdChzZXJ2ZXJfc29ja2ZkLCAo
c3RydWN0IHNvY2thZGRyICopJmNsaWVudF9hZGRyLCAmYWRkcl9sZW4pKTsKKwlpZiAoVFNUX1JF
VCA9PSAtMSkKKwkJdHN0X2JyayhUQlJPSyB8IFRURVJSTk8sICJDb3VsZCBub3QgYWNjZXB0IGNv
bm5lY3Rpb24iKTsKKworCWNsb25lX3NlcnZlcl9zb2NrZmQgPSBUU1RfUkVUOworCisJVEVTVChz
ZXRzb2Nrb3B0KGNsb25lX3NlcnZlcl9zb2NrZmQsIFNPTF9JUCwgTUNBU1RfTEVBVkVfR1JPVVAs
CisJCQkmbWNfZ3JvdXAsIG1jX2dyb3VwX2xlbikpOworCisJaWYgKFRTVF9SRVQgIT0gLTEpCisJ
CXRzdF9yZXMoVEZBSUwsICJNdWx0aWNhc3QgZ3JvdXAgd2FzIGNvcGllZCEiKTsKKwllbHNlIGlm
IChUU1RfRVJSID09IEVBRERSTk9UQVZBSUwpCisJCXRzdF9yZXMoVFBBU1MgfCBUVEVSUk5PLCAi
TXVsdGljYXN0IGdyb3VwIHdhcyBub3QgY29waWVkIik7CisJZWxzZQorCQl0c3RfYnJrKFRCUk9L
IHwgVFRFUlJOTywgInNldHNvY2tvcHQoKSBmYWlsZWQgdW5leHBlY3RlZGx5Iik7CisKKwlTQUZF
X0NMT1NFKHNlcnZlcl9zb2NrZmQpOworCXJldHVybiBhcmc7Cit9CisKK3N0YXRpYyB2b2lkICpj
bGllbnRfdGhyZWFkKHZvaWQgKmFyZykKK3sKKwljbGllbnRfc29ja2ZkID0gU0FGRV9TT0NLRVQo
QUZfSU5FVCwgU09DS19TVFJFQU0sIDApOworCVNBRkVfQklORChjbGllbnRfc29ja2ZkLCAoc3Ry
dWN0IHNvY2thZGRyICopJmNsaWVudF9hZGRyLCBhZGRyX2xlbik7CisKKwlTQUZFX0NPTk5FQ1Qo
Y2xpZW50X3NvY2tmZCwgKHN0cnVjdCBzb2NrYWRkciAqKSZzZXJ2ZXJfYWRkciwgYWRkcl9sZW4p
OworCisJU0FGRV9DTE9TRShjbGllbnRfc29ja2ZkKTsKKwlyZXR1cm4gYXJnOworfQorCitzdGF0
aWMgdm9pZCBydW4odm9pZCkKK3sKKwlwdGhyZWFkX3Qgc2VydmVyX3RociwgY2xpZW50X3RocjsK
KworCXNlcnZlcl9hZGRyLnNpbl9wb3J0ID0gaHRvbnMoc2VydmVyX3BvcnQpOworCWNsaWVudF9h
ZGRyLnNpbl9wb3J0ID0gaHRvbnMoMCk7CisKKwlTQUZFX1BUSFJFQURfQ1JFQVRFKCZzZXJ2ZXJf
dGhyLCBOVUxMLCBzZXJ2ZXJfdGhyZWFkLCBOVUxMKTsKKwlUU1RfQ0hFQ0tQT0lOVF9XQUlUKDAp
OworCVNBRkVfUFRIUkVBRF9DUkVBVEUoJmNsaWVudF90aHIsIE5VTEwsIGNsaWVudF90aHJlYWQs
IE5VTEwpOworCisJU0FGRV9QVEhSRUFEX0pPSU4oc2VydmVyX3RociwgTlVMTCk7CisJU0FGRV9Q
VEhSRUFEX0pPSU4oY2xpZW50X3RociwgTlVMTCk7Cit9CisKK3N0YXRpYyB2b2lkIHNldHVwKHZv
aWQpCit7CisJc3RydWN0IHNvY2thZGRyX2luICptY19ncm91cF9hZGRyOworCisJbWNfZ3JvdXAu
Z3JfaW50ZXJmYWNlID0gMDsKKwltY19ncm91cF9hZGRyID0gKHN0cnVjdCBzb2NrYWRkcl9pbiAq
KSAmbWNfZ3JvdXAuZ3JfZ3JvdXA7CisJbWNfZ3JvdXBfYWRkci0+c2luX2ZhbWlseSA9IEFGX0lO
RVQ7CisJaW5ldF9hdG9uKE1VTFRJQ0FTVElQLCAmbWNfZ3JvdXBfYWRkci0+c2luX2FkZHIpOwor
CisJc2VydmVyX2FkZHIuc2luX2ZhbWlseSA9IEFGX0lORVQ7CisJaW5ldF9hdG9uKExPQ0FMSE9T
VElQLCAmc2VydmVyX2FkZHIuc2luX2FkZHIpOworCisJY2xpZW50X2FkZHIuc2luX2ZhbWlseSA9
IEFGX0lORVQ7CisJY2xpZW50X2FkZHIuc2luX2FkZHIuc19hZGRyID0gaHRvbnMoSU5BRERSX0FO
WSk7CisKKwlhZGRyX2xlbiA9IHNpemVvZihzdHJ1Y3Qgc29ja2FkZHJfaW4pOworCisJc2VydmVy
X3BvcnQgPSBUU1RfR0VUX1VOVVNFRF9QT1JUKEFGX0lORVQsIFNPQ0tfU1RSRUFNKTsKKwl0c3Rf
cmVzKFRJTkZPLCAiU3RhcnRpbmcgbGlzdGVuZXIgb24gcG9ydDogJWQiLCBzZXJ2ZXJfcG9ydCk7
Cit9CisKK3N0YXRpYyB2b2lkIGNsZWFudXAodm9pZCkKK3sKKwlpZiAoY2xvbmVfc2VydmVyX3Nv
Y2tmZCA+IDApCisJCVNBRkVfQ0xPU0UoY2xvbmVfc2VydmVyX3NvY2tmZCk7CisJaWYgKGNsaWVu
dF9zb2NrZmQgPiAwKQorCQlTQUZFX0NMT1NFKGNsaWVudF9zb2NrZmQpOworCWlmIChzZXJ2ZXJf
c29ja2ZkID4gMCkKKwkJU0FGRV9DTE9TRShzZXJ2ZXJfc29ja2ZkKTsKK30KKworc3RhdGljIHN0
cnVjdCB0c3RfdGVzdCB0ZXN0ID0geworCS50ZXN0X2FsbCA9IHJ1biwKKwkuc2V0dXAgPSBzZXR1
cCwKKwkuY2xlYW51cCA9IGNsZWFudXAsCisJLm5lZWRzX2NoZWNrcG9pbnRzID0gMSwKKwkubmVl
ZHNfcm9vdCA9IDEsCit9OwotLSAKMi4xNi40CgoKLS0gCk1haWxpbmcgbGlzdCBpbmZvOiBodHRw
czovL2xpc3RzLmxpbnV4Lml0L2xpc3RpbmZvL2x0cAo=
