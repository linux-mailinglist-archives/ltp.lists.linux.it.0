Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [213.254.12.146])
	by mail.lfdr.de (Postfix) with ESMTPS id 07AB592E388
	for <lists+linux-ltp@lfdr.de>; Thu, 11 Jul 2024 11:34:10 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id 4A4813CC598
	for <lists+linux-ltp@lfdr.de>; Thu, 11 Jul 2024 11:34:09 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-7.smtp.seeweb.it (in-7.smtp.seeweb.it
 [IPv6:2001:4b78:1:20::7])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature ECDSA (secp384r1))
 (No client certificate requested)
 by picard.linux.it (Postfix) with ESMTPS id B79533C2220
 for <ltp@lists.linux.it>; Thu, 11 Jul 2024 11:34:07 +0200 (CEST)
Authentication-Results: in-7.smtp.seeweb.it; spf=pass (sender SPF authorized)
 smtp.mailfrom=redhat.com (client-ip=170.10.129.124;
 helo=us-smtp-delivery-124.mimecast.com; envelope-from=liwan@redhat.com;
 receiver=lists.linux.it)
Received: from us-smtp-delivery-124.mimecast.com
 (us-smtp-delivery-124.mimecast.com [170.10.129.124])
 (using TLSv1.3 with cipher TLS_AES_256_GCM_SHA384 (256/256 bits)
 key-exchange X25519 server-signature RSA-PSS (2048 bits) server-digest SHA256)
 (No client certificate requested)
 by in-7.smtp.seeweb.it (Postfix) with ESMTPS id 116B120A6CC
 for <ltp@lists.linux.it>; Thu, 11 Jul 2024 11:34:05 +0200 (CEST)
DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed; d=redhat.com;
 s=mimecast20190719; t=1720690444;
 h=from:from:reply-to:subject:subject:date:date:message-id:message-id:
 to:to:cc:cc:mime-version:mime-version:content-type:content-type:
 in-reply-to:in-reply-to:references:references;
 bh=Hg/wJ51oWZ7Hmmv+8F5ONhz5RKVLGz9S/XTywfW+Z6Q=;
 b=LBlGUHxvjh20bEmX5d2PIQGBWJVmy0mK1D3njyNQsRaL6t0o2c5CHCBDkslIGdoElrHPcT
 Tmv5T/fS4VMflQnrz2d2aAl5ardTIo3i4BbilaSetsOCOgyzszJe59goXanssN5Z9/G5KJ
 3ffhemmugEq27pE6KyUKL0pvOo+i8Dk=
Received: from mail-pj1-f69.google.com (mail-pj1-f69.google.com
 [209.85.216.69]) by relay.mimecast.com with ESMTP with STARTTLS
 (version=TLSv1.3, cipher=TLS_AES_256_GCM_SHA384) id
 us-mta-643-j8Kgq1ovNFaMv_zv2cynRw-1; Thu, 11 Jul 2024 05:34:02 -0400
X-MC-Unique: j8Kgq1ovNFaMv_zv2cynRw-1
Received: by mail-pj1-f69.google.com with SMTP id
 98e67ed59e1d1-2c974ec599cso557340a91.1
 for <ltp@lists.linux.it>; Thu, 11 Jul 2024 02:34:02 -0700 (PDT)
X-Google-DKIM-Signature: v=1; a=rsa-sha256; c=relaxed/relaxed;
 d=1e100.net; s=20230601; t=1720690441; x=1721295241;
 h=cc:to:subject:message-id:date:from:in-reply-to:references
 :mime-version:x-gm-message-state:from:to:cc:subject:date:message-id
 :reply-to;
 bh=Hg/wJ51oWZ7Hmmv+8F5ONhz5RKVLGz9S/XTywfW+Z6Q=;
 b=aDz9AhfppJorYc1PHcwBuXrj6oxMq8WIPIel+nu75+rE2I4u67B0S7mIeIXg9KSTvi
 HVMJMlFJVX6kzLEWmyNm/opAKV7yfDk3C3Rtktdz7JghGDKPBUiushponLaQ2sF7mzzE
 vninWilxZToU/6pumLnyMeNXdmWLqVCtCZicJgsUUXGKCFj1yCcX1vg6oDZxoljK48I0
 vHDjANQA+o1AfSNqBp6jTF1Q+wdeRfBS6Qpkk9UqQkEhDBbPi9lQTklM+7zzDdiG2mQs
 /PGVUp09116xCW2CYmoyj3XIQDH++FVtLOGouuey9oezhn3EfKK74fgXxuLKmMcVcQbX
 k3Yg==
X-Gm-Message-State: AOJu0YwPAKk687X55yxMzJ4iqHlKQAwCcPCSbLV6hgQJ0VBle3Uaiv3r
 RLxA3eEiC45aM2t12vvXNTE4ytds4fNZc7a3ZoLhnuMJAk+r6m4RjC6arjSt79ve/6RN7b927Ra
 27I0ZsOwawZhTlzBvKNzRImbi5FXpjm8x7OC5OZYYYu9pFTFuXoMswQQbtTydJ01KOTVXNrFvlP
 K6l1F6boBbwNUNdg3T99BqS4M=
X-Received: by 2002:a17:90b:33cc:b0:2c9:6aab:67c4 with SMTP id
 98e67ed59e1d1-2ca9d8844b6mr2996697a91.10.1720690441034; 
 Thu, 11 Jul 2024 02:34:01 -0700 (PDT)
X-Google-Smtp-Source: AGHT+IE7x/IC17u84D+m/58Y4uehounMnTJqmocPP4tbR0egKPrbgflMtv34Rihy4Sq4bG3rsFwtXpyt/CyxS+c4MFE=
X-Received: by 2002:a17:90b:33cc:b0:2c9:6aab:67c4 with SMTP id
 98e67ed59e1d1-2ca9d8844b6mr2996656a91.10.1720690440332; Thu, 11 Jul 2024
 02:34:00 -0700 (PDT)
MIME-Version: 1.0
References: <20240710-landlock-v2-0-ff79db017d57@suse.com>
 <20240710-landlock-v2-9-ff79db017d57@suse.com>
In-Reply-To: <20240710-landlock-v2-9-ff79db017d57@suse.com>
From: Li Wang <liwang@redhat.com>
Date: Thu, 11 Jul 2024 17:33:48 +0800
Message-ID: <CAEemH2crUwPREXw=QTWSNEUk-_cs0vLeg_VYAgyBuUe5Cet3ow@mail.gmail.com>
To: Andrea Cervesato <andrea.cervesato@suse.de>
X-Mimecast-Spam-Score: 0
X-Mimecast-Originator: redhat.com
X-Spam-Status: No, score=0.1 required=7.0 tests=DKIM_SIGNED,DKIM_VALID,
 DKIM_VALID_AU,DKIM_VALID_EF,HTML_MESSAGE,SPF_HELO_NONE,SPF_PASS
 shortcircuit=no autolearn=disabled version=4.0.0
X-Spam-Checker-Version: SpamAssassin 4.0.0 (2022-12-13) on in-7.smtp.seeweb.it
X-Virus-Scanned: clamav-milter 1.0.3 at in-7.smtp.seeweb.it
X-Virus-Status: Clean
X-Content-Filtered-By: Mailman/MimeDel 2.1.29
Subject: Re: [LTP] [PATCH v2 09/11] Add landlock04 test
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.29
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Cc: ltp@lists.linux.it
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

T24gVGh1LCBKdWwgMTEsIDIwMjQgYXQgMjowNeKAr0FNIEFuZHJlYSBDZXJ2ZXNhdG8gPGFuZHJl
YS5jZXJ2ZXNhdG9Ac3VzZS5kZT4Kd3JvdGU6Cgo+IEZyb206IEFuZHJlYSBDZXJ2ZXNhdG8gPGFu
ZHJlYS5jZXJ2ZXNhdG9Ac3VzZS5jb20+Cj4KPiBUaGlzIHRlc3QgdmVyaWZpZXMgdGhhdCBhbGwg
bGFuZGxvY2sgcnVsZXMgYXJlIHdvcmtpbmcgcHJvcGVybHkuCj4gVGhlIHdheSB3ZSBkbyBpdCBp
cyB0byB2ZXJpZnkgdGhhdCBhbGwgZGlzYWJsZWQgc3lzY2FsbHMgYXJlIG5vdAo+IHdvcmtpbmcg
YnV0IHRoZSBvbmUgd2UgZW5hYmxlZCB2aWEgc3BlY2lmYyBsYW5kbG9jayBydWxlcy4KPgo+IFNp
Z25lZC1vZmYtYnk6IEFuZHJlYSBDZXJ2ZXNhdG8gPGFuZHJlYS5jZXJ2ZXNhdG9Ac3VzZS5jb20+
Cj4gLS0tCj4gIHJ1bnRlc3Qvc3lzY2FsbHMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAg
ICAgIHwgICAxICsKPiAgdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9sYW5kbG9jay8uZ2l0aWdu
b3JlICAgICAgfCAgIDIgKwo+ICB0ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xh
bmRsb2NrMDQuYyAgICB8IDE3NiArKysrKysrKysrKwo+ICB0ZXN0Y2FzZXMva2VybmVsL3N5c2Nh
bGxzL2xhbmRsb2NrL2xhbmRsb2NrX2V4ZWMuYyB8ICAgOSArCj4gIC4uLi9rZXJuZWwvc3lzY2Fs
bHMvbGFuZGxvY2svbGFuZGxvY2tfdGVzdGVyLmggICAgIHwgMzUwCj4gKysrKysrKysrKysrKysr
KysrKysrCj4gIDUgZmlsZXMgY2hhbmdlZCwgNTM4IGluc2VydGlvbnMoKykKPgo+IGRpZmYgLS1n
aXQgYS9ydW50ZXN0L3N5c2NhbGxzIGIvcnVudGVzdC9zeXNjYWxscwo+IGluZGV4IDI2OWNmMjRi
MS4uMTBiNTRhZTg0IDEwMDY0NAo+IC0tLSBhL3J1bnRlc3Qvc3lzY2FsbHMKPiArKysgYi9ydW50
ZXN0L3N5c2NhbGxzCj4gQEAgLTY4Nyw2ICs2ODcsNyBAQCBraWxsMTMga2lsbDEzCj4gIGxhbmRs
b2NrMDEgbGFuZGxvY2swMQo+ICBsYW5kbG9jazAyIGxhbmRsb2NrMDIKPiAgbGFuZGxvY2swMyBs
YW5kbG9jazAzCj4gK2xhbmRsb2NrMDQgbGFuZGxvY2swNAo+Cj4gIGxjaG93bjAxIGxjaG93bjAx
Cj4gIGxjaG93bjAxXzE2IGxjaG93bjAxXzE2Cj4gZGlmZiAtLWdpdCBhL3Rlc3RjYXNlcy9rZXJu
ZWwvc3lzY2FsbHMvbGFuZGxvY2svLmdpdGlnbm9yZQo+IGIvdGVzdGNhc2VzL2tlcm5lbC9zeXNj
YWxscy9sYW5kbG9jay8uZ2l0aWdub3JlCj4gaW5kZXggZjc5Y2QwOTBiLi40ZmU4ZDdjYmEgMTAw
NjQ0Cj4gLS0tIGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9sYW5kbG9jay8uZ2l0aWdub3Jl
Cj4gKysrIGIvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9sYW5kbG9jay8uZ2l0aWdub3JlCj4g
QEAgLTEsMyArMSw1IEBACj4gK2xhbmRsb2NrX2V4ZWMKPiAgbGFuZGxvY2swMQo+ICBsYW5kbG9j
azAyCj4gIGxhbmRsb2NrMDMKPiArbGFuZGxvY2swNAo+IGRpZmYgLS1naXQgYS90ZXN0Y2FzZXMv
a2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2NrMDQuYwo+IGIvdGVzdGNhc2VzL2tlcm5l
bC9zeXNjYWxscy9sYW5kbG9jay9sYW5kbG9jazA0LmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+
IGluZGV4IDAwMDAwMDAwMC4uMTU2NzMyOGJiCj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL3Rlc3Rj
YXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxvY2svbGFuZGxvY2swNC5jCj4gQEAgLTAsMCArMSwx
NzYgQEAKPiArLy8gU1BEWC1MaWNlbnNlLUlkZW50aWZpZXI6IEdQTC0yLjAtb3ItbGF0ZXIKPiAr
LyoKPiArICogQ29weXJpZ2h0IChDKSAyMDI0IFNVU0UgTExDIEFuZHJlYSBDZXJ2ZXNhdG8gPAo+
IGFuZHJlYS5jZXJ2ZXNhdG9Ac3VzZS5jb20+Cj4gKyAqLwo+ICsKPiArLypcCj4gKyAqIFtEZXNj
cmlwdGlvbl0KPiArICoKPiArICogVGhpcyB0ZXN0IHZlcmlmaWVzIHRoYXQgYWxsIGxhbmRsb2Nr
IHJ1bGVzIGFyZSB3b3JraW5nIHByb3Blcmx5LiBUaGUKPiB3YXkgd2UKPiArICogZG8gaXQgaXMg
dG8gdmVyaWZ5IHRoYXQgYWxsIGRpc2FibGVkIHN5c2NhbGxzIGFyZSBub3Qgd29ya2luZyBidXQg
dGhlCj4gb25lIHdlCj4gKyAqIGVuYWJsZWQgdmlhIHNwZWNpZmMgbGFuZGxvY2sgcnVsZXMuCj4g
KyAqLwo+ICsKPiArI2luY2x1ZGUgImxhbmRsb2NrX2NvbW1vbi5oIgo+ICsjaW5jbHVkZSAibGFu
ZGxvY2tfdGVzdGVyLmgiCj4gKwo+ICsjZGVmaW5lIEFDQ0VTU19OQU1FKHgpICN4Cj4gKwo+ICtz
dGF0aWMgc3RydWN0IGxhbmRsb2NrX3J1bGVzZXRfYXR0ciAqcnVsZXNldF9hdHRyOwo+ICtzdGF0
aWMgc3RydWN0IGxhbmRsb2NrX3BhdGhfYmVuZWF0aF9hdHRyICpwYXRoX2JlbmVhdGhfYXR0cjsK
PiArCj4gK3N0cnVjdCBydWxlX2FjY2VzcyB7Cj4gKyAgICAgICBjaGFyICpwYXRoOwo+ICsgICAg
ICAgaW50IGFjY2VzczsKPiArfTsKPiArCj4gK3N0YXRpYyBzdHJ1Y3QgdHZhcmlhbnQgewo+ICsg
ICAgICAgaW50IGFjY2VzczsKPiArICAgICAgIGNoYXIgKmRlc2M7Cj4gK30gdHZhcmlhbnRzW10g
PSB7Cj4gKyAgICAgICB7Cj4gKyAgICAgICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19SRUFE
X0ZJTEUgfCBMQU5ETE9DS19BQ0NFU1NfRlNfRVhFQ1VURSwKPiArICAgICAgICAgICAgICAgQUND
RVNTX05BTUUoTEFORExPQ0tfQUNDRVNTX0ZTX0VYRUNVVEUpCj4gKyAgICAgICB9LAo+ICsgICAg
ICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfV1JJVEVfRklMRSwKPiAr
ICAgICAgICAgICAgICAgQUNDRVNTX05BTUUoTEFORExPQ0tfQUNDRVNTX0ZTX1dSSVRFX0ZJTEUp
Cj4gKyAgICAgICB9LAo+ICsgICAgICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NF
U1NfRlNfUkVBRF9GSUxFLAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19B
Q0NFU1NfRlNfUkVBRF9GSUxFKQo+ICsgICAgICAgfSwKPiArICAgICAgIHsKPiArICAgICAgICAg
ICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX1JFQURfRElSLAo+ICsgICAgICAgICAgICAgICBBQ0NF
U1NfTkFNRShMQU5ETE9DS19BQ0NFU1NfRlNfUkVBRF9ESVIpCj4gKyAgICAgICB9LAo+ICsgICAg
ICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfUkVNT1ZFX0RJUiwKPiAr
ICAgICAgICAgICAgICAgQUNDRVNTX05BTUUoTEFORExPQ0tfQUNDRVNTX0ZTX1JFTU9WRV9ESVIp
Cj4gKyAgICAgICB9LAo+ICsgICAgICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NF
U1NfRlNfUkVNT1ZFX0ZJTEUsCj4gKyAgICAgICAgICAgICAgIEFDQ0VTU19OQU1FKExBTkRMT0NL
X0FDQ0VTU19GU19SRU1PVkVfRklMRSkKPiArICAgICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAg
ICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX0NIQVIsCj4gKyAgICAgICAgICAgICAg
IEFDQ0VTU19OQU1FKExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX0NIQVIpCj4gKyAgICAgICB9LAo+
ICsgICAgICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9CTE9D
SywKPiArICAgICAgICAgICAgICAgQUNDRVNTX05BTUUoTEFORExPQ0tfQUNDRVNTX0ZTX01BS0Vf
QkxPQ0spCj4gKyAgICAgICB9LAo+ICsgICAgICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9D
S19BQ0NFU1NfRlNfTUFLRV9SRUcsCj4gKyAgICAgICAgICAgICAgIEFDQ0VTU19OQU1FKExBTkRM
T0NLX0FDQ0VTU19GU19NQUtFX1JFRykKPiArICAgICAgIH0sCj4gKyAgICAgICB7Cj4gKyAgICAg
ICAgICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX1NPQ0ssCj4gKyAgICAgICAgICAgICAg
IEFDQ0VTU19OQU1FKExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX1NPQ0spCj4gKyAgICAgICB9LAo+
ICsgICAgICAgewo+ICsgICAgICAgICAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9GSUZP
LAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9G
SUZPKQo+ICsgICAgICAgfSwKPiArICAgICAgIHsKPiArICAgICAgICAgICAgICAgTEFORExPQ0tf
QUNDRVNTX0ZTX01BS0VfU1lNLAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9D
S19BQ0NFU1NfRlNfTUFLRV9TWU0pCj4gKyAgICAgICB9LAo+ICsgICAgICAgewo+ICsgICAgICAg
ICAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfV1JJVEVfRklMRSB8Cj4gTEFORExPQ0tfQUNDRVNT
X0ZTX1RSVU5DQVRFLAo+ICsgICAgICAgICAgICAgICBBQ0NFU1NfTkFNRShMQU5ETE9DS19BQ0NF
U1NfRlNfVFJVTkNBVEUpCj4gKyAgICAgICB9LAo+ICt9Owo+ICsKPiArc3RhdGljIHZvaWQgcnVu
KHZvaWQpCj4gK3sKPiArICAgICAgIGlmICghU0FGRV9GT1JLKCkpIHsKPiArICAgICAgICAgICAg
ICAgc3RydWN0IHR2YXJpYW50ICB2YXJpYW50ID0gdHZhcmlhbnRzW3RzdF92YXJpYW50XTsKPiAr
Cj4gKyAgICAgICAgICAgICAgIHRlc3Rlcl9ydW5fYWxsX3J1bGVzKHZhcmlhbnQuYWNjZXNzKTsK
PiArICAgICAgICAgICAgICAgX2V4aXQoMCk7Cj4gKyAgICAgICB9Cj4gK30KPiArCj4gK3N0YXRp
YyB2b2lkIHNldHVwKHZvaWQpCj4gK3sKPiArICAgICAgIHN0cnVjdCB0dmFyaWFudCB2YXJpYW50
ID0gdHZhcmlhbnRzW3RzdF92YXJpYW50XTsKPiArICAgICAgIGludCBydWxlc2V0X2ZkOwo+ICsK
PiArICAgICAgIHZlcmlmeV9sYW5kbG9ja19pc19lbmFibGVkKCk7Cj4gKyAgICAgICB0ZXN0ZXJf
Y3JlYXRlX3RyZWUoKTsKPiArCj4gKyAgICAgICB0c3RfcmVzKFRJTkZPLCAiVGVzdGluZyAlcyIs
IHZhcmlhbnQuZGVzYyk7Cj4gKwo+ICsgICAgICAgcnVsZXNldF9hdHRyLT5oYW5kbGVkX2FjY2Vz
c19mcyA9IHRlc3Rlcl9nZXRfYWxsX3J1bGVzKCk7Cj4gKwo+ICsgICAgICAgcnVsZXNldF9mZCA9
IFNBRkVfTEFORExPQ0tfQ1JFQVRFX1JVTEVTRVQoCj4gKyAgICAgICAgICAgICAgIHJ1bGVzZXRf
YXR0ciwgc2l6ZW9mKHN0cnVjdCBsYW5kbG9ja19ydWxlc2V0X2F0dHIpLCAwKTsKPiArCj4gKyAg
ICAgICAvKiBzaW5jZSBvdXIgYmluYXJ5IGlzIGR5bmFtaWNhbGx5IGxpbmtlZCwgd2UgbmVlZCB0
byBlbmFibGUKPiBsaWJyYXJpZXMKPiArICAgICAgICAqIHRvIGJlIHJlYWQgYW5kIGV4ZWN1dGVk
Cj4gKyAgICAgICAgKi8KPiArICAgICAgIHN0cnVjdCBydWxlX2FjY2VzcyBydWxlc1tdID0gewo+
ICsgICAgICAgICAgICAgICB7Ii9saWIiLCBMQU5ETE9DS19BQ0NFU1NfRlNfUkVBRF9GSUxFIHwK
PiBMQU5ETE9DS19BQ0NFU1NfRlNfRVhFQ1VURX0sCj4gKyAgICAgICAgICAgICAgIHsiL2xpYjY0
IiwgTEFORExPQ0tfQUNDRVNTX0ZTX1JFQURfRklMRSB8Cj4gTEFORExPQ0tfQUNDRVNTX0ZTX0VY
RUNVVEV9LAo+ICsgICAgICAgICAgICAgICB7U0FOREJPWF9GT0xERVIsIHZhcmlhbnQuYWNjZXNz
fQo+ICsgICAgICAgfTsKPgoKR29vZCBtZXRob2QsIGJ1dCBjYW4gd2UgZmluZCBhIHdheSB0byBn
ZXQgdGhlIGxpYi1zaGFyZWQgcGF0aCBhdXRvbWF0aWNhbGx5CmJ1dCBub3QgaGFyZCBjb2Rpbmc/
CgpTb21lIHBsYXRmb3JtcyBtYXkgaGF2ZSBhbm90aGVyIGNvbmZpZ3VyYXRpb24gb24gdGhlIHNo
YXJlZC1saWIgcGF0aC4KCgoKPiArICAgICAgIGludCBudW1fb2ZfcnVsZXMgPSBBUlJBWV9TSVpF
KHJ1bGVzKTsKPiArCj4gKyAgICAgICBmb3IgKGludCBpID0gMDsgaSA8IG51bV9vZl9ydWxlczsg
aSsrKSB7Cj4gKyAgICAgICAgICAgICAgIGlmIChhY2Nlc3MocnVsZXNbaV0ucGF0aCwgRl9PSykg
PT0gLTEpCj4gKyAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gKwo+ICsgICAgICAg
ICAgICAgICBwYXRoX2JlbmVhdGhfYXR0ci0+YWxsb3dlZF9hY2Nlc3MgPSBydWxlc1tpXS5hY2Nl
c3M7Cj4gKyAgICAgICAgICAgICAgIHBhdGhfYmVuZWF0aF9hdHRyLT5wYXJlbnRfZmQgPSBTQUZF
X09QRU4ocnVsZXNbaV0ucGF0aCwKPiBPX1BBVEggfCBPX0NMT0VYRUMpOwo+ICsKPiArICAgICAg
ICAgICAgICAgU0FGRV9MQU5ETE9DS19BRERfUlVMRSgKPiArICAgICAgICAgICAgICAgICAgICAg
ICBydWxlc2V0X2ZkLAo+ICsgICAgICAgICAgICAgICAgICAgICAgIExBTkRMT0NLX1JVTEVfUEFU
SF9CRU5FQVRILAo+ICsgICAgICAgICAgICAgICAgICAgICAgIHBhdGhfYmVuZWF0aF9hdHRyLAo+
ICsgICAgICAgICAgICAgICAgICAgICAgIDApOwo+ICsKPiArICAgICAgICAgICAgICAgU0FGRV9D
TE9TRShwYXRoX2JlbmVhdGhfYXR0ci0+cGFyZW50X2ZkKTsKPiArICAgICAgIH0KPiArCj4gKyAg
ICAgICBlbmZvcmNlX3J1bGVzZXQocnVsZXNldF9mZCk7Cj4gKyAgICAgICBTQUZFX0NMT1NFKHJ1
bGVzZXRfZmQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgc3RydWN0IHRzdF90ZXN0IHRlc3QgPSB7Cj4g
KyAgICAgICAudGVzdF9hbGwgPSBydW4sCj4gKyAgICAgICAuc2V0dXAgPSBzZXR1cCwKPiArICAg
ICAgIC5taW5fa3ZlciA9ICI1LjEzIiwKPiArICAgICAgIC5mb3Jrc19jaGlsZCA9IDEsCj4gKyAg
ICAgICAubmVlZHNfdG1wZGlyID0gMSwKPiArICAgICAgIC5uZWVkc19yb290ID0gMSwKPiArICAg
ICAgIC50ZXN0X3ZhcmlhbnRzID0gQVJSQVlfU0laRSh0dmFyaWFudHMpLAo+ICsgICAgICAgLnJl
c291cmNlX2ZpbGVzID0gKGNvbnN0IGNoYXIgKltdKSB7Cj4gKyAgICAgICAgICAgICAgIFRFU1RB
UFAsCj4gKyAgICAgICAgICAgICAgIE5VTEwsCj4gKyAgICAgICB9LAo+ICsgICAgICAgLm5lZWRz
X2tjb25maWdzID0gKGNvbnN0IGNoYXIgKltdKSB7Cj4gKyAgICAgICAgICAgICAgICJDT05GSUdf
U0VDVVJJVFlfTEFORExPQ0s9eSIsCj4gKyAgICAgICAgICAgICAgIE5VTEwKPiArICAgICAgIH0s
Cj4gKyAgICAgICAuYnVmcyA9IChzdHJ1Y3QgdHN0X2J1ZmZlcnMgW10pIHsKPiArICAgICAgICAg
ICAgICAgeyZydWxlc2V0X2F0dHIsIC5zaXplID0gc2l6ZW9mKHN0cnVjdAo+IGxhbmRsb2NrX3J1
bGVzZXRfYXR0cil9LAo+ICsgICAgICAgICAgICAgICB7JnBhdGhfYmVuZWF0aF9hdHRyLCAuc2l6
ZSA9IHNpemVvZihzdHJ1Y3QKPiBsYW5kbG9ja19wYXRoX2JlbmVhdGhfYXR0cil9LAo+ICsgICAg
ICAgICAgICAgICB7fSwKPiArICAgICAgIH0sCj4gKyAgICAgICAuY2FwcyA9IChzdHJ1Y3QgdHN0
X2NhcCBbXSkgewo+ICsgICAgICAgICAgICAgICBUU1RfQ0FQKFRTVF9DQVBfUkVRLCBDQVBfU1lT
X0FETUlOKSwKPiArICAgICAgICAgICAgICAgVFNUX0NBUChUU1RfQ0FQX1JFUSwgQ0FQX01LTk9E
KSwKPiArICAgICAgICAgICAgICAge30KPiArICAgICAgIH0sCj4gKyAgICAgICAuZm9ybWF0X2Rl
dmljZSA9IDEsCj4gKyAgICAgICAubW91bnRfZGV2aWNlID0gMSwKPiArICAgICAgIC5tbnRwb2lu
dCA9IFNBTkRCT1hfRk9MREVSLAo+ICsgICAgICAgLmFsbF9maWxlc3lzdGVtcyA9IDEsCj4gKyAg
ICAgICAuc2tpcF9maWxlc3lzdGVtcyA9IChjb25zdCBjaGFyICpbXSkgewo+ICsgICAgICAgICAg
ICAgICAidmZhdCIsCj4gKyAgICAgICAgICAgICAgICJleGZhdCIsCj4gKyAgICAgICAgICAgICAg
IE5VTEwKPiArICAgICAgIH0sCj4gKyAgICAgICAubWF4X3J1bnRpbWUgPSAzNjAwLAo+ICt9Owo+
IGRpZmYgLS1naXQgYS90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL2xhbmRsb2NrL2xhbmRsb2Nr
X2V4ZWMuYwo+IGIvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9sYW5kbG9jay9sYW5kbG9ja19l
eGVjLmMKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMC4uYWFlNWM3NmIy
Cj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxv
Y2svbGFuZGxvY2tfZXhlYy5jCj4gQEAgLTAsMCArMSw5IEBACj4gKy8vIFNQRFgtTGljZW5zZS1J
ZGVudGlmaWVyOiBHUEwtMi4wLW9yLWxhdGVyCj4gKy8qCj4gKyAqIENvcHlyaWdodCAoQykgMjAy
NCBTVVNFIExMQyBBbmRyZWEgQ2VydmVzYXRvIDwKPiBhbmRyZWEuY2VydmVzYXRvQHN1c2UuY29t
Pgo+ICsgKi8KPiArCj4gK2ludCBtYWluKHZvaWQpCj4gK3sKPiArICAgICAgIHJldHVybiAwOwo+
ICt9Cj4gZGlmZiAtLWdpdCBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxvY2svbGFu
ZGxvY2tfdGVzdGVyLmgKPiBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvbGFuZGxvY2svbGFu
ZGxvY2tfdGVzdGVyLmgKPiBuZXcgZmlsZSBtb2RlIDEwMDY0NAo+IGluZGV4IDAwMDAwMDAwMC4u
ODljYTA4NWQ3Cj4gLS0tIC9kZXYvbnVsbAo+ICsrKyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2Fs
bHMvbGFuZGxvY2svbGFuZGxvY2tfdGVzdGVyLmgKPiBAQCAtMCwwICsxLDM1MCBAQAo+ICsvKiBT
UERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRlciAqLwo+ICsvKgo+ICsgKiBD
b3B5cmlnaHQgKEMpIDIwMjQgU1VTRSBMTEMgQW5kcmVhIENlcnZlc2F0byA8Cj4gYW5kcmVhLmNl
cnZlc2F0b0BzdXNlLmNvbT4KPiArICovCj4gKwo+ICsjaWZuZGVmIExBTkRMT0NLX1RFU1RFUl9I
Cj4gKwo+ICsjaW5jbHVkZSAidHN0X3Rlc3QuaCIKPiArI2luY2x1ZGUgImxhcGkvbGFuZGxvY2su
aCIKPiArI2luY2x1ZGUgPHN5cy9zeXNtYWNyb3MuaD4KPiArCj4gKyNkZWZpbmUgUEVSTV9NT0RF
IDA3MDAKPiArCj4gKyNkZWZpbmUgU0FOREJPWF9GT0xERVIgInNhbmRib3giCj4gKyNkZWZpbmUg
VEVTVEFQUCAgICAgICAgICAgICAgICAgICAgICAgICJsYW5kbG9ja19leGVjIgo+ICsKPiArI2Rl
ZmluZSBGSUxFX0VYRUMgICAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi8iVEVTVEFQUAo+ICsj
ZGVmaW5lIEZJTEVfUkVBRCAgICAgICAgICAgICAgU0FOREJPWF9GT0xERVIiL2ZpbGVfcmVhZCIK
PiArI2RlZmluZSBGSUxFX1dSSVRFICAgICAgICAgICAgIFNBTkRCT1hfRk9MREVSIi9maWxlX3dy
aXRlIgo+ICsjZGVmaW5lIEZJTEVfUkVNT1ZFICAgICAgICAgICAgU0FOREJPWF9GT0xERVIiL2Zp
bGVfcmVtb3ZlIgo+ICsjZGVmaW5lIEZJTEVfVU5MSU5LICAgICAgICAgICAgU0FOREJPWF9GT0xE
RVIiL2ZpbGVfdW5saW5rIgo+ICsjZGVmaW5lIEZJTEVfVU5MSU5LQVQgIFNBTkRCT1hfRk9MREVS
Ii9maWxlX3VubGlua2F0Igo+ICsjZGVmaW5lIEZJTEVfVFJVTkNBVEUgIFNBTkRCT1hfRk9MREVS
Ii9maWxlX3RydW5jYXRlIgo+ICsjZGVmaW5lIEZJTEVfUkVHVUxBUiAgIFNBTkRCT1hfRk9MREVS
Ii9yZWd1bGFyMCIKPiArI2RlZmluZSBGSUxFX1NPQ0tFVCAgICAgICAgICAgIFNBTkRCT1hfRk9M
REVSIi9zb2NrZXQwIgo+ICsjZGVmaW5lIEZJTEVfRklGTyAgICAgICAgICAgICAgU0FOREJPWF9G
T0xERVIiL2ZpZm8wIgo+ICsjZGVmaW5lIEZJTEVfU1lNMCAgICAgICAgICAgICAgU0FOREJPWF9G
T0xERVIiL3N5bWJvbGljMCIKPiArI2RlZmluZSBGSUxFX1NZTTEgICAgICAgICAgICAgIFNBTkRC
T1hfRk9MREVSIi9zeW1ib2xpYzEiCj4gKyNkZWZpbmUgRElSX1JFQURESVIgICAgICAgICAgICBT
QU5EQk9YX0ZPTERFUiIvZGlyX3JlYWRkaXIiCj4gKyNkZWZpbmUgRElSX1JNRElSICAgICAgICAg
ICAgICBTQU5EQk9YX0ZPTERFUiIvZGlyX3JtZGlyIgo+ICsjZGVmaW5lIERFVl9DSEFSMCAgICAg
ICAgICAgICAgU0FOREJPWF9GT0xERVIiL2NoYXJkZXYwIgo+ICsjZGVmaW5lIERFVl9CTEswICAg
ICAgICAgICAgICAgU0FOREJPWF9GT0xERVIiL2Jsa2RldjAiCj4gKwo+ICsjZGVmaW5lIEFMTF9S
VUxFUyAoXAo+ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX0VYRUNVVEUgfCBcCj4gKyAgICAg
ICBMQU5ETE9DS19BQ0NFU1NfRlNfV1JJVEVfRklMRSB8IFwKPiArICAgICAgIExBTkRMT0NLX0FD
Q0VTU19GU19SRUFEX0ZJTEUgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfUkVBRF9E
SVIgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfUkVNT1ZFX0RJUiB8IFwKPiArICAg
ICAgIExBTkRMT0NLX0FDQ0VTU19GU19SRU1PVkVfRklMRSB8IFwKPiArICAgICAgIExBTkRMT0NL
X0FDQ0VTU19GU19NQUtFX0NIQVIgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFL
RV9ESVIgfCBcCj4gKyAgICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9SRUcgfCBcCj4gKyAg
ICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9TT0NLIHwgXAo+ICsgICAgICAgTEFORExPQ0tf
QUNDRVNTX0ZTX01BS0VfRklGTyB8IFwKPiArICAgICAgIExBTkRMT0NLX0FDQ0VTU19GU19NQUtF
X0JMT0NLIHwgXAo+ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX01BS0VfU1lNIHwgXAo+ICsg
ICAgICAgTEFORExPQ0tfQUNDRVNTX0ZTX1JFRkVSIHwgXAo+ICsgICAgICAgTEFORExPQ0tfQUND
RVNTX0ZTX1RSVU5DQVRFIHwgXAo+ICsgICAgICAgTEFORExPQ0tfQUNDRVNTX05FVF9CSU5EX1RD
UCB8IFwKPiArICAgICAgIExBTkRMT0NLX0FDQ0VTU19ORVRfQ09OTkVDVF9UQ1AgfCBcCj4gKyAg
ICAgICBMQU5ETE9DS19BQ0NFU1NfRlNfSU9DVExfREVWKQo+ICsKPiArc3RhdGljIGNoYXIgKnJl
YWRkaXJfZmlsZXNbXSA9IHsKPiArICAgICAgIERJUl9SRUFERElSIi9maWxlMCIsCj4gKyAgICAg
ICBESVJfUkVBRERJUiIvZmlsZTEiLAo+ICsgICAgICAgRElSX1JFQURESVIiL2ZpbGUyIiwKPiAr
fTsKPiArCj4gK3N0YXRpYyBpbnQgZGV2X2NocjsKPiArc3RhdGljIGludCBkZXZfYmxrOwo+ICsK
PiArc3RhdGljIGludCB0ZXN0ZXJfZ2V0X2FsbF9ydWxlcyh2b2lkKQo+ICt7Cj4gKyAgICAgICBp
bnQgYWJpOwo+ICsgICAgICAgaW50IGFsbF9ydWxlcyA9IEFMTF9SVUxFUzsKPiArCj4gKyAgICAg
ICBhYmkgPSBTQUZFX0xBTkRMT0NLX0NSRUFURV9SVUxFU0VUKAo+ICsgICAgICAgICAgICAgICBO
VUxMLCAwLCBMQU5ETE9DS19DUkVBVEVfUlVMRVNFVF9WRVJTSU9OKTsKPiArCj4gKyAgICAgICBp
ZiAoYWJpIDwgMikKPiArICAgICAgICAgICAgICAgYWxsX3J1bGVzICY9IH5MQU5ETE9DS19BQ0NF
U1NfRlNfUkVGRVI7Cj4gKwo+ICsgICAgICAgaWYgKGFiaSA8IDMpCj4gKyAgICAgICAgICAgICAg
IGFsbF9ydWxlcyAmPSB+TEFORExPQ0tfQUNDRVNTX0ZTX1RSVU5DQVRFOwo+ICsKPiArICAgICAg
IGlmIChhYmkgPCA0KSB7Cj4gKyAgICAgICAgICAgICAgIGFsbF9ydWxlcyAmPSB+KExBTkRMT0NL
X0FDQ0VTU19ORVRfQklORF9UQ1AgfAo+ICsgICAgICAgICAgICAgICAgICAgICAgIExBTkRMT0NL
X0FDQ0VTU19ORVRfQ09OTkVDVF9UQ1ApOwo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIGlmIChh
YmkgPCA1KQo+ICsgICAgICAgICAgICAgICBhbGxfcnVsZXMgJj0gfkxBTkRMT0NLX0FDQ0VTU19G
U19JT0NUTF9ERVY7Cj4gKwo+ICsgICAgICAgcmV0dXJuIGFsbF9ydWxlczsKPiArfQo+ICsKPiAr
c3RhdGljIHZvaWQgdGVzdGVyX2NyZWF0ZV90cmVlKHZvaWQpCj4gK3sKPiArICAgICAgIGlmIChh
Y2Nlc3MoU0FOREJPWF9GT0xERVIsIEZfT0spID09IC0xKQo+ICsgICAgICAgICAgICAgICBTQUZF
X01LRElSKFNBTkRCT1hfRk9MREVSLCBQRVJNX01PREUpOwo+ICsKPiArICAgICAgIC8qIGZvbGRl
cnMgKi8KPiArICAgICAgIFNBRkVfTUtESVIoRElSX1JNRElSLCBQRVJNX01PREUpOwo+ICsgICAg
ICAgU0FGRV9NS0RJUihESVJfUkVBRERJUiwgUEVSTV9NT0RFKTsKPiArICAgICAgIGZvciAoc2l6
ZV90IGkgPSAwOyBpIDwgQVJSQVlfU0laRShyZWFkZGlyX2ZpbGVzKTsgaSsrKQo+ICsgICAgICAg
ICAgICAgICBTQUZFX1RPVUNIKHJlYWRkaXJfZmlsZXNbaV0sIFBFUk1fTU9ERSwgTlVMTCk7Cj4g
Kwo+ICsgICAgICAgLyogZmlsZXMgKi8KPiArICAgICAgIHRzdF9maWxsX2ZpbGUoRklMRV9SRUFE
LCAnYScsIGdldHBhZ2VzaXplKCksIDEpOwo+ICsgICAgICAgU0FGRV9UT1VDSChGSUxFX1dSSVRF
LCBQRVJNX01PREUsIE5VTEwpOwo+ICsgICAgICAgU0FGRV9UT1VDSChGSUxFX1JFTU9WRSwgUEVS
TV9NT0RFLCBOVUxMKTsKPiArICAgICAgIFNBRkVfVE9VQ0goRklMRV9VTkxJTkssIFBFUk1fTU9E
RSwgTlVMTCk7Cj4gKyAgICAgICBTQUZFX1RPVUNIKEZJTEVfVU5MSU5LQVQsIFBFUk1fTU9ERSwg
TlVMTCk7Cj4gKyAgICAgICBTQUZFX1RPVUNIKEZJTEVfVFJVTkNBVEUsIFBFUk1fTU9ERSwgTlVM
TCk7Cj4gKyAgICAgICBTQUZFX1RPVUNIKEZJTEVfU1lNMCwgUEVSTV9NT0RFLCBOVUxMKTsKPiAr
ICAgICAgIFNBRkVfQ1AoVEVTVEFQUCwgRklMRV9FWEVDKTsKPiArCj4gKyAgICAgICAvKiBkZXZp
Y2VzICovCj4gKyAgICAgICBkZXZfY2hyID0gbWFrZWRldigxLCAzKTsKPiArICAgICAgIGRldl9i
bGsgPSBtYWtlZGV2KDcsIDApOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfdGVzdF9leGVjKGNv
bnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAgIGludCBzdGF0dXM7Cj4gKyAgICAgICBwaWRf
dCBwaWQ7Cj4gKyAgICAgICBjaGFyICpjb25zdCBhcmdzW10gPSB7KGNoYXIgKilGSUxFX0VYRUMs
IE5VTEx9Owo+ICsKPiArICAgICAgIHRzdF9yZXMoVElORk8sICJUZXN0IGJpbmFyeSBleGVjdXRp
b24iKTsKPiArCj4gKyAgICAgICBwaWQgPSBTQUZFX0ZPUksoKTsKPiArICAgICAgIGlmICghcGlk
KSB7Cj4gKyAgICAgICAgICAgICAgIGludCBydmFsOwo+ICsKPiArICAgICAgICAgICAgICAgaWYg
KHJlc3VsdCA9PSBUUEFTUykgewo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJ2YWwgPSBleGVj
dmUoRklMRV9FWEVDLCBhcmdzLCBOVUxMKTsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAo
cnZhbCA9PSAtMSkKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRzdF9yZXMoVEZB
SUwgfCBURVJSTk8sICJGYWlsZWQgdG8gZXhlY3V0ZQo+IHRlc3QgYmluYXJ5Iik7Cj4gKyAgICAg
ICAgICAgICAgIH0gZWxzZSB7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgVFNUX0VYUF9GQUlM
KGV4ZWN2ZShGSUxFX0VYRUMsIGFyZ3MsIE5VTEwpLAo+IEVBQ0NFUyk7Cj4gKyAgICAgICAgICAg
ICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIF9leGl0KDEpOwo+ICsgICAgICAgfQo+ICsKPiAr
ICAgICAgIFNBRkVfV0FJVFBJRChwaWQsICZzdGF0dXMsIDApOwo+ICsgICAgICAgaWYgKCFXSUZF
WElURUQoc3RhdHVzKSB8fCBXRVhJVFNUQVRVUyhzdGF0dXMpICE9IDApCj4gKyAgICAgICAgICAg
ICAgIHJldHVybjsKPiArCj4gKyAgICAgICB0c3RfcmVzKHJlc3VsdCwgIlRlc3QgYmluYXJ5IGhh
cyBiZWVuIGV4ZWN1dGVkIik7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIF90ZXN0X3dyaXRlKGNv
bnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAgIHRzdF9yZXMoVElORk8sICJUZXN0IHdyaXRp
bmcgZmlsZSIpOwo+ICsKPiArICAgICAgIGlmIChyZXN1bHQgPT0gVFBBU1MpCj4gKyAgICAgICAg
ICAgICAgIFRTVF9FWFBfRkQob3BlbihGSUxFX1dSSVRFLCBPX1dST05MWSwgUEVSTV9NT0RFKSk7
Cj4gKyAgICAgICBlbHNlCj4gKyAgICAgICAgICAgICAgIFRTVF9FWFBfRkFJTChvcGVuKEZJTEVf
V1JJVEUsIE9fV1JPTkxZLCBQRVJNX01PREUpLAo+IEVBQ0NFUyk7Cj4gKwo+ICsgICAgICAgaWYg
KFRTVF9SRVQgIT0gLTEpCj4gKyAgICAgICAgICAgICAgIFNBRkVfQ0xPU0UoVFNUX1JFVCk7Cj4g
K30KPiArCj4gK3N0YXRpYyB2b2lkIF90ZXN0X3JlYWQoY29uc3QgaW50IHJlc3VsdCkKPiArewo+
ICsgICAgICAgdHN0X3JlcyhUSU5GTywgIlRlc3QgcmVhZGluZyBmaWxlIik7Cj4gKwo+ICsgICAg
ICAgaWYgKHJlc3VsdCA9PSBUUEFTUykKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9GRChvcGVu
KEZJTEVfUkVBRCwgT19SRE9OTFksIFBFUk1fTU9ERSkpOwo+ICsgICAgICAgZWxzZQo+ICsgICAg
ICAgICAgICAgICBUU1RfRVhQX0ZBSUwob3BlbihGSUxFX1JFQUQsIE9fUkRPTkxZLCBQRVJNX01P
REUpLCBFQUNDRVMpOwo+ICsKPiArICAgICAgIGlmIChUU1RfUkVUICE9IC0xKQo+ICsgICAgICAg
ICAgICAgICBTQUZFX0NMT1NFKFRTVF9SRVQpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfdGVz
dF9yZWFkZGlyKGNvbnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAgIHRzdF9yZXMoVElORk8s
ICJUZXN0IHJlYWRpbmcgZGlyZWN0b3J5Iik7Cj4gKwo+ICsgICAgICAgRElSICpkaXI7Cj4gKyAg
ICAgICBzdHJ1Y3QgZGlyZW50ICpkZTsKPiArICAgICAgIGludCBmaWxlc19jb3VudGVkID0gMDsK
PiArCj4gKyAgICAgICBkaXIgPSBvcGVuZGlyKERJUl9SRUFERElSKTsKPiArICAgICAgIGlmICgh
ZGlyKSB7Cj4gKyAgICAgICAgICAgICAgIHRzdF9yZXMocmVzdWx0ID09IFRQQVNTID8gVEZBSUwg
OiBUUEFTUywKPiArICAgICAgICAgICAgICAgICAgICAgICAiQ2FuJ3QgcmVhZCAnJXMnIGRpcmVj
dG9yeSIsIERJUl9SRUFERElSKTsKPiArCj4gKyAgICAgICAgICAgICAgIHJldHVybjsKPiArICAg
ICAgIH0KPiArCj4gKyAgICAgICB0c3RfcmVzKHJlc3VsdCwgIkNhbiByZWFkICclcycgZGlyZWN0
b3J5IiwgRElSX1JFQURESVIpOwo+ICsgICAgICAgaWYgKHJlc3VsdCA9PSBURkFJTCkKPiArICAg
ICAgICAgICAgICAgcmV0dXJuOwo+ICsKPiArICAgICAgIHdoaWxlICgoZGUgPSByZWFkZGlyKGRp
cikpICE9IE5VTEwpIHsKPiArICAgICAgICAgICAgICAgaWYgKGRlLT5kX3R5cGUgIT0gRFRfUkVH
KQo+ICsgICAgICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlOwo+ICsKPiArICAgICAgICAgICAg
ICAgZm9yIChzaXplX3QgaSA9IDA7IGkgPCBBUlJBWV9TSVpFKHJlYWRkaXJfZmlsZXMpOyBpKysp
IHsKPiArICAgICAgICAgICAgICAgICAgICAgICBpZiAocmVhZGRpcl9maWxlc1tpXSA9PSBOVUxM
KQo+ICsgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7Cj4gKwo+ICsgICAg
ICAgICAgICAgICAgICAgICAgIGlmIChzdHJzdHIocmVhZGRpcl9maWxlc1tpXSwgZGUtPmRfbmFt
ZSkgIT0gTlVMTCkKPiArICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbGVzX2NvdW50
ZWQrKzsKPiArICAgICAgICAgICAgICAgfQo+ICsgICAgICAgfQo+ICsKPiArICAgICAgIFNBRkVf
Q0xPU0VESVIoZGlyKTsKPiArCj4gKyAgICAgICBUU1RfRVhQX0VRX0xJKGZpbGVzX2NvdW50ZWQs
IEFSUkFZX1NJWkUocmVhZGRpcl9maWxlcykpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfdGVz
dF9ybWRpcihjb25zdCBpbnQgcmVzdWx0KQo+ICt7Cj4gKyAgICAgICB0c3RfcmVzKFRJTkZPLCAi
VGVzdCByZW1vdmluZyBkaXJlY3RvcnkiKTsKPiArCj4gKyAgICAgICBpZiAocmVzdWx0ID09IFRQ
QVNTKQo+ICsgICAgICAgICAgICAgICBUU1RfRVhQX1BBU1Mocm1kaXIoRElSX1JNRElSKSk7Cj4g
KyAgICAgICBlbHNlCj4gKyAgICAgICAgICAgICAgIFRTVF9FWFBfRkFJTChybWRpcihESVJfUk1E
SVIpLCBFQUNDRVMpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfdGVzdF9ybWZpbGUoY29uc3Qg
aW50IHJlc3VsdCkKPiArewo+ICsgICAgICAgdHN0X3JlcyhUSU5GTywgIlRlc3QgcmVtb3Zpbmcg
ZmlsZSIpOwo+ICsKPiArICAgICAgIGlmIChyZXN1bHQgPT0gVFBBU1MpIHsKPiArICAgICAgICAg
ICAgICAgVFNUX0VYUF9QQVNTKHVubGluayhGSUxFX1VOTElOSykpOwo+ICsgICAgICAgICAgICAg
ICBUU1RfRVhQX1BBU1MocmVtb3ZlKEZJTEVfUkVNT1ZFKSk7Cj4gKyAgICAgICB9IGVsc2Ugewo+
ICsgICAgICAgICAgICAgICBUU1RfRVhQX0ZBSUwodW5saW5rKEZJTEVfVU5MSU5LKSwgRUFDQ0VT
KTsKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9GQUlMKHJlbW92ZShGSUxFX1JFTU9WRSksIEVB
Q0NFUyk7Cj4gKyAgICAgICB9Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIF90ZXN0X21ha2UoCj4g
KyAgICAgICBjb25zdCBjaGFyICpwYXRoLAo+ICsgICAgICAgY29uc3QgaW50IHR5cGUsCj4gKyAg
ICAgICBjb25zdCBpbnQgZGV2LAo+ICsgICAgICAgY29uc3QgaW50IHJlc3VsdCkKPiArewo+ICsg
ICAgICAgdHN0X3JlcyhUSU5GTywgIlRlc3Qgbm9ybWFsIG9yIHNwZWNpYWwgZmlsZXMgY3JlYXRp
b24iKTsKPiArCj4gKyAgICAgICBpZiAocmVzdWx0ID09IFRQQVNTKQo+ICsgICAgICAgICAgICAg
ICBUU1RfRVhQX1BBU1MobWtub2QocGF0aCwgdHlwZSB8IDA0MDAsIGRldikpOwo+ICsgICAgICAg
ZWxzZQo+ICsgICAgICAgICAgICAgICBUU1RfRVhQX0ZBSUwobWtub2QocGF0aCwgdHlwZSB8IDA0
MDAsIGRldiksIEVBQ0NFUyk7Cj4gK30KPiArCj4gK3N0YXRpYyB2b2lkIF90ZXN0X3N5bWJvbGlj
KGNvbnN0IGludCByZXN1bHQpCj4gK3sKPiArICAgICAgIHRzdF9yZXMoVElORk8sICJUZXN0IHN5
bWJvbGljIGxpbmtzIik7Cj4gKwo+ICsgICAgICAgaWYgKHJlc3VsdCA9PSBUUEFTUykKPiArICAg
ICAgICAgICAgICAgVFNUX0VYUF9QQVNTKHN5bWxpbmsoRklMRV9TWU0wLCBGSUxFX1NZTTEpKTsK
PiArICAgICAgIGVsc2UKPiArICAgICAgICAgICAgICAgVFNUX0VYUF9GQUlMKHN5bWxpbmsoRklM
RV9TWU0wLCBGSUxFX1NZTTEpLCBFQUNDRVMpOwo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCBfdGVz
dF90cnVuY2F0ZShjb25zdCBpbnQgcmVzdWx0KQo+ICt7Cj4gKyAgICAgICBpbnQgZmQ7Cj4gKwo+
ICsgICAgICAgdHN0X3JlcyhUSU5GTywgIlRlc3QgdHJ1bmNhdGluZyBmaWxlIik7Cj4gKwo+ICsg
ICAgICAgaWYgKHJlc3VsdCA9PSBUUEFTUykgewo+ICsgICAgICAgICAgICAgICBUU1RfRVhQX1BB
U1ModHJ1bmNhdGUoRklMRV9UUlVOQ0FURSwgMTApKTsKPiArCj4gKyAgICAgICAgICAgICAgIGZk
ID0gVFNUX0VYUF9GRChvcGVuKEZJTEVfVFJVTkNBVEUsIE9fV1JPTkxZLCBQRVJNX01PREUpKTsK
PiArICAgICAgICAgICAgICAgaWYgKGZkICE9IC0xKSB7Cj4gKyAgICAgICAgICAgICAgICAgICAg
ICAgVFNUX0VYUF9QQVNTKGZ0cnVuY2F0ZShmZCwgMTApKTsKPiArICAgICAgICAgICAgICAgICAg
ICAgICBTQUZFX0NMT1NFKGZkKTsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAg
ICAgICAgZmQgPSBUU1RfRVhQX0ZEKG9wZW4oRklMRV9UUlVOQ0FURSwgT19XUk9OTFkgfCBPX1RS
VU5DLAo+IFBFUk1fTU9ERSkpOwo+ICsgICAgICAgICAgICAgICBpZiAoZmQgIT0gLTEpCj4gKyAg
ICAgICAgICAgICAgICAgICAgICAgU0FGRV9DTE9TRShmZCk7Cj4gKyAgICAgICB9IGVsc2Ugewo+
ICsgICAgICAgICAgICAgICBUU1RfRVhQX0ZBSUwodHJ1bmNhdGUoRklMRV9UUlVOQ0FURSwgMTAp
LCBFQUNDRVMpOwo+ICsKPiArICAgICAgICAgICAgICAgZmQgPSBvcGVuKEZJTEVfVFJVTkNBVEUs
IE9fV1JPTkxZLCBQRVJNX01PREUpOwo+ICsgICAgICAgICAgICAgICBpZiAoZmQgIT0gLTEpIHsK
PiArICAgICAgICAgICAgICAgICAgICAgICBUU1RfRVhQX0ZBSUwoZnRydW5jYXRlKGZkLCAxMCks
IEVBQ0NFUyk7Cj4gKyAgICAgICAgICAgICAgICAgICAgICAgU0FGRV9DTE9TRShmZCk7Cj4gKyAg
ICAgICAgICAgICAgIH0KPiArCj4gKyAgICAgICAgICAgICAgIFRTVF9FWFBfRkFJTChvcGVuKEZJ
TEVfVFJVTkNBVEUsIE9fV1JPTkxZIHwgT19UUlVOQywKPiBQRVJNX01PREUpLAo+ICsgICAgICAg
ICAgICAgICAgICAgICAgIEVBQ0NFUyk7Cj4gKwo+ICsgICAgICAgICAgICAgICBpZiAoVFNUX1JF
VCAhPSAtMSkKPiArICAgICAgICAgICAgICAgICAgICAgICBTQUZFX0NMT1NFKFRTVF9SRVQpOwo+
ICsgICAgICAgfQo+ICt9Cj4gKwo+ICtzdGF0aWMgdm9pZCB0ZXN0ZXJfcnVuX3J1bGVzKGNvbnN0
IGludCBydWxlcywgY29uc3QgaW50IHJlc3VsdCkKPiArewo+ICsgICAgICAgaWYgKHJ1bGVzICYg
TEFORExPQ0tfQUNDRVNTX0ZTX0VYRUNVVEUpCj4gKyAgICAgICAgICAgICAgIF90ZXN0X2V4ZWMo
cmVzdWx0KTsKPiArCj4gKyAgICAgICBpZiAocnVsZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfV1JJ
VEVfRklMRSkKPiArICAgICAgICAgICAgICAgX3Rlc3Rfd3JpdGUocmVzdWx0KTsKPiArCj4gKyAg
ICAgICBpZiAocnVsZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfUkVBRF9GSUxFKQo+ICsgICAgICAg
ICAgICAgICBfdGVzdF9yZWFkKHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFO
RExPQ0tfQUNDRVNTX0ZTX1JFQURfRElSKQo+ICsgICAgICAgICAgICAgICBfdGVzdF9yZWFkZGly
KHJlc3VsdCk7Cj4gKwo+ICsgICAgICAgaWYgKHJ1bGVzICYgTEFORExPQ0tfQUNDRVNTX0ZTX1JF
TU9WRV9ESVIpCj4gKyAgICAgICAgICAgICAgIF90ZXN0X3JtZGlyKHJlc3VsdCk7Cj4gKwo+ICsg
ICAgICAgaWYgKHJ1bGVzICYgTEFORExPQ0tfQUNDRVNTX0ZTX1JFTU9WRV9GSUxFKQo+ICsgICAg
ICAgICAgICAgICBfdGVzdF9ybWZpbGUocmVzdWx0KTsKPiArCj4gKyAgICAgICBpZiAocnVsZXMg
JiBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9DSEFSKQo+ICsgICAgICAgICAgICAgICBfdGVzdF9t
YWtlKERFVl9DSEFSMCwgU19JRkNIUiwgZGV2X2NociwgcmVzdWx0KTsKPiArCj4gKyAgICAgICBp
ZiAocnVsZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9CTE9DSykKPiArICAgICAgICAgICAg
ICAgX3Rlc3RfbWFrZShERVZfQkxLMCwgU19JRkJMSywgZGV2X2JsaywgcmVzdWx0KTsKPiArCj4g
KyAgICAgICBpZiAocnVsZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfTUFLRV9SRUcpCj4gKyAgICAg
ICAgICAgICAgIF90ZXN0X21ha2UoRklMRV9SRUdVTEFSLCBTX0lGUkVHLCAwLCByZXN1bHQpOwo+
ICsKPiArICAgICAgIGlmIChydWxlcyAmIExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX1NPQ0spCj4g
KyAgICAgICAgICAgICAgIF90ZXN0X21ha2UoRklMRV9TT0NLRVQsIFNfSUZTT0NLLCAwLCByZXN1
bHQpOwo+ICsKPiArICAgICAgIGlmIChydWxlcyAmIExBTkRMT0NLX0FDQ0VTU19GU19NQUtFX0ZJ
Rk8pCj4gKyAgICAgICAgICAgICAgIF90ZXN0X21ha2UoRklMRV9GSUZPLCBTX0lGSUZPLCAwLCBy
ZXN1bHQpOwo+ICsKPiArICAgICAgIGlmIChydWxlcyAmIExBTkRMT0NLX0FDQ0VTU19GU19NQUtF
X1NZTSkKPiArICAgICAgICAgICAgICAgX3Rlc3Rfc3ltYm9saWMocmVzdWx0KTsKPiArCj4gKyAg
ICAgICBpZiAocnVsZXMgJiBMQU5ETE9DS19BQ0NFU1NfRlNfVFJVTkNBVEUpIHsKPiArICAgICAg
ICAgICAgICAgaWYgKCh0c3Rfa3ZlcmNtcCg2LCAyLCAwKSkgPCAwKSB7Cj4gKyAgICAgICAgICAg
ICAgICAgICAgICAgdHN0X3JlcyhUSU5GTywgIlNraXAgdHJ1bmNhdGUgdGVzdC4gTWluaW11bSBr
ZXJuZWwKPiB2ZXJzaW9uIGlzIDYuMiIpOwo+ICsgICAgICAgICAgICAgICAgICAgICAgIHJldHVy
bjsKPiArICAgICAgICAgICAgICAgfQo+ICsKPiArICAgICAgICAgICAgICAgX3Rlc3RfdHJ1bmNh
dGUocmVzdWx0KTsKPiArICAgICAgIH0KPiArfQo+ICsKPiArc3RhdGljIGlubGluZSB2b2lkIHRl
c3Rlcl9ydW5fYWxsX3J1bGVzKGNvbnN0IGludCBwYXNzX3J1bGVzKQo+ICt7Cj4gKyAgICAgICBp
bnQgZmFpbF9ydWxlczsKPiArICAgICAgIGludCBhbGxfcnVsZXM7Cj4gKwo+ICsgICAgICAgYWxs
X3J1bGVzID0gdGVzdGVyX2dldF9hbGxfcnVsZXMoKTsKPiArICAgICAgIGZhaWxfcnVsZXMgPSBh
bGxfcnVsZXMgJiB+cGFzc19ydWxlczsKPiArCj4gKyAgICAgICB0ZXN0ZXJfcnVuX3J1bGVzKHBh
c3NfcnVsZXMsIFRQQVNTKTsKPiArICAgICAgIHRlc3Rlcl9ydW5fcnVsZXMoZmFpbF9ydWxlcywg
VEZBSUwpOwo+ICt9Cj4gKwo+ICsjZW5kaWYKPgo+IC0tCj4gMi40My4wCj4KPgo+IC0tCj4gTWFp
bGluZyBsaXN0IGluZm86IGh0dHBzOi8vbGlzdHMubGludXguaXQvbGlzdGluZm8vbHRwCj4KPgoK
LS0gClJlZ2FyZHMsCkxpIFdhbmcKCi0tIApNYWlsaW5nIGxpc3QgaW5mbzogaHR0cHM6Ly9saXN0
cy5saW51eC5pdC9saXN0aW5mby9sdHAK
