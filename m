Return-Path: <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>
X-Original-To: lists+linux-ltp@lfdr.de
Delivered-To: lists+linux-ltp@lfdr.de
Received: from picard.linux.it (picard.linux.it [IPv6:2001:1418:10:5::2])
	by mail.lfdr.de (Postfix) with ESMTPS id 1375B274A6
	for <lists+linux-ltp@lfdr.de>; Thu, 23 May 2019 04:54:31 +0200 (CEST)
Received: from picard.linux.it (localhost [IPv6:::1])
	by picard.linux.it (Postfix) with ESMTP id D6EE23EA406
	for <lists+linux-ltp@lfdr.de>; Thu, 23 May 2019 04:54:30 +0200 (CEST)
X-Original-To: ltp@lists.linux.it
Delivered-To: ltp@picard.linux.it
Received: from in-2.smtp.seeweb.it (in-2.smtp.seeweb.it
 [IPv6:2001:4b78:1:20::2])
 by picard.linux.it (Postfix) with ESMTP id 5EAF23EA3BC
 for <ltp@lists.linux.it>; Thu, 23 May 2019 04:54:28 +0200 (CEST)
Received: from heian.cn.fujitsu.com (mail.cn.fujitsu.com [183.91.158.132])
 by in-2.smtp.seeweb.it (Postfix) with ESMTP id 2F87C6023AF
 for <ltp@lists.linux.it>; Thu, 23 May 2019 04:54:22 +0200 (CEST)
X-IronPort-AV: E=Sophos;i="5.60,501,1549900800"; d="scan'208";a="64254433"
Received: from unknown (HELO cn.fujitsu.com) ([10.167.33.5])
 by heian.cn.fujitsu.com with ESMTP; 23 May 2019 10:54:20 +0800
Received: from G08CNEXCHPEKD02.g08.fujitsu.local (unknown [10.167.33.83])
 by cn.fujitsu.com (Postfix) with ESMTP id AC57F4CD846F;
 Thu, 23 May 2019 10:54:19 +0800 (CST)
Received: from localhost.localdomain (10.167.215.30) by
 G08CNEXCHPEKD02.g08.fujitsu.local (10.167.33.89) with Microsoft SMTP Server
 (TLS) id 14.3.439.0; Thu, 23 May 2019 10:54:17 +0800
From: Yang Xu <xuyang2018.jy@cn.fujitsu.com>
To: <chrubis@suse.cz>
Date: Thu, 23 May 2019 10:54:00 +0800
Message-ID: <1558580040-3074-1-git-send-email-xuyang2018.jy@cn.fujitsu.com>
X-Mailer: git-send-email 1.8.3.1
In-Reply-To: <20190522123657.GB7912@rei.lan>
References: <20190522123657.GB7912@rei.lan>
MIME-Version: 1.0
X-Originating-IP: [10.167.215.30]
X-yoursite-MailScanner-ID: AC57F4CD846F.A20E5
X-yoursite-MailScanner: Found to be clean
X-yoursite-MailScanner-From: xuyang2018.jy@cn.fujitsu.com
X-Spam-Status: No, score=0.0 required=7.0 tests=SPF_HELO_NONE,SPF_NONE
 autolearn=disabled version=3.4.0
X-Virus-Scanned: clamav-milter 0.99.2 at in-2.smtp.seeweb.it
X-Virus-Status: Clean
X-Spam-Checker-Version: SpamAssassin 3.4.0 (2014-02-07) on in-2.smtp.seeweb.it
Cc: ltp@lists.linux.it
Subject: [LTP] [PATCH v3] syscalls/prctl04.c: New test for prctl() with
	PR_{SET, GET}_SECCOMP
X-BeenThere: ltp@lists.linux.it
X-Mailman-Version: 2.1.18
Precedence: list
List-Id: Linux Test Project <ltp.lists.linux.it>
List-Unsubscribe: <https://lists.linux.it/options/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=unsubscribe>
List-Archive: <http://lists.linux.it/pipermail/ltp/>
List-Post: <mailto:ltp@lists.linux.it>
List-Help: <mailto:ltp-request@lists.linux.it?subject=help>
List-Subscribe: <https://lists.linux.it/listinfo/ltp>,
 <mailto:ltp-request@lists.linux.it?subject=subscribe>
Content-Type: text/plain; charset="utf-8"
Content-Transfer-Encoding: base64
Errors-To: ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it
Sender: "ltp" <ltp-bounces+lists+linux-ltp=lfdr.de@lists.linux.it>

U2lnbmVkLW9mZi1ieTogWWFuZyBYdSA8eHV5YW5nMjAxOC5qeUBjbi5mdWppdHN1LmNvbT4KLS0t
CiBjb25maWd1cmUuYWMgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDEgKwogaW5j
bHVkZS9sYXBpL3ByY3RsLmggICAgICAgICAgICAgICAgICAgICAgIHwgICA1ICsKIGluY2x1ZGUv
bGFwaS9zZWNjb21wLmggICAgICAgICAgICAgICAgICAgICB8ICA0MCArKysrCiBydW50ZXN0L3N5
c2NhbGxzICAgICAgICAgICAgICAgICAgICAgICAgICAgfCAgIDEgKwogdGVzdGNhc2VzL2tlcm5l
bC9zeXNjYWxscy9wcmN0bC8uZ2l0aWdub3JlIHwgICAxICsKIHRlc3RjYXNlcy9rZXJuZWwvc3lz
Y2FsbHMvcHJjdGwvcHJjdGwwNC5jICB8IDIzMSArKysrKysrKysrKysrKysrKysrKysKIDYgZmls
ZXMgY2hhbmdlZCwgMjc5IGluc2VydGlvbnMoKykKIGNyZWF0ZSBtb2RlIDEwMDY0NCBpbmNsdWRl
L2xhcGkvc2VjY29tcC5oCiBjcmVhdGUgbW9kZSAxMDA2NDQgdGVzdGNhc2VzL2tlcm5lbC9zeXNj
YWxscy9wcmN0bC9wcmN0bDA0LmMKCmRpZmYgLS1naXQgYS9jb25maWd1cmUuYWMgYi9jb25maWd1
cmUuYWMKaW5kZXggNWRjODU3MjhhLi41YTNkYzViNjIgMTAwNjQ0Ci0tLSBhL2NvbmZpZ3VyZS5h
YworKysgYi9jb25maWd1cmUuYWMKQEAgLTQ2LDYgKzQ2LDcgQEAgQUNfQ0hFQ0tfSEVBREVSUyhb
IFwKICAgICBsaW51eC9tZW1wb2xpY3kuaCBcCiAgICAgbGludXgvbW9kdWxlLmggXAogICAgIGxp
bnV4L25ldGxpbmsuaCBcCisgICAgbGludXgvc2VjY29tcC5oIFwKICAgICBsaW51eC91c2VyZmF1
bHRmZC5oIFwKICAgICBtbS5oIFwKICAgICBuZXRpbmV0L3NjdHAuaCBcCmRpZmYgLS1naXQgYS9p
bmNsdWRlL2xhcGkvcHJjdGwuaCBiL2luY2x1ZGUvbGFwaS9wcmN0bC5oCmluZGV4IDZkYjhhNjQ4
MC4uZjQyYmQ2NDU5IDEwMDY0NAotLS0gYS9pbmNsdWRlL2xhcGkvcHJjdGwuaAorKysgYi9pbmNs
dWRlL2xhcGkvcHJjdGwuaApAQCAtOSw2ICs5LDExIEBACiAKICNpbmNsdWRlIDxzeXMvcHJjdGwu
aD4KIAorI2lmbmRlZiBQUl9TRVRfU0VDQ09NUAorIyBkZWZpbmUgUFJfR0VUX1NFQ0NPTVAgIDIx
CisjIGRlZmluZSBQUl9TRVRfU0VDQ09NUCAgMjIKKyNlbmRpZgorCiAjaWZuZGVmIFBSX1NFVF9D
SElMRF9TVUJSRUFQRVIKICMgZGVmaW5lIFBSX1NFVF9DSElMRF9TVUJSRUFQRVIJMzYKICMgZGVm
aW5lIFBSX0dFVF9DSElMRF9TVUJSRUFQRVIJMzcKZGlmZiAtLWdpdCBhL2luY2x1ZGUvbGFwaS9z
ZWNjb21wLmggYi9pbmNsdWRlL2xhcGkvc2VjY29tcC5oCm5ldyBmaWxlIG1vZGUgMTAwNjQ0Cmlu
ZGV4IDAwMDAwMDAwMC4uYTgwZDNkOGNkCi0tLSAvZGV2L251bGwKKysrIGIvaW5jbHVkZS9sYXBp
L3NlY2NvbXAuaApAQCAtMCwwICsxLDQwIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjog
R1BMLTIuMC1vci1sYXRlcgorLyoKKyAqIENvcHlyaWdodCAoYykgMjAxOSBGVUpJVFNVIExJTUlU
RUQuIEFsbCByaWdodHMgcmVzZXJ2ZWQuCisgKiBBdXRob3I6IFlhbmcgWHUgPHh1eWFuZzIwMTgu
anlAY24uZnVqaXRzdS5jb20+CisgKi8KKyNpZm5kZWYgTEFQSV9TRUNDT01QX0gKKyNkZWZpbmUg
TEFQSV9TRUNDT01QX0gKKworIyBpbmNsdWRlIDxsaW51eC90eXBlcy5oPgorCisjIGlmZGVmIEhB
VkVfTElOVVhfU0VDQ09NUF9ICisjICBpbmNsdWRlIDxsaW51eC9zZWNjb21wLmg+CisjIGVsc2UK
Ky8qIFZhbGlkIHZhbHVlcyBmb3Igc2VjY29tcC5tb2RlIGFuZCBwcmN0bChQUl9TRVRfU0VDQ09N
UCwgPG1vZGU+KSAqLworIyAgZGVmaW5lIFNFQ0NPTVBfTU9ERV9ESVNBQkxFRCAgIDAKKyMgIGRl
ZmluZSBTRUNDT01QX01PREVfU1RSSUNUICAgICAxCisjICBkZWZpbmUgU0VDQ09NUF9NT0RFX0ZJ
TFRFUiAgICAgMgorCisjICBkZWZpbmUgU0VDQ09NUF9SRVRfS0lMTF9USFJFQUQgIDB4MDAwMDAw
MDBVIC8qIGtpbGwgdGhlIHRocmVhZCAqLworIyAgZGVmaW5lIFNFQ0NPTVBfUkVUX0tJTEwgICAg
ICAgICBTRUNDT01QX1JFVF9LSUxMX1RIUkVBRAorIyAgZGVmaW5lIFNFQ0NPTVBfUkVUX0FMTE9X
ICAgICAgICAweDdmZmYwMDAwVSAvKiBhbGxvdyAqLworCisvKioKKyAqIHN0cnVjdCBzZWNjb21w
X2RhdGEgLSB0aGUgZm9ybWF0IHRoZSBCUEYgcHJvZ3JhbSBleGVjdXRlcyBvdmVyLgorICogQG5y
OiB0aGUgc3lzdGVtIGNhbGwgbnVtYmVyCisgKiBAYXJjaDogaW5kaWNhdGVzIHN5c3RlbSBjYWxs
IGNvbnZlbnRpb24gYXMgYW4gQVVESVRfQVJDSF8qIHZhbHVlCisgKiAgICAgICAgYXMgZGVmaW5l
ZCBpbiA8bGludXgvYXVkaXQuaD4uCisgKiBAaW5zdHJ1Y3Rpb25fcG9pbnRlcjogYXQgdGhlIHRp
bWUgb2YgdGhlIHN5c3RlbSBjYWxsLgorICogQGFyZ3M6IHVwIHRvIDYgc3lzdGVtIGNhbGwgYXJn
dW1lbnRzIGFsd2F5cyBzdG9yZWQgYXMgNjQtYml0IHZhbHVlcworICogcmVnYXJkbGVzcyBvZiB0
aGUgYXJjaGl0ZWN0dXJlLgorICovCitzdHJ1Y3Qgc2VjY29tcF9kYXRhIHsKKwlpbnQgbnI7CisJ
X191MzIgYXJjaDsKKwlfX3U2NCBpbnN0cnVjdGlvbl9wb2ludGVyOworCV9fdTY0IGFyZ3NbNl07
Cit9OworCisjIGVuZGlmIC8qIEhBVkVfTElOVVhfU0VDQ09NUF9IKi8KKyNlbmRpZiAvKiBMQVBJ
X1NFQ0NPTVBfSCAqLwpkaWZmIC0tZ2l0IGEvcnVudGVzdC9zeXNjYWxscyBiL3J1bnRlc3Qvc3lz
Y2FsbHMKaW5kZXggMzBjMTMyNzUxLi4wNDU1OGE1ODAgMTAwNjQ0Ci0tLSBhL3J1bnRlc3Qvc3lz
Y2FsbHMKKysrIGIvcnVudGVzdC9zeXNjYWxscwpAQCAtODYxLDYgKzg2MSw3IEBAIHBwb2xsMDEg
cHBvbGwwMQogcHJjdGwwMSBwcmN0bDAxCiBwcmN0bDAyIHByY3RsMDIKIHByY3RsMDMgcHJjdGww
MworcHJjdGwwNCBwcmN0bDA0CiAKIHByZWFkMDEgcHJlYWQwMQogcHJlYWQwMV82NCBwcmVhZDAx
XzY0CmRpZmYgLS1naXQgYS90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL3ByY3RsLy5naXRpZ25v
cmUgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL3ByY3RsLy5naXRpZ25vcmUKaW5kZXggMmY0
NmE5YTEyLi4xYzNkYTMwNTIgMTAwNjQ0Ci0tLSBhL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMv
cHJjdGwvLmdpdGlnbm9yZQorKysgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL3ByY3RsLy5n
aXRpZ25vcmUKQEAgLTEsMyArMSw0IEBACiAvcHJjdGwwMQogL3ByY3RsMDIKIC9wcmN0bDAzCisv
cHJjdGwwNApkaWZmIC0tZ2l0IGEvdGVzdGNhc2VzL2tlcm5lbC9zeXNjYWxscy9wcmN0bC9wcmN0
bDA0LmMgYi90ZXN0Y2FzZXMva2VybmVsL3N5c2NhbGxzL3ByY3RsL3ByY3RsMDQuYwpuZXcgZmls
ZSBtb2RlIDEwMDY0NAppbmRleCAwMDAwMDAwMDAuLjU4NTI3NGE4YQotLS0gL2Rldi9udWxsCisr
KyBiL3Rlc3RjYXNlcy9rZXJuZWwvc3lzY2FsbHMvcHJjdGwvcHJjdGwwNC5jCkBAIC0wLDAgKzEs
MjMxIEBACisvLyBTUERYLUxpY2Vuc2UtSWRlbnRpZmllcjogR1BMLTIuMC1vci1sYXRlcgorLyoK
KyAqIENvcHlyaWdodCAoYykgMjAxOSBGVUpJVFNVIExJTUlURUQuIEFsbCByaWdodHMgcmVzZXJ2
ZWQuCisgKiBBdXRob3I6IFlhbmcgWHUgPHh1eWFuZzIwMTguanlAY24uZnVqaXRzdS5jb20+Cisg
KgorICogVGVzdCBQUl9HRVRfU0VDQ09NUCBhbmQgUFJfU0VUX1NFQ0NPTVAgb2YgcHJjdGwoMiku
CisgKiAxKSBJZiBQUl9TRVRfU0VDQ09NUCBzZXRzIHRoZSBTRUNDT01QX01PREVfU1RSSUNUIGZv
ciB0aGUgY2FsbGluZyB0aHJlYWQsCisgKiAgICB0aGUgb25seSBzeXN0ZW0gY2FsbCB0aGF0IHRo
ZSB0aHJlYWQgaXMgcGVybWl0dGVkIHRvIG1ha2UgYXJlIHJlYWQoMiksCisgKiAgICB3cml0ZSgy
KSxfZXhpdCgyKShidXQgbm90IGV4aXRfZ3JvdXAoMikpLCBhbmQgc2lncmV0dXJuKDIpLiAgT3Ro
ZXIKKyAqICAgIHN5c3RlbSBjYWxscyByZXN1bHQgaW4gdGhlIGRlbGl2ZXJ5IG9mIGEgU0lHS0lM
TCBzaWduYWwuIFRoaXMgb3BlcmF0aW9uCisgKiAgICBpcyBhdmFpbGFibGUgb25seSBpZiB0aGUg
a2VybmVsIGlzIGNvbmZpZ3VyZWQgd2l0aCBDT05GSUdfU0VDQ09NUCBlbmFibGVkLgorICogMikg
SWYgUFJfU0VUX1NFQ0NPTVAgc2V0cyB0aGUgU0VDQ09NUF9NT0RFX0ZJTFRFUiBmb3IgdGhlIGNh
bGxpbmcgdGhyZWFkLAorICogICAgdGhlIHN5c3RlbSBjYWxscyBhbGxvd2VkIGFyZSBkZWZpbmVk
IGJ5IGEgcG9pbnRlciB0byBhIEJlcmtlbGV5IFBhY2tldAorICogICAgRmlsdGVyLiBPdGhlciBz
eXN0ZW0gY2FsbHMgcmVzdWx0IGludCB0aGUgZGVsaXZlcnkgb2YgYSBTSUdTWVMgc2lnbmFsCisg
KiAgICB3aXRoIFNFQ0NPTVBfUkVUX0tJTEwuIFRoZSBTRUNDT01QX1NFVF9NT0RFX0ZJTFRFUiBv
cGVyYXRpb24gaXMgYXZhaWxhYmxlCisgKiAgICBvbmx5IGlmIHRoZSBrZXJuZWwgaXMgY29uZmln
dXJlZCB3aXRoIENPTkZJR19TRUNDT01QX0ZJTFRFUiBlbmFibGVkLgorICogMykgSWYgU0VDQ09N
UF9NT0RFX0ZJTFRFUiBmaWx0ZXJzIHBlcm1pdCBmb3JrKDIpLCB0aGVuIHRoZSBzZWNjb21wIG1v
ZGUKKyAqICAgIGlzIGluaGVyaXRlZCBieSBjaGlsZHJlbiBjcmVhdGVkIGJ5IGZvcmsoMikuCisg
Ki8KKworI2luY2x1ZGUgPGVycm5vLmg+CisjaW5jbHVkZSA8c2lnbmFsLmg+CisjaW5jbHVkZSA8
c3lzL3ByY3RsLmg+CisjaW5jbHVkZSA8c3lzL3dhaXQuaD4KKyNpbmNsdWRlIDxzeXMvdHlwZXMu
aD4KKyNpbmNsdWRlIDxsaW51eC9maWx0ZXIuaD4KKyNpbmNsdWRlIDx1bmlzdGQuaD4KKyNpbmNs
dWRlIDxzdGRsaWIuaD4KKyNpbmNsdWRlIDxzdGRkZWYuaD4KKyNpbmNsdWRlICJ0c3RfdGVzdC5o
IgorI2luY2x1ZGUgImxhcGkvc3lzY2FsbHMuaCIKKyNpbmNsdWRlICJsYXBpL3ByY3RsLmgiCisj
aW5jbHVkZSAiY29uZmlnLmgiCisjaW5jbHVkZSAibGFwaS9zZWNjb21wLmgiCisKKyNkZWZpbmUg
Rk5BTUUgImZpbGVuYW1lIgorCitzdGF0aWMgY29uc3Qgc3RydWN0IHNvY2tfZmlsdGVyICBzdHJp
Y3RfZmlsdGVyW10gPSB7CisJQlBGX1NUTVQoQlBGX0xEIHwgQlBGX1cgfCBCUEZfQUJTLCAob2Zm
c2V0b2YgKHN0cnVjdCBzZWNjb21wX2RhdGEsIG5yKSkpLAorCisJQlBGX0pVTVAoQlBGX0pNUCB8
IEJQRl9KRVEsIF9fTlJfY2xvc2UsIDUsIDApLAorCUJQRl9KVU1QKEJQRl9KTVAgfCBCUEZfSkVR
LCBfX05SX2V4aXQsICA0LCAwKSwKKwlCUEZfSlVNUChCUEZfSk1QIHwgQlBGX0pFUSwgX19OUl93
YWl0NCwgMywgMCksCisJQlBGX0pVTVAoQlBGX0pNUCB8IEJQRl9KRVEsIF9fTlJfd3JpdGUsIDIs
IDApLAorCUJQRl9KVU1QKEJQRl9KTVAgfCBCUEZfSkVRLCBfX05SX2Nsb25lLCAxLCAwKSwKKwor
CUJQRl9TVE1UKEJQRl9SRVQgfCBCUEZfSywgU0VDQ09NUF9SRVRfS0lMTCksCisJQlBGX1NUTVQo
QlBGX1JFVCB8IEJQRl9LLCBTRUNDT01QX1JFVF9BTExPVykKK307CisKK3N0YXRpYyBjb25zdCBz
dHJ1Y3Qgc29ja19mcHJvZyAgc3RyaWN0ID0geworCS5sZW4gPSAodW5zaWduZWQgc2hvcnQpQVJS
QVlfU0laRShzdHJpY3RfZmlsdGVyKSwKKwkuZmlsdGVyID0gKHN0cnVjdCBzb2NrX2ZpbHRlciAq
KXN0cmljdF9maWx0ZXIKK307CisKK3N0YXRpYyB2b2lkIGNoZWNrX3N0cmljdF9tb2RlKGludCk7
CitzdGF0aWMgdm9pZCBjaGVja19maWx0ZXJfbW9kZShpbnQpOworCitzdGF0aWMgc3RydWN0IHRj
YXNlIHsKKwl2b2lkICgqZnVuY19jaGVjaykoKTsKKwlpbnQgcGFzc19mbGFnOworCWludCB2YWw7
CisJaW50IGV4cF9zaWduYWw7CisJY2hhciAqbWVzc2FnZTsKK30gdGNhc2VzW10gPSB7CisJe2No
ZWNrX3N0cmljdF9tb2RlLCAxLCAxLCBTSUdLSUxMLAorCSJTRUNDT01QX01PREVfU1RSSUNUIGRv
ZXNuJ3QgcGVybWl0IEdFVF9TRUNDT01QIGNhbGwifSwKKworCXtjaGVja19zdHJpY3RfbW9kZSwg
MCwgMiwgU0lHS0lMTCwKKwkiU0VDQ09NUF9NT0RFX1NUUklDVCBkb2Vzbid0IHBlcm1pdCByZWFk
KDIpIHdyaXRlKDIpIGFuZCBfZXhpdCgyKSJ9LAorCisJe2NoZWNrX3N0cmljdF9tb2RlLCAxLCAz
LCBTSUdLSUxMLAorCSJTRUNDT01QX01PREVfU1RSSUNUIGRvZXNuJ3QgcGVybWl0IGNsb3NlKDIp
In0sCisKKwl7Y2hlY2tfZmlsdGVyX21vZGUsIDEsIDEsIFNJR1NZUywKKwkiU0VDQ09NUF9NT0RF
X0ZJTFRFUiBkb2VzdG4ndCBwZXJtaXQgR0VUX1NFQ0NPTVAgY2FsbCJ9LAorCisJe2NoZWNrX2Zp
bHRlcl9tb2RlLCAwLCAyLCBTSUdTWVMsCisJIlNFQ0NPTVBfTU9ERV9GSUxURVIgZG9lc24ndCBw
ZXJtaXQgY2xvc2UoMikifSwKKworCXtjaGVja19maWx0ZXJfbW9kZSwgMiwgMywgU0lHU1lTLAor
CSJTRUNDT01QX01PREVfRklMVEVSIGRvZXNuJ3QgcGVybWl0IGV4aXQoKSJ9LAorCisJe2NoZWNr
X2ZpbHRlcl9tb2RlLCAwLCA0LCBTSUdTWVMsCisJIlNFQ0NPTVBfTU9ERV9GSUxURVIgZG9lc24n
dCBwZXJtaXQgZXhpdCgpIn0KK307CisKK3N0YXRpYyB2b2lkIGNoZWNrX2ZpbHRlcl9tb2RlX2lu
aGVyaXQodm9pZCkKK3sKKwlpbnQgY2hpbGRwaWQ7CisJaW50IGNoaWxkc3RhdHVzOworCisJY2hp
bGRwaWQgPSBTQUZFX0ZPUksoKTsKKwlpZiAoY2hpbGRwaWQgPT0gMCkgeworCQl0c3RfcmVzKFRQ
QVNTLCAiU0VDQ09NUF9NT0RFX0ZJTFRFUiBwZXJtaXRzIGZvcmsoMikiKTsKKwkJZXhpdCgwKTsK
Kwl9CisKKwl3YWl0NChjaGlsZHBpZCwgJmNoaWxkc3RhdHVzLCAwLCBOVUxMKTsKKwlpZiAoV0lG
U0lHTkFMRUQoY2hpbGRzdGF0dXMpICYmIFdURVJNU0lHKGNoaWxkc3RhdHVzKSA9PSBTSUdTWVMp
CisJCXRzdF9yZXMoVFBBU1MsCisJCQkiU0VDQ09NUF9NT0RFX0ZJTFRFUiBoYXMgYmVlbiBpbmhl
cml0ZWQgYnkgY2hpbGQiKTsKKwllbHNlCisJCXRzdF9yZXMoVEZBSUwsCisJCQkiU0VDQ09NUF9N
T0RFX0ZJTFRFUiBpc24ndCBiZWVuIGluaGVyaXRlZCBieSBjaGlsZCIpOworfQorCitzdGF0aWMg
dm9pZCBjaGVja19zdHJpY3RfbW9kZShpbnQgdmFsKQoreworCWludCBmZDsKKwljaGFyIGJ1Zlsy
XTsKKworCWZkID0gU0FGRV9PUEVOKEZOQU1FLCBPX1JEV1IgfCBPX0NSRUFULCAwNjY2KTsKKwor
CVRFU1QocHJjdGwoUFJfU0VUX1NFQ0NPTVAsIFNFQ0NPTVBfTU9ERV9TVFJJQ1QpKTsKKwlpZiAo
VFNUX1JFVCA9PSAtMSkgeworCQl0c3RfcmVzKFRGQUlMIHwgVFRFUlJOTywKKwkJCSJwcmN0bChQ
Ul9TRVRfU0VDQ09NUCkgc2V0cyBTRUNDT01QX01PREVfU1RSSUNUIGZhaWxlZCIpOworCQlyZXR1
cm47CisJfQorCisJc3dpdGNoICh2YWwpIHsKKwljYXNlIDE6CisJCXRzdF9yZXMoVFBBU1MsCisJ
CQkicHJjdGwoUFJfU0VUX1NFQ0NPTVApIHNldHMgU0VDQ09NUF9NT0RFX1NUUklDVCBzdWNjZWVk
Iik7CisJCXByY3RsKFBSX0dFVF9TRUNDT01QKTsKKwkJdHN0X3JlcyhURkFJTCwgInByY3RsKFBS
X0dFVF9TRUNDT01QKSBzdWNjZWVkIHVuZXhwZWN0ZWRseSIpOworCWJyZWFrOworCWNhc2UgMjoK
KwkJU0FGRV9XUklURSgxLCBmZCwgImEiLCAxKTsKKwkJU0FGRV9SRUFEKDAsIGZkLCBidWYsIDEp
OworCQl0c3RfcmVzKFRQQVNTLAorCQkJIlNFQ0NPTVBfTU9ERV9TVFJJQ1QgcGVybWl0cyByZWFk
KDIpIHdyaXRlKDIpIGFuZCBfZXhpdCgyKSIpOworCWJyZWFrOworCWNhc2UgMzoKKwkJY2xvc2Uo
ZmQpOworCQl0c3RfcmVzKFRGQUlMLAorCQkJIlNFQ0NPTVBfTU9ERV9TVFJJQ1QgcGVybWl0cyBj
bG9zZSgyKSB1bmV4cGVjdGRseSIpOworCWJyZWFrOworCX0KKworCXRzdF9zeXNjYWxsKF9fTlJf
ZXhpdCwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIGNoZWNrX2ZpbHRlcl9tb2RlKGludCB2YWwpCit7
CisJaW50IGZkOworCisJZmQgPSBTQUZFX09QRU4oRk5BTUUsIE9fUkRXUiB8IE9fQ1JFQVQsIDA2
NjYpOworCisJVEVTVChwcmN0bChQUl9TRVRfU0VDQ09NUCwgU0VDQ09NUF9NT0RFX0ZJTFRFUiwg
JnN0cmljdCkpOworCWlmIChUU1RfUkVUID09IC0xKSB7CisJCWlmIChUU1RfRVJSID09IEVJTlZB
TCkKKwkJCXRzdF9yZXMoVENPTkYsCisJCQkJImtlcm5lbCBkb2Vzbid0IHN1cHBvcnQgU0VDQ09N
UF9NT0RFX0ZJTFRFUiIpOworCQllbHNlCisJCQl0c3RfcmVzKFRGQUlMIHwgVEVSUk5PLAorCQkJ
CSJwcmN0bChQUl9TRVRfU0VDQ09NUCkgc2V0cyBTRUNDT01QX01PREVfRklMVEVSIGZhaWxlZCIp
OworCQlyZXR1cm47CisJfQorCisJc3dpdGNoICh2YWwpIHsKKwljYXNlIDE6CisJCXRzdF9yZXMo
VFBBU1MsCisJCQkicHJjdGwoUFJfU0VUX1NFQ0NPTVApIHNldHMgU0VDQ09NUF9NT0RFX0ZJTFRF
UiBzdWNjZWVkIik7CisJCXByY3RsKFBSX0dFVF9TRUNDT01QKTsKKwkJdHN0X3JlcyhURkFJTCwg
InByY3RsKFBSX0dFVF9TRUNDT01QKSBzdWNjZWVkIHVuZXhwZWN0ZWRseSIpOworCWJyZWFrOwor
CWNhc2UgMjoKKwkJY2xvc2UoZmQpOworCQl0c3RfcmVzKFRQQVNTLCAiU0VDQ09NUF9NT0RFX0ZJ
TFRFUiBwZXJtaXRzIGNsb3NlKDIpIik7CisJYnJlYWs7CisJY2FzZSAzOgorCQlleGl0KDApOwor
CWJyZWFrOworCWNhc2UgNDoKKwkJY2hlY2tfZmlsdGVyX21vZGVfaW5oZXJpdCgpOworCWJyZWFr
OworCX0KKworCXRzdF9zeXNjYWxsKF9fTlJfZXhpdCwgMCk7Cit9CisKK3N0YXRpYyB2b2lkIHZl
cmlmeV9wcmN0bCh1bnNpZ25lZCBpbnQgbikKK3sKKwlpbnQgcGlkOworCWludCBzdGF0dXM7CisJ
c3RydWN0IHRjYXNlICp0YyA9ICZ0Y2FzZXNbbl07CisKKwlwaWQgPSBTQUZFX0ZPUksoKTsKKwlp
ZiAocGlkID09IDApIHsKKwkJdGMtPmZ1bmNfY2hlY2sodGMtPnZhbCk7CisJfSBlbHNlIHsKKwkJ
U0FGRV9XQUlUUElEKHBpZCwgJnN0YXR1cywgMCk7CisJCWlmIChXSUZTSUdOQUxFRChzdGF0dXMp
ICYmIFdURVJNU0lHKHN0YXR1cykgPT0gdGMtPmV4cF9zaWduYWwpIHsKKwkJCWlmICh0Yy0+cGFz
c19mbGFnKQorCQkJCXRzdF9yZXMoVFBBU1MsICIlcyIsIHRjLT5tZXNzYWdlKTsKKwkJCWVsc2UK
KwkJCQl0c3RfcmVzKFRGQUlMLCAiJXMiLCB0Yy0+bWVzc2FnZSk7CisJCQlyZXR1cm47CisJCX0K
KworCQlpZiAodGMtPnBhc3NfZmxhZyA9PSAyKQorCQkJdHN0X3JlcyhURkFJTCwKKwkJCQkiU0VD
Q09NUF9NT0RFX0ZJTFRFUiBwZXJtaXRzIGV4aXQoKSB1bmV4cGVjdGVkbHkiKTsKKwl9Cit9CisK
K3N0YXRpYyB2b2lkIHNldHVwKHZvaWQpCit7CisJVEVTVChwcmN0bChQUl9HRVRfU0VDQ09NUCkp
OworCWlmIChUU1RfUkVUID09IDApIHsKKwkJdHN0X3JlcyhUSU5GTywgImtlcm5lbCBzdXBwb3J0
IFBSX0dFVC9TRVRfU0VDQ09NUCIpOworCQlyZXR1cm47CisJfQorCisJaWYgKFRTVF9FUlIgPT0g
RUlOVkFMKQorCQl0c3RfYnJrKFRDT05GLCAia2VybmVsIGRvZXNuJ3Qgc3VwcG9ydCBQUl9HRVQv
U0VUX1NFQ0NPTVAiKTsKKworCXRzdF9icmsoVEJST0sgfCBUVEVSUk5PLAorCQkiY3VycmVudCBl
bnZpcm9ubWVudCBkb2Vzbid0IHBlcm1pdCBQUl9HRVQvU0VUX1NFQ0NPTVAiKTsKK30KKworc3Rh
dGljIHN0cnVjdCB0c3RfdGVzdCB0ZXN0ID0geworCS5zZXR1cCA9IHNldHVwLAorCS50ZXN0ID0g
dmVyaWZ5X3ByY3RsLAorCS50Y250ID0gQVJSQVlfU0laRSh0Y2FzZXMpLAorCS5mb3Jrc19jaGls
ZCA9IDEsCisJLm5lZWRzX3RtcGRpciA9IDEsCisJLm5lZWRzX3Jvb3QgPSAxLAorfTsKLS0gCjIu
MTguMQoKCgoKLS0gCk1haWxpbmcgbGlzdCBpbmZvOiBodHRwczovL2xpc3RzLmxpbnV4Lml0L2xp
c3RpbmZvL2x0cAo=
